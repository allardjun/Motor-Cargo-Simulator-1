(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    129982,       3451]
NotebookOptionsPosition[    123323,       3234]
NotebookOutlinePosition[    123685,       3250]
CellTagsIndexPosition[    123642,       3247]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Equations for forward euler", "Title",
 CellChangeTimes->{{3.670201171182211*^9, 3.670201183646469*^9}}],

Cell["\<\
This notebook generates a system of equations, solves it, then writes the \
resulting solved equations to a file in c-ish syntax. When the bash script \
CformToC.sh is then run on the written file, the result should be a c file \
which encodes the equations for the next value of the locations of the \
anchors of each motor, as well as the cargo.

The first section goes through the calculation in detail. Following that is a \
function which performs all the steps for a certain number of attached \
motors. Finally, there is code which loops over numbers of attached motors up \
from 1 to however many are desired and writes as close as possible to a c \
function which will return the next location given the previous one.

Note: to see outputs in first section, delete ; at end of line\
\>", "Text",
 CellChangeTimes->{{3.684120504191019*^9, 3.684120894327046*^9}, {
  3.68412289746591*^9, 3.684122903544365*^9}, {3.6841232064572563`*^9, 
  3.684123224352906*^9}}],

Cell[CellGroupData[{

Cell["Deterministic Version", "Chapter",
 CellChangeTimes->{{3.6858277808269*^9, 3.6858277871035213`*^9}}],

Cell[CellGroupData[{

Cell["Functions for deterministic version", "Section",
 CellChangeTimes->{{3.685826211557074*^9, 3.685826222885075*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumForcesAnchor", "[", "i_", "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"FmTangential", "[", "i", "]"}], "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"FmTangential", "[", "i", "]"}], "[", "1", "]"}], ",", 
       RowBox[{
        RowBox[{"FmTangential", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
     "+", 
     RowBox[{
      RowBox[{"xiAnchor", "[", "i", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c1", "[", "0", "]"}], ",", 
             RowBox[{"c1", "[", "1", "]"}], ",", 
             RowBox[{"c1", "[", "2", "]"}]}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "[", "0", "]"}], ",", 
             RowBox[{"c", "[", "1", "]"}], ",", 
             RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ")"}], "/", "dt"}], "+", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"omega", "[", "0", "]"}], ",", 
            RowBox[{"omega", "[", "1", "]"}], ",", 
            RowBox[{"omega", "[", "2", "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "[", "0", "]"}], ",", 
             RowBox[{"c", "[", "1", "]"}], ",", 
             RowBox[{"c", "[", "2", "]"}]}], "}"}]}]}], "]"}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a1", "[", "i", "]"}], "[", "0", "]"}], ",", 
             RowBox[{
              RowBox[{"a1", "[", "i", "]"}], "[", "1", "]"}], ",", 
             RowBox[{
              RowBox[{"a1", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}], ")"}],
          "/", "dt"}]}], ")"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6858262400984583`*^9, 3.685826249660431*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumForcesCargo", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Thread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ftrap", "[", "0", "]"}], ",", 
       RowBox[{"Ftrap", "[", "1", "]"}], ",", 
       RowBox[{"Ftrap", "[", "2", "]"}]}], "}"}], "+", "\[IndentingNewLine]", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fsteric", "[", "0", "]"}], ",", 
       RowBox[{"Fsteric", "[", "1", "]"}], ",", 
       RowBox[{"Fsteric", "[", "2", "]"}]}], "}"}], "-", 
     "\[IndentingNewLine]", 
     RowBox[{"xiCargoTranslation", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c1", "[", "0", "]"}], ",", 
           RowBox[{"c1", "[", "1", "]"}], ",", 
           RowBox[{"c1", "[", "2", "]"}]}], "}"}], "-", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], ",", 
           RowBox[{"c", "[", "1", "]"}], ",", 
           RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ")"}], "/", "dt"}]}], "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "0", "]"}], ",", 
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
        RowBox[{
         RowBox[{"xiAnchor", "[", "i", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c1", "[", "0", "]"}], ",", 
                RowBox[{"c1", "[", "1", "]"}], ",", 
                RowBox[{"c1", "[", "2", "]"}]}], "}"}], "-", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c", "[", "0", "]"}], ",", 
                RowBox[{"c", "[", "1", "]"}], ",", 
                RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ")"}], "/", "dt"}], 
           "+", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"omega", "[", "0", "]"}], ",", 
               RowBox[{"omega", "[", "1", "]"}], ",", 
               RowBox[{"omega", "[", "2", "]"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
              
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c", "[", "0", "]"}], ",", 
                RowBox[{"c", "[", "1", "]"}], ",", 
                RowBox[{"c", "[", "2", "]"}]}], "}"}]}]}], "]"}], "-", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"a1", "[", "i", "]"}], "[", "0", "]"}], ",", 
                RowBox[{
                 RowBox[{"a1", "[", "i", "]"}], "[", "1", "]"}], ",", 
                RowBox[{
                 RowBox[{"a1", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}], 
             ")"}], "/", "dt"}]}], ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685826263017686*^9, 3.6858262873047943`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumTorquesCargo", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TorqeExt", "[", "0", "]"}], ",", 
       RowBox[{"TorqeExt", "[", "1", "]"}], ",", 
       RowBox[{"TorqeExt", "[", "2", "]"}]}], "}"}], "-", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"omega", "[", "0", "]"}], ",", 
        RowBox[{"omega", "[", "1", "]"}], ",", 
        RowBox[{"omega", "[", "2", "]"}]}], "}"}], "xiCargoRotation"}], "-", 
     " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xiAnchor", "[", "i", "]"}], 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "[", "0", "]"}], ",", 
             RowBox[{"c", "[", "1", "]"}], ",", 
             RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ",", " ", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c1", "[", "0", "]"}], ",", 
                RowBox[{"c1", "[", "1", "]"}], ",", 
                RowBox[{"c1", "[", "2", "]"}]}], "}"}], "-", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c", "[", "0", "]"}], ",", 
                RowBox[{"c", "[", "1", "]"}], ",", 
                RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ")"}], "/", "dt"}], 
           "+", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Cross", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"omega", "[", "0", "]"}], ",", 
                 RowBox[{"omega", "[", "1", "]"}], ",", 
                 RowBox[{"omega", "[", "2", "]"}]}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
                  RowBox[{
                   RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
                  RowBox[{
                   RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
                "-", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"c", "[", "0", "]"}], ",", 
                  RowBox[{"c", "[", "1", "]"}], ",", 
                  RowBox[{"c", "[", "2", "]"}]}], "}"}]}]}], "]"}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"a1", "[", "i", "]"}], "[", "0", "]"}], ",", 
                  RowBox[{
                   RowBox[{"a1", "[", "i", "]"}], "[", "1", "]"}], ",", 
                  RowBox[{
                   RowBox[{"a1", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
                "-", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
                  RowBox[{
                   RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
                  RowBox[{
                   RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}], 
               ")"}], "/", "dt"}]}], ")"}]}]}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6858263458841*^9, 3.685826368156781*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"vars", "[", "nmotors_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"a1", "[", "i", "]"}], "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"a1", "[", "i", "]"}], "[", "1", "]"}], ",", 
         RowBox[{
          RowBox[{"a1", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c1", "[", "0", "]"}], ",", 
       RowBox[{"c1", "[", "1", "]"}], ",", 
       RowBox[{"c1", "[", "2", "]"}], ",", 
       RowBox[{"omega", "[", "0", "]"}], ",", 
       RowBox[{"omega", "[", "1", "]"}], ",", 
       RowBox[{"omega", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.685827835783422*^9, 3.685827846335267*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xi2muRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"xiAnchor", "[", "x_", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"1", "/", 
      RowBox[{"muAnchor", "[", "x", "]"}]}]}], ",", 
    RowBox[{"xiCargoRotation", "\[Rule]", 
     RowBox[{"1", "/", "muCargoRotation"}]}], ",", 
    RowBox[{"xiCargoTranslation", "\[Rule]", 
     RowBox[{"1", "/", "muCargoTranslation"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.685828689953663*^9, 3.685828713731823*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"xiAnchor", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox["1", 
     RowBox[{"muAnchor", "[", "x", "]"}]]}], ",", 
   RowBox[{"xiCargoRotation", "\[Rule]", 
    FractionBox["1", "muCargoRotation"]}], ",", 
   RowBox[{"xiCargoTranslation", "\[Rule]", 
    FractionBox["1", "muCargoTranslation"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.685828721163733*^9, 3.685829944691167*^9, 
  3.685829999939147*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step through solution", "Section",
 CellChangeTimes->{{3.684005009896345*^9, 3.68400502268918*^9}, {
  3.684120126101068*^9, 3.6841201275721607`*^9}, {3.685829578696724*^9, 
  3.685829582553841*^9}}],

Cell["\<\
We want to generate the system of equations for the time evolution of the \
locations of the motor anchors and the cargo center. Derivation is detailed \
in the documentation.\
\>", "Text",
 CellChangeTimes->{{3.684120135236116*^9, 3.684120217257021*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "total", " ", "number", " ", "of", " ", "pulling", " ", "motors", " ", 
    "we", " ", "want", " ", "to", " ", "generate", " ", "the", " ", "system", 
    " ", "for"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"nmotors", "=", "0"}], ";"}]}]], "Input",
 CellChangeTimes->{{3.684006850561824*^9, 3.684006853861206*^9}, {
  3.6840072635739937`*^9, 3.68400726366322*^9}, {3.6840893617167673`*^9, 
  3.6840893939810457`*^9}, {3.684097990182609*^9, 3.684097990225583*^9}, {
  3.6854664258235607`*^9, 3.685466425876886*^9}, {3.6857540109185762`*^9, 
  3.685754010974689*^9}, {3.685828311577764*^9, 3.685828311667633*^9}, {
  3.685828374015864*^9, 3.685828420736113*^9}}],

Cell["Generate equations for the sum of forces on each anchor", "Text",
 CellChangeTimes->{
  3.68408951466551*^9, {3.684120232337236*^9, 3.68412024186471*^9}, {
   3.685828407663378*^9, 3.685828408214705*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"anchorForceEqs", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"i", "=", "0"}], ",", 
   RowBox[{"i", "<", "nmotors"}], ",", 
   RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{"eqs", "=", 
    RowBox[{"Join", "[", 
     RowBox[{
      RowBox[{"sumForcesAnchor", "[", "i", "]"}], ",", "anchorForceEqs"}], 
     "]"}]}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{
  3.684005070286366*^9, {3.6840051312591476`*^9, 3.684005133171887*^9}, 
   3.684005242189466*^9, {3.684005531014655*^9, 3.684005551658716*^9}, {
   3.6840058716408367`*^9, 3.6840059376885777`*^9}, {3.684006011387332*^9, 
   3.6840061546669416`*^9}, {3.6840062047076063`*^9, 3.684006260461534*^9}, {
   3.684006397970166*^9, 3.684006408780736*^9}, {3.684006770861298*^9, 
   3.684006770939032*^9}, {3.684006847011498*^9, 3.684006848034906*^9}, 
   3.684006890627513*^9, {3.684007223604097*^9, 3.6840072271365547`*^9}, {
   3.684014337611184*^9, 3.684014340484227*^9}, 3.684014716323448*^9, {
   3.684014771126289*^9, 3.6840148501529713`*^9}, {3.684015321471341*^9, 
   3.6840153685980673`*^9}, {3.684015415308132*^9, 3.684015462714096*^9}, {
   3.684080544953635*^9, 3.6840805699907846`*^9}, {3.684081747967907*^9, 
   3.684081759326367*^9}, {3.684087989732126*^9, 3.6840880671649942`*^9}, {
   3.684088139734612*^9, 3.684088216559649*^9}, {3.68408826850152*^9, 
   3.684088355553761*^9}, {3.684088419363763*^9, 3.6840884231884604`*^9}, {
   3.684088473207036*^9, 3.6840885556043987`*^9}, {3.684088586943572*^9, 
   3.6840885972592154`*^9}, {3.684088636161887*^9, 3.684088742237227*^9}, {
   3.684089313331225*^9, 3.684089360368815*^9}, {3.684089398743702*^9, 
   3.6840894079775476`*^9}, {3.68408951830622*^9, 3.6840895462268972`*^9}, {
   3.684122183840743*^9, 3.684122188798298*^9}, 3.684122220062153*^9, {
   3.6853102496908216`*^9, 3.6853103371005163`*^9}, {3.685310946070952*^9, 
   3.68531095054405*^9}, {3.685315848064104*^9, 3.685315883487076*^9}, {
   3.685828246609861*^9, 3.6858283164940443`*^9}, {3.6858283875157013`*^9, 
   3.6858283989903193`*^9}, 3.685828541044977*^9}],

Cell["Sum of forces on cargo", "Text",
 CellChangeTimes->{{3.6840895537751904`*^9, 3.68408955812895*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cargoForceEqs", "=", "\[IndentingNewLine]", 
  RowBox[{"sumForcesCargo", "[", "nmotors", "]"}]}]], "Input",
 CellChangeTimes->{
  3.684005070286366*^9, {3.6840051312591476`*^9, 3.684005133171887*^9}, 
   3.684005242189466*^9, {3.684005531014655*^9, 3.684005551658716*^9}, {
   3.6840058716408367`*^9, 3.6840059376885777`*^9}, {3.684006011387332*^9, 
   3.6840061546669416`*^9}, {3.6840062047076063`*^9, 3.684006260461534*^9}, {
   3.684006397970166*^9, 3.684006408780736*^9}, {3.684006770861298*^9, 
   3.684006770939032*^9}, {3.684006847011498*^9, 3.684006848034906*^9}, 
   3.684006890627513*^9, {3.684007223604097*^9, 3.6840072271365547`*^9}, {
   3.684014337611184*^9, 3.684014340484227*^9}, 3.684014716323448*^9, {
   3.684014771126289*^9, 3.6840148501529713`*^9}, {3.684015321471341*^9, 
   3.6840153685980673`*^9}, {3.684015415308132*^9, 3.684015462714096*^9}, {
   3.684080544953635*^9, 3.6840805699907846`*^9}, {3.684081747967907*^9, 
   3.684081759326367*^9}, {3.684087989732126*^9, 3.6840880671649942`*^9}, {
   3.684088139734612*^9, 3.684088216559649*^9}, {3.68408826850152*^9, 
   3.684088355553761*^9}, {3.684088419363763*^9, 3.6840884231884604`*^9}, {
   3.684088473207036*^9, 3.6840885556043987`*^9}, {3.684088586943572*^9, 
   3.6840885972592154`*^9}, {3.684088636161887*^9, 3.684088742237227*^9}, {
   3.684089313331225*^9, 3.684089360368815*^9}, {3.684089398743702*^9, 
   3.6840894079775476`*^9}, {3.68408951830622*^9, 3.684089533992002*^9}, {
   3.684089567748877*^9, 3.6840895740818777`*^9}, {3.684089930559786*^9, 
   3.684089956592085*^9}, {3.6841229557080793`*^9, 3.684122962490375*^9}, {
   3.685310249705818*^9, 3.6853103371369457`*^9}, {3.685311941275979*^9, 
   3.68531194366955*^9}, 3.685312833879428*^9, {3.685315899410948*^9, 
   3.685315901779602*^9}, {3.6858282923859453`*^9, 3.685828325876506*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"xiCargoTranslation", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"c", "[", "0", "]"}]}], "+", 
          RowBox[{"c1", "[", "0", "]"}]}], ")"}]}], "dt"]}], "+", 
     RowBox[{"Fsteric", "[", "0", "]"}], "+", 
     RowBox[{"Ftrap", "[", "0", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"xiCargoTranslation", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"c", "[", "1", "]"}]}], "+", 
          RowBox[{"c1", "[", "1", "]"}]}], ")"}]}], "dt"]}], "+", 
     RowBox[{"Fsteric", "[", "1", "]"}], "+", 
     RowBox[{"Ftrap", "[", "1", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"xiCargoTranslation", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"c", "[", "2", "]"}]}], "+", 
          RowBox[{"c1", "[", "2", "]"}]}], ")"}]}], "dt"]}], "+", 
     RowBox[{"Fsteric", "[", "2", "]"}], "+", 
     RowBox[{"Ftrap", "[", "2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.685828326232514*^9, 3.685828548538796*^9, 
  3.6858299447514553`*^9, 3.685830000008939*^9}]
}, Open  ]],

Cell["Sum of torques on cargo", "Text",
 CellChangeTimes->{{3.684089592644373*^9, 3.684089598662537*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cargoTorqueEqs", "=", 
  RowBox[{"sumTorquesCargo", "[", "nmotors", "]"}]}]], "Input",
 CellChangeTimes->{
  3.684005070286366*^9, {3.6840051312591476`*^9, 3.684005133171887*^9}, 
   3.684005242189466*^9, {3.684005531014655*^9, 3.684005551658716*^9}, {
   3.6840058716408367`*^9, 3.6840059376885777`*^9}, {3.684006011387332*^9, 
   3.6840061546669416`*^9}, {3.6840062047076063`*^9, 3.684006260461534*^9}, {
   3.684006397970166*^9, 3.684006408780736*^9}, {3.684006770861298*^9, 
   3.684006770939032*^9}, {3.684006847011498*^9, 3.684006848034906*^9}, 
   3.684006890627513*^9, {3.684007223604097*^9, 3.6840072271365547`*^9}, {
   3.684014337611184*^9, 3.684014340484227*^9}, 3.684014716323448*^9, {
   3.684014771126289*^9, 3.6840148501529713`*^9}, {3.684015321471341*^9, 
   3.6840153685980673`*^9}, {3.684015415308132*^9, 3.684015462714096*^9}, {
   3.684080544953635*^9, 3.6840805699907846`*^9}, {3.684081747967907*^9, 
   3.684081759326367*^9}, {3.684087989732126*^9, 3.6840880671649942`*^9}, {
   3.684088139734612*^9, 3.684088216559649*^9}, {3.68408826850152*^9, 
   3.684088355553761*^9}, {3.684088419363763*^9, 3.6840884231884604`*^9}, {
   3.684088473207036*^9, 3.6840885556043987`*^9}, {3.684088586943572*^9, 
   3.6840885972592154`*^9}, {3.684088636161887*^9, 3.684088742237227*^9}, {
   3.684089313331225*^9, 3.684089360368815*^9}, {3.684089398743702*^9, 
   3.6840894079775476`*^9}, {3.68408951830622*^9, 3.684089533992002*^9}, {
   3.6840896356471*^9, 3.684089814302346*^9}, {3.684089845105513*^9, 
   3.68408991459612*^9}, 3.684089960788517*^9, {3.684122998251582*^9, 
   3.684123000577752*^9}, {3.685310249720796*^9, 3.685310337166182*^9}, {
   3.685311946864621*^9, 3.685311951589477*^9}, {3.685315927059969*^9, 
   3.6853159356187067`*^9}, 3.685407204998826*^9, {3.685828337813396*^9, 
   3.6858283458148003`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "0", "]"}]}], "+", 
     RowBox[{"TorqeExt", "[", "0", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "1", "]"}]}], "+", 
     RowBox[{"TorqeExt", "[", "1", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "2", "]"}]}], "+", 
     RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.685828346130962*^9, 3.6858285509501867`*^9, 
  3.6858299448094263`*^9, 3.685830000074171*^9}]
}, Open  ]],

Cell["Join the equations together into a system", "Text",
 CellChangeTimes->{{3.684120271360635*^9, 3.684120284488654*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqs", "=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{"anchorForceEqs", ",", "cargoForceEqs", ",", "cargoTorqueEqs"}], 
    "]"}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.684089980552536*^9, 3.684090010918826*^9}, {
   3.684090232081958*^9, 3.684090234325091*^9}, 3.685311086986302*^9, 
   3.6853113812724037`*^9, 3.685315959198448*^9, 3.6853218195625963`*^9, {
   3.68546641175907*^9, 3.68546641995942*^9}, {3.685828556344092*^9, 
   3.68582855934695*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"xiCargoTranslation", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"c", "[", "0", "]"}]}], "+", 
          RowBox[{"c1", "[", "0", "]"}]}], ")"}]}], "dt"]}], "+", 
     RowBox[{"Fsteric", "[", "0", "]"}], "+", 
     RowBox[{"Ftrap", "[", "0", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"xiCargoTranslation", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"c", "[", "1", "]"}]}], "+", 
          RowBox[{"c1", "[", "1", "]"}]}], ")"}]}], "dt"]}], "+", 
     RowBox[{"Fsteric", "[", "1", "]"}], "+", 
     RowBox[{"Ftrap", "[", "1", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"xiCargoTranslation", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           RowBox[{"c", "[", "2", "]"}]}], "+", 
          RowBox[{"c1", "[", "2", "]"}]}], ")"}]}], "dt"]}], "+", 
     RowBox[{"Fsteric", "[", "2", "]"}], "+", 
     RowBox[{"Ftrap", "[", "2", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "0", "]"}]}], "+", 
     RowBox[{"TorqeExt", "[", "0", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "1", "]"}]}], "+", 
     RowBox[{"TorqeExt", "[", "1", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "2", "]"}]}], "+", 
     RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.685466412184204*^9, 3.685466429166615*^9}, 
   3.685828351106122*^9, 3.685828560958568*^9, 3.6858299448611927`*^9, 
   3.685830000141055*^9}]
}, Open  ]],

Cell["\<\
Write out the dependent variables, namely the next positions of the anchors \
and the cargo, plus the rotational velocity of the cargo\
\>", "Text",
 CellChangeTimes->{{3.684120287592751*^9, 3.684120343729823*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"vars", "[", "nmotors", "]"}]], "Input",
 CellChangeTimes->{{3.6858285812416973`*^9, 3.6858285856162786`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"c1", "[", "0", "]"}], ",", 
   RowBox[{"c1", "[", "1", "]"}], ",", 
   RowBox[{"c1", "[", "2", "]"}], ",", 
   RowBox[{"omega", "[", "0", "]"}], ",", 
   RowBox[{"omega", "[", "1", "]"}], ",", 
   RowBox[{"omega", "[", "2", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.685828586318342*^9, 3.685829944908827*^9, 
  3.6858300002063713`*^9}]
}, Open  ]],

Cell["\<\
Turn this system of equations into a matrix problem, A.x=b (here A is coeff, \
b is const)\
\>", "Text",
 CellChangeTimes->{{3.684120365657811*^9, 3.6841204054416533`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{"const", ",", "coeff"}], "}"}], "=", 
  RowBox[{"Normal", "@", 
   RowBox[{"CoefficientArrays", "[", 
    RowBox[{"eqs", ",", 
     RowBox[{"vars", "[", "nmotors", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.684006457661401*^9, 3.684006473456142*^9}, 
   3.684006567281929*^9, {3.6840068386748257`*^9, 3.6840068409015713`*^9}, {
   3.68400763564538*^9, 3.68400771497747*^9}, {3.684018572112109*^9, 
   3.6840185898307133`*^9}, {3.684018683936425*^9, 3.6840186930152273`*^9}, {
   3.685466463688097*^9, 3.685466487392379*^9}, {3.685466532685004*^9, 
   3.68546654503307*^9}, {3.685828597766316*^9, 3.68582861861237*^9}, 
   3.68582892453447*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"xiCargoTranslation", " ", 
         RowBox[{"c", "[", "0", "]"}]}], "dt"]}], "-", 
      RowBox[{"Fsteric", "[", "0", "]"}], "-", 
      RowBox[{"Ftrap", "[", "0", "]"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"xiCargoTranslation", " ", 
         RowBox[{"c", "[", "1", "]"}]}], "dt"]}], "-", 
      RowBox[{"Fsteric", "[", "1", "]"}], "-", 
      RowBox[{"Ftrap", "[", "1", "]"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"xiCargoTranslation", " ", 
         RowBox[{"c", "[", "2", "]"}]}], "dt"]}], "-", 
      RowBox[{"Fsteric", "[", "2", "]"}], "-", 
      RowBox[{"Ftrap", "[", "2", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"TorqeExt", "[", "0", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}], ",", 
     RowBox[{"-", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       FractionBox["xiCargoTranslation", "dt"], ",", "0", ",", "0", ",", "0", 
       ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", 
       FractionBox["xiCargoTranslation", "dt"], ",", "0", ",", "0", ",", "0", 
       ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0", ",", 
       FractionBox["xiCargoTranslation", "dt"], ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "xiCargoRotation", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "xiCargoRotation", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "xiCargoRotation"}], 
      "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.685466464954368*^9, 3.6854664884308987`*^9}, 
   3.68546654588288*^9, 3.685466601586219*^9, 3.685466753858857*^9, {
   3.685828610788693*^9, 3.6858286190085087`*^9}, 3.685829944959511*^9, 
   3.685830000273793*^9}]
}, Open  ]],

Cell["\<\
The result should be arrays of 3(nmotors+2) equations (3 components: x, y, z \
for each of the nmotors sum of forces equations for each motor, plus 2 for \
sum of forces and torques on cargo)\
\>", "Text",
 CellChangeTimes->{{3.68409051956328*^9, 3.6840905649788847`*^9}, {
  3.684097800709556*^9, 3.684097889425914*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"3", 
  RowBox[{"(", 
   RowBox[{"nmotors", "+", "2"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "coeff", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "const", "]"}]}], "Input",
 CellChangeTimes->{{3.6840073635073347`*^9, 3.684007374239601*^9}, {
  3.684090336371669*^9, 3.684090341610797*^9}, {3.68409048355317*^9, 
  3.684090510507255*^9}}],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{
  3.6840073745679693`*^9, 3.684090274299241*^9, 3.6840903419678907`*^9, {
   3.684090493743384*^9, 3.684090511548506*^9}, 3.684097995580967*^9, 
   3.6841210011171627`*^9, 3.68412301856791*^9, 3.6841231823267403`*^9, 
   3.6853105476689053`*^9, {3.68531061492318*^9, 3.685310627529491*^9}, 
   3.685310698510097*^9, {3.685310955889697*^9, 3.685310967860005*^9}, {
   3.6853112207724257`*^9, 3.685311239337963*^9}, 3.685311387996059*^9, 
   3.6853114936080837`*^9, 3.685312008985652*^9, 3.685312840214675*^9, {
   3.685312984545863*^9, 3.685313000700417*^9}, 3.685314856186658*^9, 
   3.685316607540236*^9, 3.68532186573781*^9, 3.68538915128854*^9, 
   3.685407227339322*^9, 3.685407514299226*^9, 3.6854165023059273`*^9, 
   3.685465689070839*^9, 3.6854664292788057`*^9, 3.685828633602516*^9, 
   3.685829945010229*^9, 3.6858300003405523`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"6", ",", "6"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6840073745679693`*^9, 3.684090274299241*^9, 3.6840903419678907`*^9, {
   3.684090493743384*^9, 3.684090511548506*^9}, 3.684097995580967*^9, 
   3.6841210011171627`*^9, 3.68412301856791*^9, 3.6841231823267403`*^9, 
   3.6853105476689053`*^9, {3.68531061492318*^9, 3.685310627529491*^9}, 
   3.685310698510097*^9, {3.685310955889697*^9, 3.685310967860005*^9}, {
   3.6853112207724257`*^9, 3.685311239337963*^9}, 3.685311387996059*^9, 
   3.6853114936080837`*^9, 3.685312008985652*^9, 3.685312840214675*^9, {
   3.685312984545863*^9, 3.685313000700417*^9}, 3.685314856186658*^9, 
   3.685316607540236*^9, 3.68532186573781*^9, 3.68538915128854*^9, 
   3.685407227339322*^9, 3.685407514299226*^9, 3.6854165023059273`*^9, 
   3.685465689070839*^9, 3.6854664292788057`*^9, 3.685828633602516*^9, 
   3.685829945010229*^9, 3.685830000348908*^9}],

Cell[BoxData[
 RowBox[{"{", "6", "}"}]], "Output",
 CellChangeTimes->{
  3.6840073745679693`*^9, 3.684090274299241*^9, 3.6840903419678907`*^9, {
   3.684090493743384*^9, 3.684090511548506*^9}, 3.684097995580967*^9, 
   3.6841210011171627`*^9, 3.68412301856791*^9, 3.6841231823267403`*^9, 
   3.6853105476689053`*^9, {3.68531061492318*^9, 3.685310627529491*^9}, 
   3.685310698510097*^9, {3.685310955889697*^9, 3.685310967860005*^9}, {
   3.6853112207724257`*^9, 3.685311239337963*^9}, 3.685311387996059*^9, 
   3.6853114936080837`*^9, 3.685312008985652*^9, 3.685312840214675*^9, {
   3.685312984545863*^9, 3.685313000700417*^9}, 3.685314856186658*^9, 
   3.685316607540236*^9, 3.68532186573781*^9, 3.68538915128854*^9, 
   3.685407227339322*^9, 3.685407514299226*^9, 3.6854165023059273`*^9, 
   3.685465689070839*^9, 3.6854664292788057`*^9, 3.685828633602516*^9, 
   3.685829945010229*^9, 3.685830000354797*^9}]
}, Open  ]],

Cell["\<\
Using solve doesn\[CloseCurlyQuote]t appear to work, might be able to get it \
to with assumptions (would take forever to write out all of them)\
\>", "Text",
 CellChangeTimes->{{3.6840903656185904`*^9, 3.684090404678144*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"coeff", ".", "vars"}], "\[Equal]", 
    RowBox[{"-", "const"}]}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.684007612164157*^9, 3.684007620669202*^9}, {
  3.684007723167364*^9, 3.6840077366785316`*^9}, {3.6840903584979773`*^9, 
  3.6840903614333344`*^9}, {3.6853164915929317`*^9, 3.685316524328871*^9}}],

Cell["\<\
However, Mathematica seems to have no trouble inverting the matrix, so we can \
solve it that way\
\>", "Text",
 CellChangeTimes->{{3.684090575250648*^9, 3.684090599493772*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"coeffinv", "=", 
  RowBox[{
   RowBox[{"Inverse", "[", "coeff", "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.684008936600967*^9, 3.6840089402770147`*^9}, {
   3.684009201118938*^9, 3.684009236499383*^9}, {3.684018702408951*^9, 
   3.68401870405695*^9}, 3.685828645128818*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["dt", "xiCargoTranslation"], ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     FractionBox["dt", "xiCargoTranslation"], ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     FractionBox["dt", "xiCargoTranslation"], ",", "0", ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     FractionBox["1", "xiCargoRotation"], ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox["1", "xiCargoRotation"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox["1", "xiCargoRotation"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.685828645478323*^9, 3.685829003256584*^9, 
  3.6858299450803413`*^9, 3.685830000409309*^9}]
}, Open  ]],

Cell["\<\
Note that division by \[Xi] here makes things complicated looking. We can \
make things simpler (and computationally more efficient) by substituting \
\[Mu] for \[Xi]\
\>", "Text",
 CellChangeTimes->{{3.685828779711783*^9, 3.685828837706332*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"coeffinv", "/.", "xi2muRules"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6858288614430733`*^9, 3.685828866107645*^9}, {
  3.685828931826099*^9, 3.685828933005341*^9}, {3.68582899706152*^9, 
  3.6858290073209457`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dt", " ", "muCargoTranslation"}], ",", "0", ",", "0", ",", "0", 
     ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     RowBox[{"dt", " ", "muCargoTranslation"}], ",", "0", ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"dt", " ", "muCargoTranslation"}], ",", "0", ",", "0", ",", 
     "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "muCargoRotation", ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "muCargoRotation", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "muCargoRotation"}], 
    "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6858288670323877`*^9, 3.685828904077429*^9, {3.6858289995816803`*^9, 
   3.685829007850812*^9}, 3.685829945126411*^9, 3.685830000474366*^9}]
}, Open  ]],

Cell[TextData[{
 "Then the solution to the system is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"x", "=", 
    RowBox[{
     SuperscriptBox["A", 
      RowBox[{"-", "1"}]], "b"}]}], TraditionalForm]]],
 "\nNote we have to matrix multiply by -const here because of how \
CoefficiantArrays works"
}], "Text",
 CellChangeTimes->{{3.6841204255853567`*^9, 3.684120460783022*^9}, {
  3.685316433789064*^9, 3.685316485527651*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invsoln", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Thread", "[", 
     RowBox[{
      RowBox[{"vars", "[", "nmotors", "]"}], "==", 
      RowBox[{"coeffinv", ".", 
       RowBox[{"-", "const"}]}]}], "]"}], "/.", "xi2muRules"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.684009261274222*^9, 3.68400926910183*^9}, {
   3.6840183088171263`*^9, 3.6840183235085773`*^9}, {3.684018479524437*^9, 
   3.684018481980887*^9}, {3.684019141901951*^9, 3.684019153859799*^9}, 
   3.684120990724759*^9, 3.6853162705297537`*^9, 3.685316385449687*^9, 
   3.68531642724189*^9, 3.685828762915794*^9, {3.685828949879328*^9, 
   3.685828964312749*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}], "\[Equal]", 
    RowBox[{"c1", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}], "\[Equal]", 
    RowBox[{"c1", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}], "\[Equal]", 
    RowBox[{"c1", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"TorqeExt", "[", "0", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"TorqeExt", "[", "1", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.685828764811056*^9, {3.685828875718629*^9, 3.685828906371331*^9}, {
   3.685828957057055*^9, 3.685828964756418*^9}, 3.6858290125844383`*^9, 
   3.6858299451764727`*^9, 3.68583000054137*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["All in one function", "Section",
 CellChangeTimes->{{3.684098051773768*^9, 3.684098060121355*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqs", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eqs", ",", "i", ",", "coeff", ",", "coeffinv", ",", "const", ",", 
      "rhs"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "<", "nmotors"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqs", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"sumForcesAnchor", "[", "i", "]"}], ",", "eqs"}], "]"}]}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumForcesCargo", "[", "nmotors", "]"}], ",", "eqs"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumTorquesCargo", "[", "nmotors", "]"}], ",", "eqs"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"const", ",", "coeff"}], "}"}], "=", 
      RowBox[{"Normal", "@", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"eqs", ",", 
         RowBox[{"vars", "[", "nmotors", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coeffinv", "=", 
      RowBox[{"Inverse", "[", "coeff", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"vars", "[", "nmotors", "]"}], "\[Equal]", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"Simplify", "[", 
         RowBox[{
          RowBox[{"coeffinv", ".", 
           RowBox[{"-", "const"}]}], "/.", "xi2muRules"}], "]"}], "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.684098061912445*^9, 3.6840980638957357`*^9}, {
   3.684098157760518*^9, 3.684098223909584*^9}, {3.684098255264639*^9, 
   3.684098327748281*^9}, {3.684098365189097*^9, 3.684098451058679*^9}, {
   3.684098934649769*^9, 3.684099001226726*^9}, {3.684121899512581*^9, 
   3.6841219994825993`*^9}, {3.684122106585373*^9, 3.684122110992721*^9}, {
   3.684122272949432*^9, 3.684122307916671*^9}, {3.6841223491138*^9, 
   3.6841226416906548`*^9}, {3.684122933382709*^9, 3.684122938763883*^9}, {
   3.684122979124536*^9, 3.684122981515399*^9}, {3.684123940649873*^9, 
   3.6841239410173798`*^9}, {3.685310249758493*^9, 3.685310337079584*^9}, {
   3.685310576306416*^9, 3.6853105797907267`*^9}, {3.685311168075555*^9, 
   3.685311184072341*^9}, {3.685311982567634*^9, 3.685311990437042*^9}, 
   3.6853128228708763`*^9, {3.685312979958774*^9, 3.6853129946652946`*^9}, {
   3.685314765160187*^9, 3.685314771991033*^9}, {3.685314804552919*^9, 
   3.6853148507746*^9}, 3.6853164076918983`*^9, {3.685407062408455*^9, 
   3.685407119725513*^9}, {3.6854668367367983`*^9, 3.685466871140676*^9}, {
   3.685466926895163*^9, 3.685466932396701*^9}, {3.685467020170374*^9, 
   3.6854670374150133`*^9}, {3.6854670737191153`*^9, 3.685467115309704*^9}, {
   3.68546716593781*^9, 3.6854671794756613`*^9}, {3.6854673211762342`*^9, 
   3.685467325482188*^9}, {3.685468368218431*^9, 3.685468388771576*^9}, {
   3.6854684309544888`*^9, 3.685468501259468*^9}, 3.685468705593649*^9, {
   3.685479818411285*^9, 3.68547982025599*^9}, {3.685479907374518*^9, 
   3.685479922300652*^9}, {3.685479971532043*^9, 3.685479973553548*^9}, 
   3.6858262040682383`*^9, {3.6858262838413143`*^9, 3.6858263826021023`*^9}, {
   3.685827831408823*^9, 3.685827857732307*^9}, 3.685828710267296*^9, {
   3.685828747379861*^9, 3.685828748532259*^9}, {3.6858290377755136`*^9, 
   3.685829039564406*^9}, {3.685829075181864*^9, 3.6858291854307013`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing", "Section",
 CellChangeTimes->{{3.6853117361432056`*^9, 3.6853117417205057`*^9}}],

Cell["0 motors case, easiest to look at", "Text",
 CellChangeTimes->{{3.685468243444017*^9, 3.685468246569477*^9}, {
  3.685829304331546*^9, 3.685829311969603*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invsoln", "=", 
  RowBox[{"generateEqs", "[", "0", "]"}]}]], "Input",
 CellChangeTimes->{{3.685311743265396*^9, 3.685311755806418*^9}, {
   3.685311807129068*^9, 3.685311817816437*^9}, 3.685312289331439*^9, {
   3.685315190211714*^9, 3.685315216419607*^9}, {3.685465596646974*^9, 
   3.685465603122868*^9}, {3.685465731576527*^9, 3.685465768441174*^9}, {
   3.6854658921805353`*^9, 3.685465893034176*^9}, {3.685466014028411*^9, 
   3.685466016964177*^9}, {3.685466123998111*^9, 3.6854661250868187`*^9}, {
   3.685466915351313*^9, 3.685466915440946*^9}, {3.685466964378644*^9, 
   3.68546696440827*^9}, {3.685467340476569*^9, 3.6854673405430393`*^9}, {
   3.6854673712781897`*^9, 3.685467406068653*^9}, {3.6854674408004427`*^9, 
   3.685467447485281*^9}, {3.685467545417192*^9, 3.685467548386901*^9}, {
   3.685468096884213*^9, 3.685468096945269*^9}, {3.685468667071039*^9, 
   3.6854686806721163`*^9}, {3.6854687628765507`*^9, 3.685468767754199*^9}, {
   3.685479984826449*^9, 3.685479984913291*^9}, {3.685829027683874*^9, 
   3.685829027739738*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"TorqeExt", "[", "0", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"TorqeExt", "[", "1", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6854656034895372`*^9, 3.685465689213483*^9, 3.685465735106903*^9, 
   3.685465768915318*^9, 3.685465893772629*^9, 3.68546612617142*^9, 
   3.685466880574355*^9, {3.6854669161991043`*^9, 3.685466964984136*^9}, 
   3.6854670429073687`*^9, {3.685467183253808*^9, 3.685467185255321*^9}, {
   3.6854673354207697`*^9, 3.685467341113183*^9}, {3.6854673718206882`*^9, 
   3.685467406384935*^9}, 3.685467448683988*^9, 3.68546755005589*^9, 
   3.685468097487165*^9, 3.6854685124959383`*^9, {3.685468664171893*^9, 
   3.685468668721938*^9}, {3.685468700456657*^9, 3.685468728004751*^9}, {
   3.6854687636334343`*^9, 3.685468768208918*^9}, {3.685479979743922*^9, 
   3.685479985829925*^9}, {3.685829028584985*^9, 3.685829047248519*^9}, 
   3.685829099240533*^9, {3.685829138445758*^9, 3.6858291879932823`*^9}, 
   3.685829337146323*^9, 3.6858299452296047`*^9, 3.685830000609424*^9}]
}, Open  ]],

Cell["If all forces are 0, should simplify to a1=a, c1=c, omega=0", "Text",
 CellChangeTimes->{{3.685312226178508*^9, 3.685312269040287*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"invsoln", "=", 
   RowBox[{"generateEqs", "[", "1", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685311743265396*^9, 3.685311755806418*^9}, {
   3.685311807129068*^9, 3.685311817816437*^9}, 3.685312289331439*^9, {
   3.685315190211714*^9, 3.685315216419607*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"invsoln", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}], "\[Rule]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "0", "]"}], "[", "1", "]"}], "\[Rule]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "0", "]"}], "[", "2", "]"}], "\[Rule]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "0", "]"}], "[", "0", "]"}], "\[Rule]", "0"}],
      ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "0", "]"}], "[", "1", "]"}], "\[Rule]", "0"}],
      ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "0", "]"}], "[", "2", "]"}], "\[Rule]", "0"}],
      ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6853118098066807`*^9, 3.68531184518676*^9}, {
  3.685312044684111*^9, 3.685312059048627*^9}, {3.6853121588028812`*^9, 
  3.685312206507292*^9}, {3.685407166613646*^9, 3.685407176299637*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c1", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c1", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c1", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "2", "]"}], "\[Equal]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6853122070263243`*^9, {3.685312841610694*^9, 3.685312861320689*^9}, {
   3.685312985869761*^9, 3.685313001665258*^9}, {3.6853148573301992`*^9, 
   3.6853148799213457`*^9}, 3.685315294823612*^9, 3.685316414325128*^9, {
   3.685316595181591*^9, 3.6853166081293697`*^9}, 3.685321866171012*^9, 
   3.685389152058531*^9, 3.6854071841584272`*^9, 3.685407229771969*^9, 
   3.685407515901168*^9, 3.68541650383854*^9, 3.685465690923542*^9, 
   3.685468858570932*^9, 3.685829337610828*^9, 3.685829945683701*^9, 
   3.685830001064843*^9}]
}, Open  ]],

Cell["For more anchors ", "Text",
 CellChangeTimes->{{3.685469932854989*^9, 3.685469941074626*^9}, {
  3.685469972383471*^9, 3.685469974543227*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"invsoln", "=", 
   RowBox[{"generateEqs", "[", "2", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685311743265396*^9, 3.685311755806418*^9}, {
   3.685311807129068*^9, 3.685311817816437*^9}, 3.685312289331439*^9, {
   3.685315190211714*^9, 3.685315216419607*^9}, {3.685469994158395*^9, 
   3.685469994243108*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"invsoln", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], 
      "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], 
      "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6853118098066807`*^9, 3.68531184518676*^9}, {
   3.685312044684111*^9, 3.685312059048627*^9}, {3.6853121588028812`*^9, 
   3.685312206507292*^9}, {3.685407166613646*^9, 3.685407176299637*^9}, {
   3.685469997437358*^9, 3.6854700419430323`*^9}, {3.685470075414962*^9, 
   3.685470084489835*^9}, 3.68547239881627*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "1", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "1", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "1", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c1", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c1", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c1", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "2", "]"}], "\[Equal]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6853122070263243`*^9, {3.685312841610694*^9, 3.685312861320689*^9}, {
   3.685312985869761*^9, 3.685313001665258*^9}, {3.6853148573301992`*^9, 
   3.6853148799213457`*^9}, 3.685315294823612*^9, 3.685316414325128*^9, {
   3.685316595181591*^9, 3.6853166081293697`*^9}, 3.685321866171012*^9, 
   3.685389152058531*^9, 3.6854071841584272`*^9, 3.685407229771969*^9, 
   3.685407515901168*^9, 3.68541650383854*^9, 3.685465690923542*^9, 
   3.685468858570932*^9, {3.685470060591865*^9, 3.685470085048129*^9}, 
   3.685829339345428*^9, 3.6858299474523983`*^9, 3.68583000279001*^9}]
}, Open  ]],

Cell["\<\
Want to take a look at equations for only external torque in the z direction \
- should change location of anchors, but not the cargo and should have \
non-zero omega\
\>", "Text",
 CellChangeTimes->{{3.685470100520462*^9, 3.6854701195630827`*^9}, {
  3.685471093817589*^9, 3.685471095771871*^9}, {3.6854724282536697`*^9, 
  3.6854724307388973`*^9}, {3.685829356115245*^9, 3.68582937356329*^9}, {
  3.685829504546586*^9, 3.6858295184290533`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"invsoln", "=", 
   RowBox[{"generateEqs", "[", "1", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685470128162623*^9, 3.6854701282293262`*^9}, 
   3.685471596681834*^9, 3.685472300550909*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"invsoln", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], 
      "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], 
      "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "1", "]"}], "\[Rule]", "0"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.685470146567751*^9, 3.685470147511881*^9}, {
  3.685472402882764*^9, 3.685472407294991*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "2", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", "[", "1", "]"}], "-", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], ")"}]}]}], 
    "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "2", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c", "[", "0", "]"}], "-", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c1", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c1", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c1", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.68547014800445*^9, 3.685472408826877*^9, 
  3.685829339830903*^9, 3.685829947933159*^9, 3.685830003239458*^9}]
}, Open  ]],

Cell["\<\
Want to look at external force in x direction - should change locations of \
cargo and anchors together, only in x direction\
\>", "Text",
 CellChangeTimes->{{3.685472357470635*^9, 3.6854723737015533`*^9}, {
  3.6858295219615383`*^9, 3.685829548849044*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"invsoln", "=", 
   RowBox[{"generateEqs", "[", "1", "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.685470128162623*^9, 3.6854701282293262`*^9}, 
   3.685471596681834*^9, 3.685472300550909*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"invsoln", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], 
      "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], 
      "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.685470146567751*^9, 3.685470147511881*^9}, {
  3.6854723303599453`*^9, 3.685472338031509*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"Ftrap", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"Ftrap", "[", "0", "]"}]}]}], "\[Equal]", 
    RowBox[{"c1", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c1", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c1", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "0", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "1", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "2", "]"}], "\[Equal]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.68547014800445*^9, 3.685472340124744*^9, 
  3.685480113331581*^9, 3.68582934019545*^9, 3.685829948346559*^9, 
  3.685830003605783*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Write file with iterations of different numbers of motors", "Section",
 CellChangeTimes->{{3.684098531303584*^9, 3.684098537535494*^9}, {
  3.684098604822413*^9, 3.684098628446341*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"outfileLoc", "=", 
   RowBox[{"CreateFile", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<forwardequations.c\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outfile", "=", 
   RowBox[{"File", "[", "outfileLoc", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.684098648719748*^9, 3.684098677654524*^9}, 
   3.6840991788294983`*^9, 3.68409921040814*^9, {3.684102465568993*^9, 
   3.684102482037467*^9}, {3.684102558481722*^9, 3.684102578910823*^9}, {
   3.684122712337173*^9, 3.684122713519846*^9}}],

Cell["Write C function beginning lines", "Text",
 CellChangeTimes->{{3.6840992130621567`*^9, 3.684099228238578*^9}}],

Cell[BoxData[{
 RowBox[{"WriteString", "[", 
  RowBox[{
  "outfile", ",", "\"\<//prototypes\>\"", ",", "\"\<\\n\>\"", ",", 
   "\"\<void compute_next_locations();\>\"", ",", "\"\<\\n\\n\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteString", "[", 
  RowBox[{
  "outfile", ",", "\"\<void compute_next_locations(){\>\"", ",", 
   "\"\<\\n\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteString", "[", 
  RowBox[{
  "outfile", ",", "\"\<    \>\"", ",", "\"\<switch(total_motors){\>\"", ",", 
   "\"\<\\n\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.684099231380281*^9, 3.684099240084999*^9}, {
  3.6840992762656183`*^9, 3.684099515878077*^9}, {3.6840996083649063`*^9, 
  3.684099671532875*^9}, {3.6840997024259577`*^9, 3.684099710873991*^9}, {
  3.68410043232519*^9, 3.684100434844616*^9}, {3.684100489632914*^9, 
  3.684100491769526*^9}, {3.684102822946341*^9, 3.684102824329294*^9}, {
  3.685388941745635*^9, 3.685388952817151*^9}, {3.685407473277313*^9, 
  3.685407474546224*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"j", "=", "0"}], ",", 
   RowBox[{"j", "\[LessEqual]", "5"}], ",", 
   RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteString", "[", 
     RowBox[{
     "outfile", ",", "\"\<        \>\"", ",", "\"\<case \>\"", ",", "j", ",", 
      "\"\<:\>\"", ",", "\"\<\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"invsoln", "=", 
     RowBox[{"generateEqs", "[", "j", "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", " ", 
       RowBox[{"3", 
        RowBox[{"(", 
         RowBox[{"j", "+", "2"}], ")"}]}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"if", " ", 
         RowBox[{"it", "'"}], "s", " ", "a", " ", "line", " ", "with", " ", 
         "omega"}], ",", " ", 
        RowBox[{
        "comment", " ", "it", " ", "out", " ", "since", " ", "we", " ", 
         "never", " ", "use", " ", "the", " ", "value", " ", "of", " ", 
         "omega"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[Equal]", " ", 
           RowBox[{"3", 
            RowBox[{"(", 
             RowBox[{"j", "+", "2"}], ")"}]}]}], "||", 
          RowBox[{"i", "\[Equal]", " ", 
           RowBox[{
            RowBox[{"3", 
             RowBox[{"(", 
              RowBox[{"j", "+", "2"}], ")"}]}], "-", "1"}]}], "||", 
          RowBox[{"i", "\[Equal]", " ", 
           RowBox[{
            RowBox[{"3", 
             RowBox[{"(", 
              RowBox[{"j", "+", "2"}], ")"}]}], "-", "2"}]}]}], ",", 
         RowBox[{"WriteString", "[", 
          RowBox[{"outfile", ",", "\"\<//\>\""}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{"outfile", ",", "\"\<            \>\"", ",", 
         RowBox[{"CForm", "[", 
          RowBox[{"invsoln", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
         "\"\<\\n\\n\>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"WriteString", "[", 
     RowBox[{
     "outfile", ",", "\"\<            \>\"", ",", "\"\<break;\>\"", ",", 
      "\"\<\\n\\n\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.684098684247036*^9, 3.684098766686006*^9}, {
   3.684098856697693*^9, 3.684098878004724*^9}, {3.684099061289969*^9, 
   3.6840991277763557`*^9}, 3.6840991935196753`*^9, {3.684099519804295*^9, 
   3.684099541348055*^9}, {3.6840997343083973`*^9, 3.684099816432733*^9}, {
   3.684100169619607*^9, 3.6841001736468277`*^9}, {3.684100402884281*^9, 
   3.684100411512261*^9}, {3.6841005086000032`*^9, 3.684100540493479*^9}, {
   3.68410061534379*^9, 3.684100657686246*^9}, {3.684100711764319*^9, 
   3.684100715138089*^9}, {3.685310680916917*^9, 3.685310683885453*^9}, {
   3.6853114763699017`*^9, 3.685311479619326*^9}, {3.685407221763399*^9, 
   3.685407221799777*^9}, {3.685465676220456*^9, 3.685465676259206*^9}, {
   3.6854659373040123`*^9, 3.685465953817956*^9}, {3.6854685904634333`*^9, 
   3.68546859084135*^9}, {3.685468806323731*^9, 3.6854688063796387`*^9}, {
   3.685471190990142*^9, 3.685471191024145*^9}, {3.6858090438046227`*^9, 
   3.685809117375259*^9}, {3.685809192345202*^9, 3.685809227111394*^9}, {
   3.685809340496956*^9, 3.685809353218791*^9}, {3.685809387948227*^9, 
   3.685809391389855*^9}, {3.685809431936461*^9, 3.685809437741338*^9}, {
   3.685809615973763*^9, 3.6858096344905577`*^9}, {3.68580970844851*^9, 
   3.685809710641583*^9}, {3.6858098008331947`*^9, 3.6858098265387697`*^9}}],

Cell[BoxData[{
 RowBox[{"WriteString", "[", 
  RowBox[{
  "outfile", ",", "\"\<        \>\"", ",", "\"\<default:\>\"", ",", 
   "\"\<\\n\>\"", ",", "\"\<            \>\"", ",", 
   "\"\<printf(\\\"Bad value for total_motors\\\\n\\\");\>\"", ",", 
   "\"\<\\n\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteString", "[", 
  RowBox[{"outfile", ",", "\"\<    }\\n\>\"", ",", "\"\<}\\n\>\""}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.684099840640665*^9, 3.684099931812181*^9}, {
  3.6840999744158993`*^9, 3.68409998222359*^9}, {3.684100043368163*^9, 
  3.684100084620983*^9}, {3.6841001168977137`*^9, 3.684100160693183*^9}, {
  3.684100202273947*^9, 3.6841002029258747`*^9}, {3.684100279347612*^9, 
  3.684100298168747*^9}, {3.684100370877803*^9, 3.6841003714731607`*^9}, {
  3.684100419881982*^9, 3.6841004213560467`*^9}, {3.684100523328725*^9, 
  3.684100531020879*^9}, {3.684100563084326*^9, 3.684100566716979*^9}, {
  3.685416480599662*^9, 3.685416481870009*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Close", "[", "outfile", "]"}]], "Input"],

Cell[BoxData["\<\"/Users/Matt/project_code/Motor_Freedom/tools/\
forwardequations.c\"\>"], "Output",
 CellChangeTimes->{{3.684100300257049*^9, 3.6841003123613777`*^9}, 
   3.684100438657907*^9, 3.684100553368664*^9, 3.6841005843912697`*^9, 
   3.684100673530526*^9, {3.684100722534998*^9, 3.684100732493864*^9}, 
   3.684102391742468*^9, 3.684102594087244*^9, 3.6841028306272573`*^9, 
   3.684121002174754*^9, 3.684122725655195*^9, 3.684123019930887*^9, 
   3.6841233523696623`*^9, 3.685310548666443*^9, {3.685310618702059*^9, 
   3.6853106288145733`*^9}, 3.68531069968434*^9, {3.685310957682103*^9, 
   3.685310969501884*^9}, 3.685311255730791*^9, 3.685311402237832*^9, 
   3.6853115071808147`*^9, 3.685312010253036*^9, 3.685312841126239*^9, {
   3.685312985680805*^9, 3.6853130014500933`*^9}, 3.685314857065839*^9, 
   3.685316608044868*^9, 3.6853218660793743`*^9, 3.685389151945215*^9, 
   3.685407229598117*^9, 3.685407515813778*^9, 3.685416503740095*^9, {
   3.6854656908324947`*^9, 3.685465700600263*^9}, 3.685466038857834*^9, 
   3.685468637688806*^9, {3.685468811556815*^9, 3.6854688194929333`*^9}, 
   3.6854712321194677`*^9, 3.685809145536249*^9, 3.68580927994246*^9, 
   3.6858093874017143`*^9, 3.685809471968864*^9, 3.685809749058251*^9, 
   3.685829281384741*^9, 3.6858299845360327`*^9, 3.685830038685813*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stochastic Version", "Chapter",
 CellChangeTimes->{{3.685826779455792*^9, 3.6858267835838337`*^9}}],

Cell[CellGroupData[{

Cell["Equations for stochastic version", "Section",
 CellChangeTimes->{{3.685751990239071*^9, 3.685751996342305*^9}, {
  3.685753440849455*^9, 3.6857534544499607`*^9}, {3.685825822014893*^9, 
  3.685825847698616*^9}}],

Cell["Sum of forces on anchor i", "Text",
 CellChangeTimes->{{3.685828096051152*^9, 3.685828107795451*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumForcesAnchorStocahstic", "[", "i_", "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Fba", "[", "i", "]"}], "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"Fba", "[", "i", "]"}], "[", "1", "]"}], ",", 
       RowBox[{
        RowBox[{"Fba", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"FmTangential", "[", "i", "]"}], "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"FmTangential", "[", "i", "]"}], "[", "1", "]"}], ",", 
       RowBox[{
        RowBox[{"FmTangential", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
     "+", 
     RowBox[{
      RowBox[{"xiAnchor", "[", "i", "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vc", "[", "0", "]"}], ",", 
          RowBox[{"vc", "[", "1", "]"}], ",", 
          RowBox[{"vc", "[", "2", "]"}]}], "}"}], "+", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"omega", "[", "0", "]"}], ",", 
            RowBox[{"omega", "[", "1", "]"}], ",", 
            RowBox[{"omega", "[", "2", "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "[", "0", "]"}], ",", 
             RowBox[{"c", "[", "1", "]"}], ",", 
             RowBox[{"c", "[", "2", "]"}]}], "}"}]}]}], "]"}], "-", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"va", "[", "i", "]"}], "[", "0", "]"}], ",", 
          RowBox[{
           RowBox[{"va", "[", "i", "]"}], "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"va", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}], 
       ")"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.685820474680799*^9, 3.685820518861616*^9}, 
   3.685820611042869*^9}],

Cell["Sum of forces on cargo", "Text",
 CellChangeTimes->{{3.685828111406816*^9, 3.68582811720042*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumForcesCargoStochastic", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Thread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fbc", "[", "0", "]"}], ",", 
       RowBox[{"Fbc", "[", "1", "]"}], ",", 
       RowBox[{"Fbc", "[", "2", "]"}]}], "}"}], "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ftrap", "[", "0", "]"}], ",", 
       RowBox[{"Ftrap", "[", "1", "]"}], ",", 
       RowBox[{"Ftrap", "[", "2", "]"}]}], "}"}], "+", "\[IndentingNewLine]", 
     
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fsteric", "[", "0", "]"}], ",", 
       RowBox[{"Fsteric", "[", "1", "]"}], ",", 
       RowBox[{"Fsteric", "[", "2", "]"}]}], "}"}], "-", 
     "\[IndentingNewLine]", 
     RowBox[{"xiCargoTranslation", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vc", "[", "0", "]"}], ",", 
        RowBox[{"vc", "[", "1", "]"}], ",", 
        RowBox[{"vc", "[", "2", "]"}]}], "}"}]}], "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "0", "]"}], ",", 
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
        RowBox[{
         RowBox[{"xiAnchor", "[", "i", "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"vc", "[", "0", "]"}], ",", 
             RowBox[{"vc", "[", "1", "]"}], ",", 
             RowBox[{"vc", "[", "2", "]"}]}], "}"}], "+", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"omega", "[", "0", "]"}], ",", 
               RowBox[{"omega", "[", "1", "]"}], ",", 
               RowBox[{"omega", "[", "2", "]"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
              
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c", "[", "0", "]"}], ",", 
                RowBox[{"c", "[", "1", "]"}], ",", 
                RowBox[{"c", "[", "2", "]"}]}], "}"}]}]}], "]"}], "-", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"va", "[", "i", "]"}], "[", "0", "]"}], ",", 
             RowBox[{
              RowBox[{"va", "[", "i", "]"}], "[", "1", "]"}], ",", 
             RowBox[{
              RowBox[{"va", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}], 
          ")"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.68582064176493*^9, 3.685820733273151*^9}}],

Cell["Sum of torques on cargo", "Text",
 CellChangeTimes->{{3.685828120856576*^9, 3.6858281304641237`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumTorquesCargoStochastic", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Tbc", "[", "0", "]"}], ",", 
       RowBox[{"Tbc", "[", "1", "]"}], ",", 
       RowBox[{"Tbc", "[", "2", "]"}]}], "}"}], "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TorqeExt", "[", "0", "]"}], ",", 
       RowBox[{"TorqeExt", "[", "1", "]"}], ",", 
       RowBox[{"TorqeExt", "[", "2", "]"}]}], "}"}], "-", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"omega", "[", "0", "]"}], ",", 
        RowBox[{"omega", "[", "1", "]"}], ",", 
        RowBox[{"omega", "[", "2", "]"}]}], "}"}], "xiCargoRotation"}], "-", 
     " ", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"xiAnchor", "[", "i", "]"}], 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "[", "0", "]"}], ",", 
             RowBox[{"c", "[", "1", "]"}], ",", 
             RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ",", " ", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"vc", "[", "0", "]"}], ",", 
             RowBox[{"vc", "[", "1", "]"}], ",", 
             RowBox[{"vc", "[", "2", "]"}]}], "}"}], "+", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"omega", "[", "0", "]"}], ",", 
               RowBox[{"omega", "[", "1", "]"}], ",", 
               RowBox[{"omega", "[", "2", "]"}]}], "}"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
                RowBox[{
                 RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
              
              RowBox[{"{", 
               RowBox[{
                RowBox[{"c", "[", "0", "]"}], ",", 
                RowBox[{"c", "[", "1", "]"}], ",", 
                RowBox[{"c", "[", "2", "]"}]}], "}"}]}]}], "]"}], "-", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"va", "[", "i", "]"}], "[", "0", "]"}], ",", 
             RowBox[{
              RowBox[{"va", "[", "i", "]"}], "[", "1", "]"}], ",", 
             RowBox[{
              RowBox[{"va", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}]}], 
         "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685820821629675*^9, 3.6858208555489264`*^9}}],

Cell["Velocity variables to solve for", "Text",
 CellChangeTimes->{{3.685828139160968*^9, 3.685828146022786*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"velvars", "[", "nmotors_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"va", "[", "i", "]"}], "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"va", "[", "i", "]"}], "[", "1", "]"}], ",", 
         RowBox[{
          RowBox[{"va", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vc", "[", "0", "]"}], ",", 
       RowBox[{"vc", "[", "1", "]"}], ",", 
       RowBox[{"vc", "[", "2", "]"}], ",", 
       RowBox[{"omega", "[", "0", "]"}], ",", 
       RowBox[{"omega", "[", "1", "]"}], ",", 
       RowBox[{"omega", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{3.685824185302882*^9}],

Cell["Discretized variables to solve for", "Text",
 CellChangeTimes->{{3.68582814934149*^9, 3.685828156563992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"discvars", "[", "nmotors_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"a1", "[", "i", "]"}], "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"a1", "[", "i", "]"}], "[", "1", "]"}], ",", 
         RowBox[{
          RowBox[{"a1", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c1", "[", "0", "]"}], ",", 
       RowBox[{"c1", "[", "1", "]"}], ",", 
       RowBox[{"c1", "[", "2", "]"}], ",", 
       RowBox[{"theta1", "[", "0", "]"}], ",", 
       RowBox[{"theta1", "[", "1", "]"}], ",", 
       RowBox[{"theta1", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.685824128996464*^9, 3.68582413403589*^9}, 
   3.685824187709579*^9}],

Cell["List of rules to turn the equation into a discretized one", "Text",
 CellChangeTimes->{{3.685828160557166*^9, 3.685828183293991*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"discRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"va", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a1", "[", "x", "]"}], "[", "y", "]"}], "-", 
        RowBox[{
         RowBox[{"a", "[", "x", "]"}], "[", "y", "]"}]}], ")"}], "/", 
      "dt"}]}], ",", 
    RowBox[{
     RowBox[{"vc", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c1", "[", "x", "]"}], "-", 
        RowBox[{"c", "[", "x", "]"}]}], ")"}], "/", "dt"}]}], ",", 
    RowBox[{
     RowBox[{"omega", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"theta1", "[", "x", "]"}], "-", 
        RowBox[{"theta", "[", "x", "]"}]}], ")"}], "/", "dt"}]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.685821609262302*^9, 3.6858216448691874`*^9}, {
   3.685821676254924*^9, 3.685821702894902*^9}, {3.685821739684156*^9, 
   3.6858217971584253`*^9}, {3.6858218349702177`*^9, 3.685821861276149*^9}, {
   3.6858219917492113`*^9, 3.685822096294816*^9}, 3.6858227136827927`*^9, {
   3.685823248517694*^9, 3.685823419741835*^9}, {3.685823456225264*^9, 
   3.68582349864916*^9}, 3.685824203808404*^9, {3.68582961378611*^9, 
   3.685829674556435*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"va", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"a1", "[", "x", "]"}], "[", "y", "]"}], "-", 
      RowBox[{
       RowBox[{"a", "[", "x", "]"}], "[", "y", "]"}]}], "dt"]}], ",", 
   RowBox[{
    RowBox[{"vc", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      RowBox[{"c1", "[", "x", "]"}], "-", 
      RowBox[{"c", "[", "x", "]"}]}], "dt"]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      RowBox[{"theta1", "[", "x", "]"}], "-", 
      RowBox[{"theta", "[", "x", "]"}]}], "dt"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6858296758729486`*^9, 3.685829984621456*^9, 
  3.685830038797429*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"brownianRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Fba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"Dba", "[", "x", "]"}], "[", "y", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Fbc", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{"Dbc", "[", "x", "]"}]}], ",", 
    RowBox[{
     RowBox[{"Tbc", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{"Rbc", "[", "x", "]"}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6858296550201693`*^9, 3.6858296618438883`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Fba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
    RowBox[{
     RowBox[{"Dba", "[", "x", "]"}], "[", "y", "]"}]}], ",", 
   RowBox[{
    RowBox[{"Fbc", "[", "x_", "]"}], "\[RuleDelayed]", 
    RowBox[{"Dbc", "[", "x", "]"}]}], ",", 
   RowBox[{
    RowBox[{"Tbc", "[", "x_", "]"}], "\[RuleDelayed]", 
    RowBox[{"Rbc", "[", "x", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.685829679242303*^9, 3.6858299846861057`*^9, 
  3.685830038849503*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step through stochastic solution", "Section",
 CellChangeTimes->{{3.685825799796288*^9, 3.685825806152383*^9}}],

Cell[TextData[{
 "Now that we have a brownian term, we should be a little more careful about \
discretizing the equations. Instead of replacing the derivatives in place, we \
should solve for the velocities first, so we can think about \
\[OpenCurlyDoubleQuote]integrating\[CloseCurlyDoubleQuote] the brownian force \
term. The we deal with the stochastic terms (turn ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SqrtBox[
     RowBox[{"2", "D"}]], 
    RowBox[{"W", "(", "t", ")"}]}], TraditionalForm]]],
 " - W(t) being the Weiner process - into ",
 Cell[BoxData[
  FormBox[
   SqrtBox[
    RowBox[{"2", "D", " ", "dt"}]], TraditionalForm]]],
 ") and discretize, then do the solve for a1."
}], "Text",
 CellChangeTimes->{{3.685754095226262*^9, 3.685754323532625*^9}, {
  3.68582016911197*^9, 3.6858201963235064`*^9}, {3.685827552835374*^9, 
  3.685827579429392*^9}, {3.685827922936791*^9, 3.6858280646519213`*^9}}],

Cell["\<\
First, write out equations in terms of velocities. Then generate a list of \
equations for a given number of motors\
\>", "Text",
 CellChangeTimes->{3.685827582838533*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmotors", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ",", 
    RowBox[{"i", "<", "nmotors"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumForcesAnchorStocahstic", "[", "i", "]"}], ",", "eqs"}], 
       "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"sumForcesCargoStochastic", "[", "nmotors", "]"}], ",", "eqs"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eqs", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"sumTorquesCargoStochastic", "[", "nmotors", "]"}], ",", "eqs"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.68582356568734*^9, 3.68582364267073*^9}, {
  3.6858239661976852`*^9, 3.685823973363969*^9}, {3.68582405564684*^9, 
  3.685824056670148*^9}, {3.6858242189846077`*^9, 3.685824219029139*^9}, {
  3.6858270225337887`*^9, 3.685827022601071*^9}, {3.685827517588771*^9, 
  3.6858275176445723`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "0", "]"}]}], "+", 
     RowBox[{"Tbc", "[", "0", "]"}], "+", 
     RowBox[{"TorqeExt", "[", "0", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "1", "]"}]}], "+", 
     RowBox[{"Tbc", "[", "1", "]"}], "+", 
     RowBox[{"TorqeExt", "[", "1", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "2", "]"}]}], "+", 
     RowBox[{"Tbc", "[", "2", "]"}], "+", 
     RowBox[{"TorqeExt", "[", "2", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"Fbc", "[", "0", "]"}], "+", 
     RowBox[{"Fsteric", "[", "0", "]"}], "+", 
     RowBox[{"Ftrap", "[", "0", "]"}], "-", 
     RowBox[{"xiCargoTranslation", " ", 
      RowBox[{"vc", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"Fbc", "[", "1", "]"}], "+", 
     RowBox[{"Fsteric", "[", "1", "]"}], "+", 
     RowBox[{"Ftrap", "[", "1", "]"}], "-", 
     RowBox[{"xiCargoTranslation", " ", 
      RowBox[{"vc", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"Fbc", "[", "2", "]"}], "+", 
     RowBox[{"Fsteric", "[", "2", "]"}], "+", 
     RowBox[{"Ftrap", "[", "2", "]"}], "-", 
     RowBox[{"xiCargoTranslation", " ", 
      RowBox[{"vc", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.685824041658144*^9, 3.6858240584843082`*^9}, 
   3.6858242211653137`*^9, 3.685824257080385*^9, 3.685826559962892*^9, 
   3.685826807930655*^9, {3.6858269533105917`*^9, 3.685826980027155*^9}, 
   3.685827025336381*^9, 3.685827522052499*^9, 3.6858298978440523`*^9, 
   3.685829984735773*^9, 3.6858300389002542`*^9}]
}, Open  ]],

Cell["Solve the equations for the velocities", "Text",
 CellChangeTimes->{{3.685822438518442*^9, 3.685822445786024*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"const", ",", "coeff"}], "}"}], "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{"eqs", ",", 
      RowBox[{"velvars", "[", "nmotors", "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffinv", "=", 
   RowBox[{"Inverse", "[", "coeff", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"veleqs", "=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"velvars", "[", "nmotors", "]"}], "\[Equal]", 
    RowBox[{"coeffinv", ".", 
     RowBox[{"-", "const"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.685821646207342*^9, 3.685821660212678*^9}, {
   3.6858238251124477`*^9, 3.685823835495564*^9}, 3.685824091490088*^9, {
   3.6858242920307503`*^9, 3.685824325206559*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"vc", "[", "0", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Fbc", "[", "0", "]"}], "+", 
      RowBox[{"Fsteric", "[", "0", "]"}], "+", 
      RowBox[{"Ftrap", "[", "0", "]"}]}], "xiCargoTranslation"]}], ",", 
   RowBox[{
    RowBox[{"vc", "[", "1", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Fbc", "[", "1", "]"}], "+", 
      RowBox[{"Fsteric", "[", "1", "]"}], "+", 
      RowBox[{"Ftrap", "[", "1", "]"}]}], "xiCargoTranslation"]}], ",", 
   RowBox[{
    RowBox[{"vc", "[", "2", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Fbc", "[", "2", "]"}], "+", 
      RowBox[{"Fsteric", "[", "2", "]"}], "+", 
      RowBox[{"Ftrap", "[", "2", "]"}]}], "xiCargoTranslation"]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "0", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Tbc", "[", "0", "]"}], "+", 
      RowBox[{"TorqeExt", "[", "0", "]"}]}], "xiCargoRotation"]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "1", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Tbc", "[", "1", "]"}], "+", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}], "xiCargoRotation"]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "2", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Tbc", "[", "2", "]"}], "+", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}], "xiCargoRotation"]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.685824316831094*^9, 3.68582432760667*^9}, 
   3.685826560052609*^9, 3.685826808026104*^9, {3.685826953363693*^9, 
   3.6858269800630608`*^9}, 3.685827025484111*^9, 3.685827522164817*^9, 
   3.6858298979308977`*^9, 3.6858299847867126`*^9, 3.685830038951179*^9}]
}, Open  ]],

Cell[TextData[{
 "Discretize the equations and simplify by changing drag coefficient into \
mobility. At this point there is some kind of integration and brownian forces \
become brownian dispalcements, eg ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Fb", "=", 
    RowBox[{
     SqrtBox[
      RowBox[{"2", "D"}]], 
     RowBox[{"W", "(", "t", ")"}]}]}], TraditionalForm]]],
 " becomes ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Db", "=", 
    RowBox[{
     SqrtBox[
      RowBox[{"2", "D", " ", "dt"}]], 
     RowBox[{"N", "(", 
      RowBox[{"0", ",", "1"}], ")"}]}]}], TraditionalForm]]]
}], "Text",
 CellChangeTimes->{{3.685822450162264*^9, 3.685822463752226*^9}, {
  3.6858225697382936`*^9, 3.685822583406938*^9}, {3.685823008858972*^9, 
  3.685823120697291*^9}, {3.685823159428072*^9, 3.6858232203721848`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"discEqs", "=", 
  RowBox[{"veleqs", "/.", 
   RowBox[{"Join", "[", 
    RowBox[{"discRules", ",", "brownianRules", ",", "xi2muRules"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6858243581122847`*^9, 3.685824399096319*^9}, {
  3.685829880611598*^9, 3.6858298915694513`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"c", "[", "0", "]"}]}], "+", 
      RowBox[{"c1", "[", "0", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoTranslation", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Dbc", "[", "0", "]"}], "+", 
       RowBox[{"Fsteric", "[", "0", "]"}], "+", 
       RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"c", "[", "1", "]"}]}], "+", 
      RowBox[{"c1", "[", "1", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoTranslation", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Dbc", "[", "1", "]"}], "+", 
       RowBox[{"Fsteric", "[", "1", "]"}], "+", 
       RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"c", "[", "2", "]"}]}], "+", 
      RowBox[{"c1", "[", "2", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoTranslation", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Dbc", "[", "2", "]"}], "+", 
       RowBox[{"Fsteric", "[", "2", "]"}], "+", 
       RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"theta", "[", "0", "]"}]}], "+", 
      RowBox[{"theta1", "[", "0", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Rbc", "[", "0", "]"}], "+", 
       RowBox[{"TorqeExt", "[", "0", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"theta", "[", "1", "]"}]}], "+", 
      RowBox[{"theta1", "[", "1", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Rbc", "[", "1", "]"}], "+", 
       RowBox[{"TorqeExt", "[", "1", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"theta", "[", "2", "]"}]}], "+", 
      RowBox[{"theta1", "[", "2", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Rbc", "[", "2", "]"}], "+", 
       RowBox[{"TorqeExt", "[", "2", "]"}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.68582437013113*^9, 3.6858243999829073`*^9}, 
   3.685826560102429*^9, 3.6858268080799427`*^9, {3.685826953415012*^9, 
   3.685826980121085*^9}, 3.685827025596992*^9, 3.685827522198017*^9, {
   3.685829893333518*^9, 3.6858298979820232`*^9}, 3.685829984836589*^9, 
   3.68583003900056*^9}]
}, Open  ]],

Cell["\<\
Solve the resulting discretized equations for the values at the next step\
\>", "Text",
 CellChangeTimes->{{3.6858225984368763`*^9, 3.68582262158928*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"soln", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"discEqs", ",", 
      RowBox[{"discvars", "[", "nmotors", "]"}]}], "]"}], "//", "First"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.685821894162339*^9, 3.685821966391511*^9}, {
   3.685822116061079*^9, 3.6858221371700974`*^9}, 3.685822717911746*^9, 
   3.685824119131777*^9, 3.6858243503398123`*^9, {3.685824387059539*^9, 
   3.6858244088957453`*^9}, {3.6858265478416033`*^9, 3.685826633610422*^9}, {
   3.685826834558629*^9, 3.68582683678015*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Dbc", "[", "0", "]"}], "+", 
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Dbc", "[", "1", "]"}], "+", 
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Dbc", "[", "2", "]"}], "+", 
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"theta", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rbc", "[", "0", "]"}], "+", 
        RowBox[{"TorqeExt", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rbc", "[", "1", "]"}], "+", 
        RowBox[{"TorqeExt", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rbc", "[", "2", "]"}], "+", 
        RowBox[{"TorqeExt", "[", "2", "]"}]}], ")"}]}]}]}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.6858244092379427`*^9, {3.685826552336358*^9, 3.685826601691846*^9}, 
   3.685826634755744*^9, {3.6858268081568327`*^9, 3.685826837804154*^9}, {
   3.6858269534628353`*^9, 3.68582698018293*^9}, 3.685827025857699*^9, 
   3.685827522254377*^9, 3.685829898058585*^9, 3.685829984886984*^9, 
   3.6858300390488043`*^9}]
}, Open  ]],

Cell["Finally, put these into a printable form", "Text",
 CellChangeTimes->{{3.6858276344873877`*^9, 3.685827644735396*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Thread", "[", 
  RowBox[{
   RowBox[{"discvars", "[", "nmotors", "]"}], "==", 
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"discvars", "[", "nmotors", "]"}], "/.", "soln"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6858266174622383`*^9, 3.685826714262645*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Dbc", "[", "0", "]"}], "+", 
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Dbc", "[", "1", "]"}], "+", 
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Dbc", "[", "2", "]"}], "+", 
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rbc", "[", "0", "]"}], "+", 
        RowBox[{"TorqeExt", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rbc", "[", "1", "]"}], "+", 
        RowBox[{"TorqeExt", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rbc", "[", "2", "]"}], "+", 
        RowBox[{"TorqeExt", "[", "2", "]"}]}], ")"}]}]}]}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.685826637848789*^9, {3.6858266812360573`*^9, 3.685826735374387*^9}, 
   3.685826808211841*^9, 3.685826840313208*^9, {3.685826953512967*^9, 
   3.685826980232581*^9}, 3.685827025915041*^9, 3.685827522301631*^9, 
   3.685829898100388*^9, 3.685829984937006*^9, 3.685830039100217*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stochastic equations generating function", "Section",
 CellChangeTimes->{{3.685821445743783*^9, 3.685821459614382*^9}, {
  3.685822690484136*^9, 3.685822704287971*^9}, {3.6858255455388107`*^9, 
  3.6858255578542213`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eqs", ",", "i", ",", "veleqs", ",", "disceqs", ",", "coeff", ",", 
      "coeffinv", ",", "const", ",", "soln"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "<", "nmotors"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqs", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"sumForcesAnchorStocahstic", "[", "i", "]"}], ",", "eqs"}],
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumForcesCargoStochastic", "[", "nmotors", "]"}], ",", 
        "eqs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumTorquesCargoStochastic", "[", "nmotors", "]"}], ",", 
        "eqs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"const", ",", "coeff"}], "}"}], "=", 
      RowBox[{"Normal", "@", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"eqs", ",", 
         RowBox[{"velvars", "[", "nmotors", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coeffinv", "=", 
      RowBox[{"Inverse", "[", "coeff", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"veleqs", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"velvars", "[", "nmotors", "]"}], "\[Equal]", 
        RowBox[{"coeffinv", ".", 
         RowBox[{"-", "const"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"disceqs", "=", 
      RowBox[{"veleqs", "/.", 
       RowBox[{"Join", "[", 
        RowBox[{"discRules", ",", "brownianRules", ",", "xi2muRules"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"soln", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{"disceqs", ",", 
          RowBox[{"discvars", "[", "nmotors", "]"}]}], "]"}], "//", "First"}],
        "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"discvars", "[", "nmotors", "]"}], "==", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"discvars", "[", "nmotors", "]"}], "/.", "soln"}], "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.685752021873514*^9, 3.68575204526968*^9}, {
   3.68575208770603*^9, 3.6857521842190332`*^9}, {3.685752228757876*^9, 
   3.6857522323234243`*^9}, {3.685752264543935*^9, 3.685752284658534*^9}, {
   3.685752351179758*^9, 3.685752354430645*^9}, {3.685753459086227*^9, 
   3.685753531086829*^9}, {3.685820203075674*^9, 3.685820300949844*^9}, {
   3.685820336995573*^9, 3.685820351371944*^9}, 3.685820517706642*^9, {
   3.685820628818067*^9, 3.685820635541727*^9}, 3.685820677745757*^9, {
   3.685820782413342*^9, 3.6858208161300383`*^9}, {3.6858208774524727`*^9, 
   3.685820881217555*^9}, {3.685820923690524*^9, 3.6858209301028633`*^9}, {
   3.685821247565405*^9, 3.685821259354423*^9}, {3.685822755308692*^9, 
   3.685822811748394*^9}, {3.685824425209546*^9, 3.685824484230485*^9}, {
   3.6858268700985003`*^9, 3.6858268958146467`*^9}, {3.685827246218122*^9, 
   3.685827246250827*^9}, {3.685829704459293*^9, 3.685829752018261*^9}, {
   3.685829836815978*^9, 3.685829838378912*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing for stochastic equations", "Section",
 CellChangeTimes->{{3.685826489183947*^9, 3.685826497620698*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"generateEqsStochastic", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.6858264991887407`*^9, 3.68582650292021*^9}, {
  3.6858270080549707`*^9, 3.685827008122107*^9}, {3.685827507352364*^9, 
  3.6858275074043007`*^9}, {3.685829764095656*^9, 3.6858297869884768`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Dbc", "[", "0", "]"}], "+", 
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Dbc", "[", "1", "]"}], "+", 
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Dbc", "[", "2", "]"}], "+", 
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rbc", "[", "0", "]"}], "+", 
        RowBox[{"TorqeExt", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rbc", "[", "1", "]"}], "+", 
        RowBox[{"TorqeExt", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Rbc", "[", "2", "]"}], "+", 
        RowBox[{"TorqeExt", "[", "2", "]"}]}], ")"}]}]}]}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.685826504658276*^9, 3.685826905485097*^9, {3.685826953563291*^9, 
   3.685827008678941*^9}, 3.6858272626108837`*^9, 3.685827507831451*^9, {
   3.685829761434699*^9, 3.6858297873429537`*^9}, 3.685829984986368*^9, 
   3.6858300391522417`*^9}]
}, Open  ]],

Cell["\<\
If all forces are 0 we should just get brownian movement... which we don\
\[CloseCurlyQuote]t here. Should get terms of Dbc only, we get them \
multiplied by dt muCargoTranslation - I feel like this is due to missing some \
stuff from the \[OpenCurlyDoubleQuote]integration\[CloseCurlyDoubleQuote] step\
\>", "Text",
 CellChangeTimes->{{3.685830116860518*^9, 3.6858301317436447`*^9}, {
  3.685830278680277*^9, 3.685830383169176*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"invsoln", "=", 
   RowBox[{"generateEqsStochastic", "[", "0", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"invsoln", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}], "\[Rule]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "0", "]"}], "[", "1", "]"}], "\[Rule]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "0", "]"}], "[", "2", "]"}], "\[Rule]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "0", "]"}], "[", "0", "]"}], "\[Rule]", "0"}],
      ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "0", "]"}], "[", "1", "]"}], "\[Rule]", "0"}],
      ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "0", "]"}], "[", "2", "]"}], "\[Rule]", "0"}],
      ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.685830106375854*^9, 3.685830111280898*^9}, {
  3.685830311743888*^9, 3.685830323825683*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}]}], "\[Equal]", 
    RowBox[{"c1", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}]}], "\[Equal]", 
    RowBox[{"c1", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}]}], "\[Equal]", 
    RowBox[{"c1", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"Rbc", "[", "0", "]"}]}], "+", 
     RowBox[{"theta", "[", "0", "]"}]}], "\[Equal]", 
    RowBox[{"theta1", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
     RowBox[{"theta", "[", "1", "]"}]}], "\[Equal]", 
    RowBox[{"theta1", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"Rbc", "[", "2", "]"}]}], "+", 
     RowBox[{"theta", "[", "2", "]"}]}], "\[Equal]", 
    RowBox[{"theta1", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6858301134959297`*^9, {3.685830314294078*^9, 3.685830324233374*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate stochastic equations file", "Section",
 CellChangeTimes->{{3.685825562247184*^9, 3.68582557832909*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"outfileLoc", "=", 
   RowBox[{"CreateFile", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<stochasticequations.c\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outfile", "=", 
   RowBox[{"File", "[", "outfileLoc", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.684098648719748*^9, 3.684098677654524*^9}, 
   3.6840991788294983`*^9, 3.68409921040814*^9, {3.684102465568993*^9, 
   3.684102482037467*^9}, {3.684102558481722*^9, 3.684102578910823*^9}, {
   3.684122712337173*^9, 3.684122713519846*^9}, {3.685825583032132*^9, 
   3.685825584651936*^9}}],

Cell["Write C function beginning lines", "Text",
 CellChangeTimes->{{3.6840992130621567`*^9, 3.684099228238578*^9}, {
  3.685825660308721*^9, 3.685825661635256*^9}}],

Cell[BoxData[{
 RowBox[{"WriteString", "[", 
  RowBox[{
  "outfile", ",", "\"\<//prototypes\>\"", ",", "\"\<\\n\>\"", ",", 
   "\"\<void compute_next_locations_stochastic();\>\"", ",", 
   "\"\<\\n\\n\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteString", "[", 
  RowBox[{
  "outfile", ",", "\"\<void compute_next_locations_stochastic(){\>\"", ",", 
   "\"\<\\n\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteString", "[", 
  RowBox[{
  "outfile", ",", "\"\<    \>\"", ",", "\"\<switch(total_motors){\>\"", ",", 
   "\"\<\\n\>\""}], "]"}]}], "Input",
 CellChangeTimes->{{3.684099231380281*^9, 3.684099240084999*^9}, {
  3.6840992762656183`*^9, 3.684099515878077*^9}, {3.6840996083649063`*^9, 
  3.684099671532875*^9}, {3.6840997024259577`*^9, 3.684099710873991*^9}, {
  3.68410043232519*^9, 3.684100434844616*^9}, {3.684100489632914*^9, 
  3.684100491769526*^9}, {3.684102822946341*^9, 3.684102824329294*^9}, {
  3.685388941745635*^9, 3.685388952817151*^9}, {3.685407473277313*^9, 
  3.685407474546224*^9}, {3.685825623847027*^9, 3.685825633602104*^9}}],

Cell[BoxData[
 RowBox[{"For", "[", 
  RowBox[{
   RowBox[{"j", "=", "0"}], ",", 
   RowBox[{"j", "\[LessEqual]", "3"}], ",", 
   RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"WriteString", "[", 
     RowBox[{
     "outfile", ",", "\"\<        \>\"", ",", "\"\<case \>\"", ",", "j", ",", 
      "\"\<:\>\"", ",", "\"\<\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
    RowBox[{"invsoln", "=", 
     RowBox[{"generateEqsStochastic", "[", "j", "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"i", "=", "1"}], ",", 
      RowBox[{"i", "\[LessEqual]", " ", 
       RowBox[{"3", 
        RowBox[{"(", 
         RowBox[{"j", "+", "2"}], ")"}]}]}], ",", 
      RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"if", " ", 
         RowBox[{"it", "'"}], "s", " ", "a", " ", "line", " ", "with", " ", 
         "theta"}], ",", " ", 
        RowBox[{
        "comment", " ", "it", " ", "out", " ", "since", " ", "we", " ", 
         "never", " ", "use", " ", "the", " ", "value", " ", "of", " ", 
         "theta"}]}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"i", "\[Equal]", " ", 
           RowBox[{"3", 
            RowBox[{"(", 
             RowBox[{"j", "+", "2"}], ")"}]}]}], "||", 
          RowBox[{"i", "\[Equal]", " ", 
           RowBox[{
            RowBox[{"3", 
             RowBox[{"(", 
              RowBox[{"j", "+", "2"}], ")"}]}], "-", "1"}]}], "||", 
          RowBox[{"i", "\[Equal]", " ", 
           RowBox[{
            RowBox[{"3", 
             RowBox[{"(", 
              RowBox[{"j", "+", "2"}], ")"}]}], "-", "2"}]}]}], ",", 
         RowBox[{"WriteString", "[", 
          RowBox[{"outfile", ",", "\"\<//\>\""}], "]"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{"outfile", ",", "\"\<            \>\"", ",", 
         RowBox[{"CForm", "[", 
          RowBox[{"invsoln", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
         "\"\<\\n\\n\>\""}], "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"WriteString", "[", 
     RowBox[{
     "outfile", ",", "\"\<            \>\"", ",", "\"\<break;\>\"", ",", 
      "\"\<\\n\\n\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
  "]"}]], "Input",
 CellChangeTimes->{{3.684098684247036*^9, 3.684098766686006*^9}, {
   3.684098856697693*^9, 3.684098878004724*^9}, {3.684099061289969*^9, 
   3.6840991277763557`*^9}, 3.6840991935196753`*^9, {3.684099519804295*^9, 
   3.684099541348055*^9}, {3.6840997343083973`*^9, 3.684099816432733*^9}, {
   3.684100169619607*^9, 3.6841001736468277`*^9}, {3.684100402884281*^9, 
   3.684100411512261*^9}, {3.6841005086000032`*^9, 3.684100540493479*^9}, {
   3.68410061534379*^9, 3.684100657686246*^9}, {3.684100711764319*^9, 
   3.684100715138089*^9}, {3.685310680916917*^9, 3.685310683885453*^9}, {
   3.6853114763699017`*^9, 3.685311479619326*^9}, {3.685407221763399*^9, 
   3.685407221799777*^9}, {3.685465676220456*^9, 3.685465676259206*^9}, {
   3.6854659373040123`*^9, 3.685465953817956*^9}, {3.6854685904634333`*^9, 
   3.68546859084135*^9}, {3.685468806323731*^9, 3.6854688063796387`*^9}, {
   3.685471190990142*^9, 3.685471191024145*^9}, {3.6858090438046227`*^9, 
   3.685809117375259*^9}, {3.685809192345202*^9, 3.685809227111394*^9}, {
   3.685809340496956*^9, 3.685809353218791*^9}, {3.685809387948227*^9, 
   3.685809391389855*^9}, {3.685809431936461*^9, 3.685809437741338*^9}, {
   3.685809615973763*^9, 3.6858096344905577`*^9}, {3.68580970844851*^9, 
   3.685809710641583*^9}, {3.6858098008331947`*^9, 3.6858098265387697`*^9}, {
   3.685825718954495*^9, 3.6858257450769653`*^9}, {3.685826976061697*^9, 
   3.685826976116604*^9}}],

Cell[BoxData[{
 RowBox[{"WriteString", "[", 
  RowBox[{
  "outfile", ",", "\"\<        \>\"", ",", "\"\<default:\>\"", ",", 
   "\"\<\\n\>\"", ",", "\"\<            \>\"", ",", 
   "\"\<printf(\\\"Bad value for total_motors\\\\n\\\");\>\"", ",", 
   "\"\<\\n\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{"WriteString", "[", 
  RowBox[{"outfile", ",", "\"\<    }\\n\>\"", ",", "\"\<}\\n\>\""}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.684099840640665*^9, 3.684099931812181*^9}, {
  3.6840999744158993`*^9, 3.68409998222359*^9}, {3.684100043368163*^9, 
  3.684100084620983*^9}, {3.6841001168977137`*^9, 3.684100160693183*^9}, {
  3.684100202273947*^9, 3.6841002029258747`*^9}, {3.684100279347612*^9, 
  3.684100298168747*^9}, {3.684100370877803*^9, 3.6841003714731607`*^9}, {
  3.684100419881982*^9, 3.6841004213560467`*^9}, {3.684100523328725*^9, 
  3.684100531020879*^9}, {3.684100563084326*^9, 3.684100566716979*^9}, {
  3.685416480599662*^9, 3.685416481870009*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Close", "[", "outfile", "]"}]], "Input"],

Cell[BoxData["\<\"/Users/Matt/project_code/Motor_Freedom/tools/\
stochasticequations.c\"\>"], "Output",
 CellChangeTimes->{{3.684100300257049*^9, 3.6841003123613777`*^9}, 
   3.684100438657907*^9, 3.684100553368664*^9, 3.6841005843912697`*^9, 
   3.684100673530526*^9, {3.684100722534998*^9, 3.684100732493864*^9}, 
   3.684102391742468*^9, 3.684102594087244*^9, 3.6841028306272573`*^9, 
   3.684121002174754*^9, 3.684122725655195*^9, 3.684123019930887*^9, 
   3.6841233523696623`*^9, 3.685310548666443*^9, {3.685310618702059*^9, 
   3.6853106288145733`*^9}, 3.68531069968434*^9, {3.685310957682103*^9, 
   3.685310969501884*^9}, 3.685311255730791*^9, 3.685311402237832*^9, 
   3.6853115071808147`*^9, 3.685312010253036*^9, 3.685312841126239*^9, {
   3.685312985680805*^9, 3.6853130014500933`*^9}, 3.685314857065839*^9, 
   3.685316608044868*^9, 3.6853218660793743`*^9, 3.685389151945215*^9, 
   3.685407229598117*^9, 3.685407515813778*^9, 3.685416503740095*^9, {
   3.6854656908324947`*^9, 3.685465700600263*^9}, 3.685466038857834*^9, 
   3.685468637688806*^9, {3.685468811556815*^9, 3.6854688194929333`*^9}, 
   3.6854712321194677`*^9, 3.685809145536249*^9, 3.68580927994246*^9, 
   3.6858093874017143`*^9, 3.685809471968864*^9, 3.685809749058251*^9, 
   3.685825770949732*^9, 3.6858269969894533`*^9, 3.685827299476267*^9, 
   3.685829988554552*^9, 3.685830042478118*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1087, 1018},
WindowMargins->{{Automatic, 665}, {Automatic, 48}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 110, 1, 92, "Title"],
Cell[693, 25, 979, 17, 182, "Text"],
Cell[CellGroupData[{
Cell[1697, 46, 106, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[1828, 51, 120, 1, 64, "Section"],
Cell[1951, 54, 2752, 75, 117, "Input"],
Cell[4706, 131, 4105, 109, 180, "Input"],
Cell[8814, 242, 3965, 104, 138, "Input"],
Cell[12782, 348, 999, 28, 75, "Input"],
Cell[CellGroupData[{
Cell[13806, 380, 504, 12, 32, "Input"],
Cell[14313, 394, 476, 12, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[14838, 412, 205, 3, 64, "Section"],
Cell[15046, 417, 265, 5, 49, "Text"],
Cell[15314, 424, 732, 14, 54, "Input"],
Cell[16049, 440, 210, 3, 30, "Text"],
Cell[16262, 445, 2177, 37, 96, "Input"],
Cell[18442, 484, 105, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[18572, 489, 1857, 26, 54, "Input"],
Cell[20432, 517, 1363, 40, 116, "Output"]
}, Open  ]],
Cell[21810, 560, 105, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[21940, 565, 1856, 27, 32, "Input"],
Cell[23799, 594, 774, 22, 54, "Output"]
}, Open  ]],
Cell[24588, 619, 123, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[24736, 624, 500, 10, 32, "Input"],
Cell[25239, 636, 2020, 59, 145, "Output"]
}, Open  ]],
Cell[27274, 698, 224, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[27523, 706, 133, 2, 32, "Input"],
Cell[27659, 710, 393, 10, 32, "Output"]
}, Open  ]],
Cell[28067, 723, 182, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[28274, 731, 703, 14, 32, "Input"],
Cell[28980, 747, 2186, 61, 145, "Output"]
}, Open  ]],
Cell[31181, 811, 331, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[31537, 821, 400, 8, 75, "Input"],
Cell[31940, 831, 891, 13, 32, "Output"],
Cell[32834, 846, 934, 15, 32, "Output"],
Cell[33771, 863, 911, 14, 32, "Output"]
}, Open  ]],
Cell[34697, 880, 236, 4, 30, "Text"],
Cell[34936, 886, 388, 8, 32, "Input"],
Cell[35327, 896, 187, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[35539, 904, 315, 6, 32, "Input"],
Cell[35857, 912, 1017, 25, 85, "Output"]
}, Open  ]],
Cell[36889, 940, 256, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[37170, 949, 264, 5, 32, "Input"],
Cell[37437, 956, 1034, 29, 54, "Output"]
}, Open  ]],
Cell[38486, 988, 420, 12, 50, "Text"],
Cell[CellGroupData[{
Cell[38931, 1004, 672, 15, 32, "Input"],
Cell[39606, 1021, 1668, 45, 75, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[41323, 1072, 104, 1, 64, "Section"],
Cell[41430, 1075, 3843, 77, 243, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45310, 1157, 96, 1, 64, "Section"],
Cell[45409, 1160, 164, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[45598, 1166, 1074, 16, 32, "Input"],
Cell[46675, 1184, 2349, 54, 75, "Output"]
}, Open  ]],
Cell[49039, 1241, 141, 1, 30, "Text"],
Cell[49183, 1244, 300, 6, 32, "Input"],
Cell[CellGroupData[{
Cell[49508, 1254, 1784, 50, 75, "Input"],
Cell[51295, 1306, 1628, 41, 54, "Output"]
}, Open  ]],
Cell[52938, 1350, 148, 2, 30, "Text"],
Cell[53089, 1354, 350, 7, 32, "Input"],
Cell[CellGroupData[{
Cell[53464, 1365, 1438, 36, 54, "Input"],
Cell[54905, 1403, 2167, 56, 54, "Output"]
}, Open  ]],
Cell[57087, 1462, 456, 8, 49, "Text"],
Cell[57546, 1472, 228, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[57799, 1481, 1134, 31, 54, "Input"],
Cell[58936, 1514, 1860, 53, 75, "Output"]
}, Open  ]],
Cell[60811, 1570, 267, 5, 30, "Text"],
Cell[61081, 1577, 228, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[61334, 1586, 1139, 31, 54, "Input"],
Cell[62476, 1619, 1465, 41, 54, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[63990, 1666, 191, 2, 64, "Section"],
Cell[64184, 1670, 591, 13, 54, "Input"],
Cell[64778, 1685, 116, 1, 30, "Text"],
Cell[64897, 1688, 999, 20, 75, "Input"],
Cell[65899, 1710, 3766, 80, 222, "Input"],
Cell[69668, 1792, 973, 17, 54, "Input"],
Cell[CellGroupData[{
Cell[70666, 1813, 64, 1, 32, "Input"],
Cell[70733, 1816, 1322, 18, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[72116, 1841, 105, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[72246, 1846, 217, 3, 64, "Section"],
Cell[72466, 1851, 107, 1, 30, "Text"],
Cell[72576, 1854, 2339, 65, 117, "Input"],
Cell[74918, 1921, 103, 1, 30, "Text"],
Cell[75024, 1924, 3211, 86, 180, "Input"],
Cell[78238, 2012, 107, 1, 30, "Text"],
Cell[78348, 2015, 3203, 86, 138, "Input"],
Cell[81554, 2103, 113, 1, 30, "Text"],
Cell[81670, 2106, 978, 28, 75, "Input"],
Cell[82651, 2136, 115, 1, 30, "Text"],
Cell[82769, 2139, 1031, 29, 75, "Input"],
Cell[83803, 2170, 139, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[83967, 2175, 1369, 36, 32, "Input"],
Cell[85339, 2213, 835, 25, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86211, 2243, 568, 15, 32, "Input"],
Cell[86782, 2260, 543, 15, 32, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[87374, 2281, 117, 1, 64, "Section"],
Cell[87494, 2284, 915, 21, 76, "Text"],
Cell[88412, 2307, 181, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[88618, 2315, 1268, 34, 159, "Input"],
Cell[89889, 2351, 1925, 49, 75, "Output"]
}, Open  ]],
Cell[91829, 2403, 120, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[91974, 2408, 800, 21, 75, "Input"],
Cell[92777, 2431, 1740, 46, 86, "Output"]
}, Open  ]],
Cell[94532, 2480, 811, 23, 53, "Text"],
Cell[CellGroupData[{
Cell[95368, 2507, 304, 7, 32, "Input"],
Cell[95675, 2516, 2610, 76, 218, "Output"]
}, Open  ]],
Cell[98300, 2595, 164, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[98489, 2602, 566, 12, 32, "Input"],
Cell[99058, 2616, 2427, 66, 138, "Output"]
}, Open  ]],
Cell[101500, 2685, 124, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[101649, 2690, 305, 8, 32, "Input"],
Cell[101957, 2700, 2400, 65, 138, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[104406, 2771, 227, 3, 64, "Section"],
Cell[104636, 2776, 3665, 83, 306, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108338, 2864, 117, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[108480, 2869, 291, 4, 32, "Input"],
Cell[108774, 2875, 2360, 65, 138, "Output"]
}, Open  ]],
Cell[111149, 2943, 443, 7, 49, "Text"],
Cell[CellGroupData[{
Cell[111617, 2954, 1814, 53, 96, "Input"],
Cell[113434, 3009, 1457, 40, 75, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[114940, 3055, 118, 1, 64, "Section"],
Cell[115061, 3058, 644, 14, 54, "Input"],
Cell[115708, 3074, 165, 2, 30, "Text"],
Cell[115876, 3078, 1068, 20, 75, "Input"],
Cell[116947, 3100, 3883, 83, 222, "Input"],
Cell[120833, 3185, 973, 17, 54, "Input"],
Cell[CellGroupData[{
Cell[121831, 3206, 64, 1, 32, "Input"],
Cell[121898, 3209, 1373, 19, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

