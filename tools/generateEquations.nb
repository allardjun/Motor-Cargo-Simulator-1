(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    260262,       6944]
NotebookOptionsPosition[    251067,       6649]
NotebookOutlinePosition[    251428,       6665]
CellTagsIndexPosition[    251385,       6662]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Equations for Euler-Maruyama", "Title",
 CellChangeTimes->{{3.670201171182211*^9, 3.670201183646469*^9}, {
  3.685990992169792*^9, 3.6859909956345043`*^9}}],

Cell["\<\
This notebook generates a system of equations, solves it, then writes the \
resulting solved equations to a file in c-ish syntax. When the bash script \
CformToC.sh is then run on the written file, the result should be a c file \
which encodes the equations for the next value of the locations of the \
anchors of each motor, as well as the cargo.

The first section goes through the calculation in detail. Following that is a \
function which performs all the steps for a certain number of attached \
motors. Finally, there is code which loops over numbers of attached motors up \
from 1 to however many are desired and writes as close as possible to a c \
function which will return the next location given the previous one.\
\>", "Text",
 CellChangeTimes->{{3.684120504191019*^9, 3.684120894327046*^9}, {
  3.68412289746591*^9, 3.684122903544365*^9}, {3.6841232064572563`*^9, 
  3.684123224352906*^9}, {3.685985561274387*^9, 3.685985561994651*^9}}],

Cell[CellGroupData[{

Cell["Write full equations, solve and test", "Chapter",
 CellChangeTimes->{{3.685987506921569*^9, 3.685987525326046*^9}, {
  3.689633623242589*^9, 3.689633629519298*^9}}],

Cell[CellGroupData[{

Cell["Equations for stochastic version", "Section",
 CellChangeTimes->{{3.685751990239071*^9, 3.685751996342305*^9}, {
  3.685753440849455*^9, 3.6857534544499607`*^9}, {3.685825822014893*^9, 
  3.685825847698616*^9}}],

Cell["\<\
First, list out the force balance equations we\[CloseCurlyQuote]ll use to \
eventually get to our numerical result.

We want to generate the system of equations for the time evolution of the \
locations of the motor anchors and the cargo center. Derivation of equations \
is detailed in the documentation.\
\>", "Text",
 CellChangeTimes->{{3.685985469936562*^9, 3.685985522000815*^9}, {
  3.685985579387431*^9, 3.685985589680482*^9}}],

Cell["Sum of forces on anchor i", "Text",
 CellChangeTimes->{{3.685828096051152*^9, 3.685828107795451*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumForcesAnchorStocahstic", "[", "i_", "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Fba", "[", "i", "]"}], "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"Fba", "[", "i", "]"}], "[", "1", "]"}], ",", 
       RowBox[{
        RowBox[{"Fba", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"brownian", " ", "force", " ", "on", " ", "anchor"}], "*)"}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"FmTangential", "[", "i", "]"}], "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"FmTangential", "[", "i", "]"}], "[", "1", "]"}], ",", 
       RowBox[{
        RowBox[{"FmTangential", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{
      "motor", " ", "force", " ", "that", " ", "pulls", " ", "on", " ", "the",
        " ", "anchor"}], "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"(*", 
      RowBox[{"drag", " ", "forces"}], "*)"}], 
     RowBox[{
      RowBox[{"xiAnchor", "[", "i", "]"}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vc", "[", "0", "]"}], ",", 
          RowBox[{"vc", "[", "1", "]"}], ",", 
          RowBox[{"vc", "[", "2", "]"}]}], "}"}], 
        RowBox[{"(*", 
         RowBox[{
         "movement", " ", "of", " ", "the", " ", "cargo", " ", "drags", " ", 
          "the", " ", "anchor"}], "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"omega", "[", "0", "]"}], ",", 
            RowBox[{"omega", "[", "1", "]"}], ",", 
            RowBox[{"omega", "[", "2", "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "[", "0", "]"}], ",", 
             RowBox[{"c", "[", "1", "]"}], ",", 
             RowBox[{"c", "[", "2", "]"}]}], "}"}]}]}], "]"}], 
        RowBox[{"(*", 
         RowBox[{
         "rotation", " ", "of", " ", "the", " ", "cargo", " ", "drags", " ", 
          "the", " ", "anchor"}], "*)"}], "\[IndentingNewLine]", "-", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"va", "[", "i", "]"}], "[", "0", "]"}], ",", 
          RowBox[{
           RowBox[{"va", "[", "i", "]"}], "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"va", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}], 
       RowBox[{"(*", 
        RowBox[{
        "drag", " ", "on", " ", "the", " ", "anchor", " ", "due", " ", "to", 
         " ", "moving", " ", "in", " ", "the", " ", "membrane"}], "*)"}], 
       ")"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.685820474680799*^9, 3.685820518861616*^9}, 
   3.685820611042869*^9, {3.685908295773295*^9, 3.685908395252804*^9}, {
   3.685908441973132*^9, 3.68590858524286*^9}, {3.685909175797319*^9, 
   3.685909186067964*^9}}],

Cell["Sum of forces on cargo", "Text",
 CellChangeTimes->{{3.685828111406816*^9, 3.68582811720042*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumForcesCargoStochastic", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Thread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fbc", "[", "0", "]"}], ",", 
       RowBox[{"Fbc", "[", "1", "]"}], ",", 
       RowBox[{"Fbc", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"brownian", " ", "force", " ", "on", " ", "the", " ", "cargo"}],
       "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ftrap", "[", "0", "]"}], ",", 
       RowBox[{"Ftrap", "[", "1", "]"}], ",", 
       RowBox[{"Ftrap", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"external", " ", "force", " ", "on", " ", "the", " ", "cargo"}],
       "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fsteric", "[", "0", "]"}], ",", 
       RowBox[{"Fsteric", "[", "1", "]"}], ",", 
       RowBox[{"Fsteric", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"steric", " ", "force", " ", "on", " ", "the", " ", "cargo"}], 
      "*)"}], "\[IndentingNewLine]", "-", 
     RowBox[{"xiCargoTranslation", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vc", "[", "0", "]"}], ",", 
        RowBox[{"vc", "[", "1", "]"}], ",", 
        RowBox[{"vc", "[", "2", "]"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
      "drag", " ", "force", " ", "on", " ", "the", " ", "cargo", " ", "from", 
       " ", "the", " ", "water"}], "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"(*", 
      RowBox[{"anchor", " ", "forces"}], "*)"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "0", "]"}], ",", 
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
        RowBox[{"(*", 
         RowBox[{"motor", " ", "force", " ", "on", " ", "the", " ", "cargo"}],
          "*)"}], "\[IndentingNewLine]", "-", 
        RowBox[{"(*", 
         RowBox[{
         "reaction", " ", "pairs", " ", "to", " ", "anchor", " ", "forces"}], 
         "*)"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Fba", "[", "i", "]"}], "[", "0", "]"}], ",", 
            RowBox[{
             RowBox[{"Fba", "[", "i", "]"}], "[", "1", "]"}], ",", 
            RowBox[{
             RowBox[{"Fba", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
          RowBox[{"(*", 
           RowBox[{"brownian", " ", "force", " ", "on", " ", "anchor"}], 
           "*)"}], "\[IndentingNewLine]", "+", 
          RowBox[{
           RowBox[{"xiAnchor", "[", "i", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"vc", "[", "0", "]"}], ",", 
               RowBox[{"vc", "[", "1", "]"}], ",", 
               RowBox[{"vc", "[", "2", "]"}]}], "}"}], "+", 
             RowBox[{"Cross", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"omega", "[", "0", "]"}], ",", 
                 RowBox[{"omega", "[", "1", "]"}], ",", 
                 RowBox[{"omega", "[", "2", "]"}]}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
                  RowBox[{
                   RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
                  RowBox[{
                   RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
                "-", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"c", "[", "0", "]"}], ",", 
                  RowBox[{"c", "[", "1", "]"}], ",", 
                  RowBox[{"c", "[", "2", "]"}]}], "}"}]}]}], "]"}], "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"va", "[", "i", "]"}], "[", "0", "]"}], ",", 
               RowBox[{
                RowBox[{"va", "[", "i", "]"}], "[", "1", "]"}], ",", 
               RowBox[{
                RowBox[{"va", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}], 
            ")"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.68582064176493*^9, 3.685820733273151*^9}, {
  3.685908611545021*^9, 3.685908706643835*^9}, {3.685908751043458*^9, 
  3.685908800396866*^9}, {3.68590891563048*^9, 3.6859089572215023`*^9}}],

Cell["Sum of torques on cargo", "Text",
 CellChangeTimes->{{3.685828120856576*^9, 3.6858281304641237`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumTorquesCargoStochastic", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Tbc", "[", "0", "]"}], ",", 
       RowBox[{"Tbc", "[", "1", "]"}], ",", 
       RowBox[{"Tbc", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"brwonian", " ", "torque", " ", "on", " ", "cargo"}], "*)"}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TorqeExt", "[", "0", "]"}], ",", 
       RowBox[{"TorqeExt", "[", "1", "]"}], ",", 
       RowBox[{"TorqeExt", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"external", " ", "torque", " ", "on", " ", "cargo"}], "*)"}], 
     "\[IndentingNewLine]", "-", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"omega", "[", "0", "]"}], ",", 
        RowBox[{"omega", "[", "1", "]"}], ",", 
        RowBox[{"omega", "[", "2", "]"}]}], "}"}], "xiCargoRotation"}], 
     RowBox[{"(*", 
      RowBox[{
      "rotational", " ", "drag", " ", "on", " ", "rotating", " ", "cargo", 
       " ", "from", " ", "water"}], "*)"}], "\[IndentingNewLine]", "-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "[", "0", "]"}], ",", 
             RowBox[{"c", "[", "1", "]"}], ",", 
             RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Fba", "[", "i", "]"}], "[", "0", "]"}], ",", 
            RowBox[{
             RowBox[{"Fba", "[", "i", "]"}], "[", "1", "]"}], ",", 
            RowBox[{
             RowBox[{"Fba", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}], 
         "]"}], 
        RowBox[{"(*", 
         RowBox[{
         "reaction", " ", "torque", " ", "from", " ", "brownian", " ", 
          "force", " ", "on", " ", "cargo"}], "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"(*", 
         RowBox[{
         "reaction", " ", "torques", " ", "to", " ", "drag", " ", "forces", 
          " ", "on", " ", "anchor"}], "*)"}], 
        RowBox[{
         RowBox[{"xiAnchor", "[", "i", "]"}], 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
              RowBox[{
               RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
              RowBox[{
               RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"c", "[", "0", "]"}], ",", 
              RowBox[{"c", "[", "1", "]"}], ",", 
              RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ",", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vc", "[", "0", "]"}], ",", 
              RowBox[{"vc", "[", "1", "]"}], ",", 
              RowBox[{"vc", "[", "2", "]"}]}], "}"}], "+", 
            RowBox[{"Cross", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"omega", "[", "0", "]"}], ",", 
                RowBox[{"omega", "[", "1", "]"}], ",", 
                RowBox[{"omega", "[", "2", "]"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
                 RowBox[{
                  RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
                 RowBox[{
                  RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"c", "[", "0", "]"}], ",", 
                 RowBox[{"c", "[", "1", "]"}], ",", 
                 RowBox[{"c", "[", "2", "]"}]}], "}"}]}]}], "]"}], "-", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"va", "[", "i", "]"}], "[", "0", "]"}], ",", 
              RowBox[{
               RowBox[{"va", "[", "i", "]"}], "[", "1", "]"}], ",", 
              RowBox[{
               RowBox[{"va", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}]}], 
          "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685820821629675*^9, 3.6858208555489264`*^9}, {
  3.685909038468484*^9, 3.685909089712001*^9}, {3.68590922797404*^9, 
  3.6859092331715307`*^9}, {3.685909331351536*^9, 3.685909427998534*^9}}],

Cell["Velocity variables to solve for", "Text",
 CellChangeTimes->{{3.685828139160968*^9, 3.685828146022786*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"velvars", "[", "nmotors_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"va", "[", "i", "]"}], "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"va", "[", "i", "]"}], "[", "1", "]"}], ",", 
         RowBox[{
          RowBox[{"va", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vc", "[", "0", "]"}], ",", 
       RowBox[{"vc", "[", "1", "]"}], ",", 
       RowBox[{"vc", "[", "2", "]"}], ",", 
       RowBox[{"omega", "[", "0", "]"}], ",", 
       RowBox[{"omega", "[", "1", "]"}], ",", 
       RowBox[{"omega", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{3.685824185302882*^9}],

Cell["Discretized variables to solve for", "Text",
 CellChangeTimes->{{3.68582814934149*^9, 3.685828156563992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"discvars", "[", "nmotors_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"a1", "[", "i", "]"}], "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"a1", "[", "i", "]"}], "[", "1", "]"}], ",", 
         RowBox[{
          RowBox[{"a1", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c1", "[", "0", "]"}], ",", 
       RowBox[{"c1", "[", "1", "]"}], ",", 
       RowBox[{"c1", "[", "2", "]"}], ",", 
       RowBox[{"theta1", "[", "0", "]"}], ",", 
       RowBox[{"theta1", "[", "1", "]"}], ",", 
       RowBox[{"theta1", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.685824128996464*^9, 3.68582413403589*^9}, 
   3.685824187709579*^9}],

Cell["List of rules to turn the equation into a discretized one", "Text",
 CellChangeTimes->{{3.685828160557166*^9, 3.685828183293991*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"discRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"va", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a1", "[", "x", "]"}], "[", "y", "]"}], "-", 
        RowBox[{
         RowBox[{"a", "[", "x", "]"}], "[", "y", "]"}]}], ")"}], "/", 
      "dt"}]}], ",", 
    RowBox[{
     RowBox[{"vc", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c1", "[", "x", "]"}], "-", 
        RowBox[{"c", "[", "x", "]"}]}], ")"}], "/", "dt"}]}], ",", 
    RowBox[{
     RowBox[{"omega", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"theta1", "[", "x", "]"}], "-", 
        RowBox[{"theta", "[", "x", "]"}]}], ")"}], "/", "dt"}]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.685821609262302*^9, 3.6858216448691874`*^9}, {
   3.685821676254924*^9, 3.685821702894902*^9}, {3.685821739684156*^9, 
   3.6858217971584253`*^9}, {3.6858218349702177`*^9, 3.685821861276149*^9}, {
   3.6858219917492113`*^9, 3.685822096294816*^9}, 3.6858227136827927`*^9, {
   3.685823248517694*^9, 3.685823419741835*^9}, {3.685823456225264*^9, 
   3.68582349864916*^9}, 3.685824203808404*^9, {3.68582961378611*^9, 
   3.685829674556435*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"va", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"a1", "[", "x", "]"}], "[", "y", "]"}], "-", 
      RowBox[{
       RowBox[{"a", "[", "x", "]"}], "[", "y", "]"}]}], "dt"]}], ",", 
   RowBox[{
    RowBox[{"vc", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      RowBox[{"c1", "[", "x", "]"}], "-", 
      RowBox[{"c", "[", "x", "]"}]}], "dt"]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      RowBox[{"theta1", "[", "x", "]"}], "-", 
      RowBox[{"theta", "[", "x", "]"}]}], "dt"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6858296758729486`*^9, 3.685829984621456*^9, 3.685830038797429*^9, 
   3.685846221429665*^9, {3.685893290204076*^9, 3.6858933127476587`*^9}, 
   3.68589336364888*^9, {3.6858939507028103`*^9, 3.6858939752141438`*^9}, 
   3.685894303488386*^9, 3.6858946531956167`*^9, 3.685895048449067*^9, 
   3.6858952034390574`*^9, 3.6858960816221952`*^9, 3.685909475042844*^9, 
   3.685909751293475*^9, 3.6859875528350554`*^9, 3.685990109738111*^9, 
   3.68712257015186*^9, 3.68712330799284*^9, 3.689440911226816*^9, 
   3.68944195930623*^9, 3.689537162616474*^9, 3.689620563839838*^9, 
   3.689633632548707*^9, 3.69117863573809*^9, 3.694813795365307*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"brownianRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Fba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", " ", 
          RowBox[{"DAnchor", "[", "x", "]"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"muAnchor", "[", "x", "]"}], " ", 
          RowBox[{"Sqrt", "[", "dt", "]"}]}], ")"}]}], ")"}], 
      RowBox[{
       RowBox[{"Dba", "[", "x", "]"}], "[", "y", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"Fbc", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", " ", "DCargoTranslation"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"muCargoTranslation", " ", 
          RowBox[{"Sqrt", "[", "dt", "]"}]}], ")"}]}], ")"}], 
      RowBox[{"Dbc", "[", "x", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"Tbc", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", " ", "DCargoRotation"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"muCargoRotation", " ", 
          RowBox[{"Sqrt", "[", "dt", "]"}]}], ")"}]}], ")"}], 
      RowBox[{"Rbc", "[", "x", "]"}]}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6858296550201693`*^9, 3.6858296618438883`*^9}, {
  3.685893254004937*^9, 3.6858932754892387`*^9}, {3.685893599251741*^9, 
  3.685893608082184*^9}, {3.685893709535286*^9, 3.685893831173573*^9}, {
  3.685894254011365*^9, 3.68589426221187*^9}, {3.685909727384384*^9, 
  3.6859097382158003`*^9}, {3.687122553761495*^9, 3.6871225538557653`*^9}, {
  3.687123261075919*^9, 3.687123263841868*^9}, {3.687888547655604*^9, 
  3.687888552821357*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Fba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{"2", " ", 
        RowBox[{"DAnchor", "[", "x", "]"}]}]], " ", 
      RowBox[{
       RowBox[{"Dba", "[", "x", "]"}], "[", "y", "]"}]}], 
     RowBox[{
      RowBox[{"muAnchor", "[", "x", "]"}], " ", 
      SqrtBox["dt"]}]]}], ",", 
   RowBox[{
    RowBox[{"Fbc", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{"2", " ", "DCargoTranslation"}]], " ", 
      RowBox[{"Dbc", "[", "x", "]"}]}], 
     RowBox[{"muCargoTranslation", " ", 
      SqrtBox["dt"]}]]}], ",", 
   RowBox[{
    RowBox[{"Tbc", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{"2", " ", "DCargoRotation"}]], " ", 
      RowBox[{"Rbc", "[", "x", "]"}]}], 
     RowBox[{"muCargoRotation", " ", 
      SqrtBox["dt"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.685829679242303*^9, 3.6858299846861057`*^9, 3.685830038849503*^9, 
   3.68584622146734*^9, {3.685893290244563*^9, 3.685893312802332*^9}, 
   3.685893363693542*^9, 3.685893622229151*^9, {3.685893814043271*^9, 
   3.6858938315734777`*^9}, {3.685893950753817*^9, 3.68589397527682*^9}, 
   3.6858943035346746`*^9, 3.6858946532278852`*^9, 3.6858950484808807`*^9, 
   3.685895203493576*^9, 3.6858960816686707`*^9, 3.685909475090109*^9, 
   3.685909751350587*^9, 3.6859875528981657`*^9, 3.685990109782908*^9, 
   3.687122570201221*^9, 3.687123308049953*^9, 3.689440911275498*^9, 
   3.6894419593600693`*^9, 3.689537162678151*^9, 3.689620563879796*^9, 
   3.689633632600169*^9, 3.691178635774542*^9, 3.6948137954073553`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xi2muRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"xiAnchor", "[", "x_", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"1", "/", 
      RowBox[{"muAnchor", "[", "x", "]"}]}]}], ",", 
    RowBox[{"xiCargoRotation", "\[Rule]", 
     RowBox[{"1", "/", "muCargoRotation"}]}], ",", 
    RowBox[{"xiCargoTranslation", "\[Rule]", 
     RowBox[{"1", "/", "muCargoTranslation"}]}]}], "}"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"xiAnchor", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox["1", 
     RowBox[{"muAnchor", "[", "x", "]"}]]}], ",", 
   RowBox[{"xiCargoRotation", "\[Rule]", 
    FractionBox["1", "muCargoRotation"]}], ",", 
   RowBox[{"xiCargoTranslation", "\[Rule]", 
    FractionBox["1", "muCargoTranslation"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.685911528464794*^9, 3.685987552948924*^9, 
  3.685990109832219*^9, 3.68712257024826*^9, 3.687123308112534*^9, 
  3.689440911324542*^9, 3.6894419594142733`*^9, 3.689537162745871*^9, 
  3.6896205639335938`*^9, 3.689633632650197*^9, 3.6911786358308372`*^9, 
  3.694813795452962*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step through stochastic solution", "Section",
 CellChangeTimes->{{3.685825799796288*^9, 3.685825806152383*^9}}],

Cell["\<\
To go from the force balance equations written above to the numerical scheme \
to solve them (Euler -Maryuama), we first need to solve for the velocities, \
then discretize. The above equations are all coupled together, but are liner, \
so we can use linear algebra to solve for an equation for each velocity (of \
the anchors, the cargo, and the cargo rotation) individually.\
\>", "Text",
 CellChangeTimes->{{3.685754095226262*^9, 3.685754323532625*^9}, {
   3.68582016911197*^9, 3.6858201963235064`*^9}, {3.685827552835374*^9, 
   3.685827579429392*^9}, {3.685827922936791*^9, 3.6858280646519213`*^9}, {
   3.6859856575303*^9, 3.685985812182311*^9}, 3.685986077063218*^9}],

Cell["\<\
First, write out equations in terms of velocities. Then generate a list of \
equations for a given number of motors - set here for the example solution \
that follows. The equations bet big very quickly.\
\>", "Text",
 CellChangeTimes->{
  3.685827582838533*^9, {3.685986149715364*^9, 3.685986172518361*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmotors", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ",", 
    RowBox[{"i", "<", "nmotors"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumForcesAnchorStocahstic", "[", "i", "]"}], ",", "eqs"}], 
       "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"sumForcesCargoStochastic", "[", "nmotors", "]"}], ",", "eqs"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eqs", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"sumTorquesCargoStochastic", "[", "nmotors", "]"}], ",", "eqs"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.68582356568734*^9, 3.68582364267073*^9}, {
  3.6858239661976852`*^9, 3.685823973363969*^9}, {3.68582405564684*^9, 
  3.685824056670148*^9}, {3.6858242189846077`*^9, 3.685824219029139*^9}, {
  3.6858270225337887`*^9, 3.685827022601071*^9}, {3.685827517588771*^9, 
  3.6858275176445723`*^9}, {3.689529248977901*^9, 3.689529249055563*^9}, {
  3.689536254208871*^9, 3.689536254242065*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "0", "]"}]}], "+", 
     RowBox[{"Tbc", "[", "0", "]"}], "+", 
     RowBox[{"TorqeExt", "[", "0", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "1", "]"}]}], "+", 
     RowBox[{"Tbc", "[", "1", "]"}], "+", 
     RowBox[{"TorqeExt", "[", "1", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "2", "]"}]}], "+", 
     RowBox[{"Tbc", "[", "2", "]"}], "+", 
     RowBox[{"TorqeExt", "[", "2", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"Fbc", "[", "0", "]"}], "+", 
     RowBox[{"Fsteric", "[", "0", "]"}], "+", 
     RowBox[{"Ftrap", "[", "0", "]"}], "-", 
     RowBox[{"xiCargoTranslation", " ", 
      RowBox[{"vc", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"Fbc", "[", "1", "]"}], "+", 
     RowBox[{"Fsteric", "[", "1", "]"}], "+", 
     RowBox[{"Ftrap", "[", "1", "]"}], "-", 
     RowBox[{"xiCargoTranslation", " ", 
      RowBox[{"vc", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"Fbc", "[", "2", "]"}], "+", 
     RowBox[{"Fsteric", "[", "2", "]"}], "+", 
     RowBox[{"Ftrap", "[", "2", "]"}], "-", 
     RowBox[{"xiCargoTranslation", " ", 
      RowBox[{"vc", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.685824041658144*^9, 3.6858240584843082`*^9}, 
   3.6858242211653137`*^9, 3.685824257080385*^9, 3.685826559962892*^9, 
   3.685826807930655*^9, {3.6858269533105917`*^9, 3.685826980027155*^9}, 
   3.685827025336381*^9, 3.685827522052499*^9, 3.6858298978440523`*^9, 
   3.685829984735773*^9, 3.6858300389002542`*^9, 3.685846221496068*^9, 
   3.685893290292556*^9, 3.68589332038494*^9, 3.685893363746293*^9, 
   3.685893627997445*^9, 3.685893839445168*^9, {3.6858939508064947`*^9, 
   3.685893975326516*^9}, 3.685894303576399*^9, 3.685894653276979*^9, 
   3.685895048517456*^9, 3.685895203543894*^9, 3.685896081720436*^9, 
   3.685909475137748*^9, 3.685909751393105*^9, 3.6859875529967537`*^9, 
   3.685990109886348*^9, 3.6871225702971287`*^9, 3.68712330816225*^9, 
   3.6894409113752317`*^9, 3.689441959464602*^9, 3.6895292494663153`*^9, {
   3.6895362547806797`*^9, 3.689536262694169*^9}, 3.689537162794837*^9, 
   3.689633632700697*^9, 3.694813795503853*^9}]
}, Open  ]],

Cell["\<\
There are 3(nmotors+2) equations (3 components: x, y, z for each of the \
nmotors sum of forces equations for each motor, plus 2 for sum of forces and \
torques on cargo)\
\>", "Text",
 CellChangeTimes->{{3.685986186683929*^9, 3.685986192678359*^9}, 
   3.685986224427182*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"3", 
  RowBox[{"(", 
   RowBox[{"nmotors", "+", "2"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "eqs", "]"}]}], "Input",
 CellChangeTimes->{{3.6840073635073347`*^9, 3.684007374239601*^9}, {
  3.684090336371669*^9, 3.684090341610797*^9}, {3.68409048355317*^9, 
  3.684090510507255*^9}, {3.685986252337638*^9, 3.6859862564770393`*^9}}],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{
  3.6840073745679693`*^9, 3.684090274299241*^9, 3.6840903419678907`*^9, {
   3.684090493743384*^9, 3.684090511548506*^9}, 3.684097995580967*^9, 
   3.6841210011171627`*^9, 3.68412301856791*^9, 3.6841231823267403`*^9, 
   3.6853105476689053`*^9, {3.68531061492318*^9, 3.685310627529491*^9}, 
   3.685310698510097*^9, {3.685310955889697*^9, 3.685310967860005*^9}, {
   3.6853112207724257`*^9, 3.685311239337963*^9}, 3.685311387996059*^9, 
   3.6853114936080837`*^9, 3.685312008985652*^9, 3.685312840214675*^9, {
   3.685312984545863*^9, 3.685313000700417*^9}, 3.685314856186658*^9, 
   3.685316607540236*^9, 3.68532186573781*^9, 3.68538915128854*^9, 
   3.685407227339322*^9, 3.685407514299226*^9, 3.6854165023059273`*^9, 
   3.685465689070839*^9, 3.6854664292788057`*^9, 3.685828633602516*^9, 
   3.685829945010229*^9, 3.6858300003405523`*^9, 3.685846174926586*^9, 
   3.685893330152071*^9, 3.68598625725861*^9, 3.685987553048293*^9, 
   3.685990109932991*^9, 3.687122570349784*^9, 3.687123308216076*^9, 
   3.689440911424996*^9, 3.689441959514434*^9, 3.689529254813422*^9, {
   3.6895362583921127`*^9, 3.6895362627727413`*^9}, 3.6895371628456583`*^9, 
   3.6896336327507973`*^9, 3.6948137955537233`*^9}],

Cell[BoxData[
 RowBox[{"{", "6", "}"}]], "Output",
 CellChangeTimes->{
  3.6840073745679693`*^9, 3.684090274299241*^9, 3.6840903419678907`*^9, {
   3.684090493743384*^9, 3.684090511548506*^9}, 3.684097995580967*^9, 
   3.6841210011171627`*^9, 3.68412301856791*^9, 3.6841231823267403`*^9, 
   3.6853105476689053`*^9, {3.68531061492318*^9, 3.685310627529491*^9}, 
   3.685310698510097*^9, {3.685310955889697*^9, 3.685310967860005*^9}, {
   3.6853112207724257`*^9, 3.685311239337963*^9}, 3.685311387996059*^9, 
   3.6853114936080837`*^9, 3.685312008985652*^9, 3.685312840214675*^9, {
   3.685312984545863*^9, 3.685313000700417*^9}, 3.685314856186658*^9, 
   3.685316607540236*^9, 3.68532186573781*^9, 3.68538915128854*^9, 
   3.685407227339322*^9, 3.685407514299226*^9, 3.6854165023059273`*^9, 
   3.685465689070839*^9, 3.6854664292788057`*^9, 3.685828633602516*^9, 
   3.685829945010229*^9, 3.6858300003405523`*^9, 3.685846174926586*^9, 
   3.685893330152071*^9, 3.68598625725861*^9, 3.685987553048293*^9, 
   3.685990109932991*^9, 3.687122570349784*^9, 3.687123308216076*^9, 
   3.689440911424996*^9, 3.689441959514434*^9, 3.689529254813422*^9, {
   3.6895362583921127`*^9, 3.6895362627727413`*^9}, 3.6895371628456583`*^9, 
   3.6896336327507973`*^9, 3.6948137955616217`*^9}]
}, Open  ]],

Cell["\<\
Now we want to solve the equations above for the velocities. First write out \
the velocity variables we want to solve for\
\>", "Text",
 CellChangeTimes->{{3.685986090866044*^9, 3.685986125696065*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"velvars", "[", "nmotors", "]"}]], "Input",
 CellChangeTimes->{{3.6859861305902033`*^9, 3.6859861357767677`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"vc", "[", "0", "]"}], ",", 
   RowBox[{"vc", "[", "1", "]"}], ",", 
   RowBox[{"vc", "[", "2", "]"}], ",", 
   RowBox[{"omega", "[", "0", "]"}], ",", 
   RowBox[{"omega", "[", "1", "]"}], ",", 
   RowBox[{"omega", "[", "2", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.685986136556161*^9, 3.685987553111257*^9, 
  3.685990109987267*^9, 3.6871225704157667`*^9, 3.687123308279217*^9, 
  3.6894409114918747`*^9, 3.689441959577112*^9, 3.689529257545677*^9, 
  3.689536262828424*^9, 3.689537162893627*^9, 3.689633632801317*^9, 
  3.6948137956081133`*^9}]
}, Open  ]],

Cell["\<\
Solve the equations for the velocities by inverting the matrix of \
coefficients of the velocities. Note we solve by multiplying the inverted \
coefficient matrix by (-) the constant vector, this is a quirk in \
CoefficientArrays

Note: Solve doesn\[CloseCurlyQuote]t appear to work for this.\
\>", "Text",
 CellChangeTimes->{{3.685822438518442*^9, 3.685822445786024*^9}, {
  3.685985827864505*^9, 3.685986017044003*^9}, {3.6859863442383823`*^9, 
  3.6859863697977123`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"const", ",", "coeff"}], "}"}], "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{"eqs", ",", 
      RowBox[{"velvars", "[", "nmotors", "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffinv", "=", 
   RowBox[{"Inverse", "[", "coeff", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"veleqs", "=", 
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"velvars", "[", "nmotors", "]"}], "\[Equal]", 
     RowBox[{"coeffinv", ".", 
      RowBox[{"-", "const"}]}]}], "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.685821646207342*^9, 3.685821660212678*^9}, {
   3.6858238251124477`*^9, 3.685823835495564*^9}, 3.685824091490088*^9, {
   3.6858242920307503`*^9, 3.685824325206559*^9}, {3.6895294976096363`*^9, 
   3.6895294988626013`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"vc", "[", "0", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Fbc", "[", "0", "]"}], "+", 
      RowBox[{"Fsteric", "[", "0", "]"}], "+", 
      RowBox[{"Ftrap", "[", "0", "]"}]}], "xiCargoTranslation"]}], ",", 
   RowBox[{
    RowBox[{"vc", "[", "1", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Fbc", "[", "1", "]"}], "+", 
      RowBox[{"Fsteric", "[", "1", "]"}], "+", 
      RowBox[{"Ftrap", "[", "1", "]"}]}], "xiCargoTranslation"]}], ",", 
   RowBox[{
    RowBox[{"vc", "[", "2", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Fbc", "[", "2", "]"}], "+", 
      RowBox[{"Fsteric", "[", "2", "]"}], "+", 
      RowBox[{"Ftrap", "[", "2", "]"}]}], "xiCargoTranslation"]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "0", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Tbc", "[", "0", "]"}], "+", 
      RowBox[{"TorqeExt", "[", "0", "]"}]}], "xiCargoRotation"]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "1", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Tbc", "[", "1", "]"}], "+", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}], "xiCargoRotation"]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "2", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Tbc", "[", "2", "]"}], "+", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}], "xiCargoRotation"]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.685824316831094*^9, 3.68582432760667*^9}, 
   3.685826560052609*^9, 3.685826808026104*^9, {3.685826953363693*^9, 
   3.6858269800630608`*^9}, 3.685827025484111*^9, 3.685827522164817*^9, 
   3.6858298979308977`*^9, 3.6858299847867126`*^9, 3.685830038951179*^9, 
   3.685846221525075*^9, 3.685893290342133*^9, 3.685893320440287*^9, 
   3.6858933638216333`*^9, 3.685893628076323*^9, 3.685893839500454*^9, {
   3.685893950853346*^9, 3.6858939753879538`*^9}, 3.6858943036239843`*^9, 
   3.6858946533315363`*^9, 3.685895048553543*^9, 3.685895203597702*^9, 
   3.685896081770046*^9, 3.685909475191102*^9, 3.685909751437297*^9, 
   3.68598755316197*^9, 3.6859901100334883`*^9, 3.687122570465611*^9, 
   3.687123308332554*^9, 3.689440911540938*^9, 3.689441959630855*^9, 
   3.689529269162655*^9, 3.689529499982712*^9, 3.689536262880424*^9, 
   3.6895371629425907`*^9, 3.689633632854134*^9, 3.694813795681411*^9}]
}, Open  ]],

Cell[TextData[{
 "Discretize the equations by enforcing ",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "=", 
    RowBox[{
     FractionBox["dx", "dt"], "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["x", 
        RowBox[{"n", "+", "1"}]], "-", 
       SuperscriptBox["x", "n"]}], "\[CapitalDelta]t"]}]}], TraditionalForm]],
  
  FormatType->"TraditionalForm"],
 ". Rules given in discRules above. \nFurthermore, we integrate the brownian \
force term to get a brownian displacement, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Fb", "=", 
    RowBox[{
     RowBox[{
      SqrtBox[
       RowBox[{"\[Sigma]", " ", "D"}]], 
      RowBox[{"W", "(", "t", ")"}]}], "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{" ", 
        SqrtBox[
         RowBox[{"\[Sigma]", " ", "D"}]]}], 
       RowBox[{"\[Mu]", 
        SqrtBox["\[CapitalDelta]t"]}]], 
      RowBox[{"N", "(", 
       RowBox[{"0", ",", "1"}], ")"}]}]}]}], TraditionalForm]]],
 ", where \[Sigma] depends on the number of degrees of freedom the diffuser \
has (\[Sigma]=2 for one degree of freedom, 4 for two and 6 for 3). N(0,1) \
represents a random variable drawn from the gaussian distribution with mean 0 \
and variance 1.\nFinally, we simplify the equation numerically by changing \
drag coefficient (which we would need to divide by) into mobility, its \
inverse, which we multiply by."
}], "Text",
 CellChangeTimes->{{3.685822450162264*^9, 3.685822463752226*^9}, {
  3.6858225697382936`*^9, 3.685822583406938*^9}, {3.685823008858972*^9, 
  3.685823120697291*^9}, {3.685823159428072*^9, 3.6858232203721848`*^9}, {
  3.685986468033107*^9, 3.68598664105689*^9}, {3.685986686181158*^9, 
  3.685986697340425*^9}, {3.6859867287289743`*^9, 3.685986862366263*^9}, {
  3.685986923768314*^9, 3.685987129856472*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"discEqs", "=", 
  RowBox[{"veleqs", "/.", 
   RowBox[{"Join", "[", 
    RowBox[{"discRules", ",", "brownianRules", ",", "xi2muRules"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6858243581122847`*^9, 3.685824399096319*^9}, {
   3.685829880611598*^9, 3.6858298915694513`*^9}, {3.6895293789576406`*^9, 
   3.689529382260166*^9}, 3.689536309075001*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"c", "[", "0", "]"}]}], "+", 
      RowBox[{"c1", "[", "0", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoTranslation", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox["DCargoTranslation"], " ", 
         RowBox[{"Dbc", "[", "0", "]"}]}], 
        RowBox[{
         SqrtBox["dt"], " ", "muCargoTranslation"}]], "+", 
       RowBox[{"Fsteric", "[", "0", "]"}], "+", 
       RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"c", "[", "1", "]"}]}], "+", 
      RowBox[{"c1", "[", "1", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoTranslation", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox["DCargoTranslation"], " ", 
         RowBox[{"Dbc", "[", "1", "]"}]}], 
        RowBox[{
         SqrtBox["dt"], " ", "muCargoTranslation"}]], "+", 
       RowBox[{"Fsteric", "[", "1", "]"}], "+", 
       RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"c", "[", "2", "]"}]}], "+", 
      RowBox[{"c1", "[", "2", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoTranslation", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox["DCargoTranslation"], " ", 
         RowBox[{"Dbc", "[", "2", "]"}]}], 
        RowBox[{
         SqrtBox["dt"], " ", "muCargoTranslation"}]], "+", 
       RowBox[{"Fsteric", "[", "2", "]"}], "+", 
       RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"theta", "[", "0", "]"}]}], "+", 
      RowBox[{"theta1", "[", "0", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox["DCargoRotation"], " ", 
         RowBox[{"Rbc", "[", "0", "]"}]}], 
        RowBox[{
         SqrtBox["dt"], " ", "muCargoRotation"}]], "+", 
       RowBox[{"TorqeExt", "[", "0", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"theta", "[", "1", "]"}]}], "+", 
      RowBox[{"theta1", "[", "1", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox["DCargoRotation"], " ", 
         RowBox[{"Rbc", "[", "1", "]"}]}], 
        RowBox[{
         SqrtBox["dt"], " ", "muCargoRotation"}]], "+", 
       RowBox[{"TorqeExt", "[", "1", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"theta", "[", "2", "]"}]}], "+", 
      RowBox[{"theta1", "[", "2", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox["DCargoRotation"], " ", 
         RowBox[{"Rbc", "[", "2", "]"}]}], 
        RowBox[{
         SqrtBox["dt"], " ", "muCargoRotation"}]], "+", 
       RowBox[{"TorqeExt", "[", "2", "]"}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.68582437013113*^9, 3.6858243999829073`*^9}, 
   3.685826560102429*^9, 3.6858268080799427`*^9, {3.685826953415012*^9, 
   3.685826980121085*^9}, 3.685827025596992*^9, 3.685827522198017*^9, {
   3.685829893333518*^9, 3.6858298979820232`*^9}, 3.685829984836589*^9, 
   3.68583003900056*^9, 3.685846221556336*^9, 3.6858932904475193`*^9, 
   3.6858933205004463`*^9, 3.685893363859996*^9, 3.685893628124845*^9, 
   3.68589383954272*^9, {3.6858939509032793`*^9, 3.685893975421361*^9}, 
   3.685894303673387*^9, 3.685894653379899*^9, 3.6858950486009407`*^9, 
   3.6858952036474123`*^9, 3.68589608182015*^9, 3.685909475236932*^9, 
   3.685909751490508*^9, 3.685987151306456*^9, 3.685987553214076*^9, 
   3.685990110082856*^9, 3.6871225705160427`*^9, 3.6871233083819227`*^9, 
   3.689440911590804*^9, 3.689441959677163*^9, 3.689529323992359*^9, 
   3.689529384917647*^9, 3.689536263011483*^9, 3.6895363095375557`*^9, 
   3.6895371629961567`*^9, 3.689633632900692*^9, 3.6948137957202578`*^9}]
}, Open  ]],

Cell["\<\
Now that the equations are discretized, we solve the resulting discretized \
equations for the values at the next step, which are\
\>", "Text",
 CellChangeTimes->{{3.6858225984368763`*^9, 3.68582262158928*^9}, {
  3.6859872191364202`*^9, 3.685987239340711*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"discvars", "[", "nmotors", "]"}]], "Input",
 CellChangeTimes->{{3.685987242897832*^9, 3.685987248555406*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"c1", "[", "0", "]"}], ",", 
   RowBox[{"c1", "[", "1", "]"}], ",", 
   RowBox[{"c1", "[", "2", "]"}], ",", 
   RowBox[{"theta1", "[", "0", "]"}], ",", 
   RowBox[{"theta1", "[", "1", "]"}], ",", 
   RowBox[{"theta1", "[", "2", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.685987249036489*^9, 3.6859875532649593`*^9, 
  3.68599011013313*^9, 3.687122570565961*^9, 3.687123308432251*^9, 
  3.6894409116423397`*^9, 3.6894419597269363`*^9, 3.68952935818083*^9, 
  3.6895362631068993`*^9, 3.689537163043661*^9, 3.689633632951785*^9, 
  3.694813795773677*^9}]
}, Open  ]],

Cell["Solve the equations and simplify them", "Text",
 CellChangeTimes->{{3.685987253282423*^9, 3.685987268658169*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"soln", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"discEqs", ",", 
      RowBox[{"discvars", "[", "nmotors", "]"}]}], "]"}], "//", "First"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.685821894162339*^9, 3.685821966391511*^9}, {
   3.685822116061079*^9, 3.6858221371700974`*^9}, 3.685822717911746*^9, 
   3.685824119131777*^9, 3.6858243503398123`*^9, {3.685824387059539*^9, 
   3.6858244088957453`*^9}, {3.6858265478416033`*^9, 3.685826633610422*^9}, {
   3.685826834558629*^9, 3.68582683678015*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "0", "]"}]}], "+", 
     RowBox[{"theta", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
     RowBox[{"theta", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "2", "]"}]}], "+", 
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6858244092379427`*^9, {3.685826552336358*^9, 3.685826601691846*^9}, 
   3.685826634755744*^9, {3.6858268081568327`*^9, 3.685826837804154*^9}, {
   3.6858269534628353`*^9, 3.68582698018293*^9}, 3.685827025857699*^9, 
   3.685827522254377*^9, 3.685829898058585*^9, 3.685829984886984*^9, 
   3.6858300390488043`*^9, 3.685846221609638*^9, 3.6858932905129023`*^9, 
   3.6858933205734673`*^9, 3.6858933639266243`*^9, 3.685893628180231*^9, 
   3.685893839609456*^9, {3.685893950956829*^9, 3.685893975485365*^9}, 
   3.6858943037289*^9, 3.6858946534307337`*^9, 3.6858950486559343`*^9, 
   3.685895203698777*^9, 3.6858960818867683`*^9, 3.685909475299529*^9, 
   3.6859097515381308`*^9, 3.685987271342372*^9, 3.685987553330535*^9, 
   3.685990110187022*^9, 3.6871225706388083`*^9, 3.6871233084811583`*^9, 
   3.68944091170849*^9, 3.6894419597806683`*^9, 3.68952936612753*^9, 
   3.689536263156723*^9, 3.689537163129133*^9, 3.689633633004163*^9, 
   3.6948137958526373`*^9}]
}, Open  ]],

Cell["Finally, put these into a printable form", "Text",
 CellChangeTimes->{{3.6858276344873877`*^9, 3.685827644735396*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Thread", "[", 
  RowBox[{
   RowBox[{"discvars", "[", "nmotors", "]"}], "==", 
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"discvars", "[", "nmotors", "]"}], "/.", "soln"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6858266174622383`*^9, 3.685826714262645*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "0", "]"}]}], "+", 
     RowBox[{"theta", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
     RowBox[{"theta", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "2", "]"}]}], "+", 
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.685826637848789*^9, {3.6858266812360573`*^9, 3.685826735374387*^9}, 
   3.685826808211841*^9, 3.685826840313208*^9, {3.685826953512967*^9, 
   3.685826980232581*^9}, 3.685827025915041*^9, 3.685827522301631*^9, 
   3.685829898100388*^9, 3.685829984937006*^9, 3.685830039100217*^9, 
   3.685846221640491*^9, 3.685893290578204*^9, 3.685893320667735*^9, 
   3.685893363955656*^9, 3.685893628228155*^9, 3.6858938396360064`*^9, {
   3.685893951004298*^9, 3.6858939755429907`*^9}, 3.685894303776984*^9, 
   3.685894653480569*^9, 3.685895048700057*^9, 3.6858952037446613`*^9, 
   3.6858960819166822`*^9, 3.6859094753292418`*^9, 3.685909751566081*^9, 
   3.685987553378067*^9, 3.685990110232836*^9, 3.6871225706987963`*^9, 
   3.68712330851723*^9, 3.689440911758058*^9, 3.689441959826487*^9, 
   3.689536263207635*^9, 3.68953716326188*^9, 3.6896336330469627`*^9, 
   3.694813795902956*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stochastic equations generating function", "Section",
 CellChangeTimes->{{3.685821445743783*^9, 3.685821459614382*^9}, {
  3.685822690484136*^9, 3.685822704287971*^9}, {3.6858255455388107`*^9, 
  3.6858255578542213`*^9}}],

Cell["\<\
This function does all the steps outlined above, given a number of motors\
\>", "Text",
 CellChangeTimes->{{3.68598730501864*^9, 3.685987327056621*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eqs", ",", "i", ",", "veleqs", ",", "disceqs", ",", "coeff", ",", 
      "coeffinv", ",", "const", ",", "soln"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "<", "nmotors"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqs", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"sumForcesAnchorStocahstic", "[", "i", "]"}], ",", "eqs"}],
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumForcesCargoStochastic", "[", "nmotors", "]"}], ",", 
        "eqs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumTorquesCargoStochastic", "[", "nmotors", "]"}], ",", 
        "eqs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"const", ",", "coeff"}], "}"}], "=", 
      RowBox[{"Normal", "@", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"eqs", ",", 
         RowBox[{"velvars", "[", "nmotors", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coeffinv", "=", 
      RowBox[{"Inverse", "[", "coeff", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"veleqs", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"velvars", "[", "nmotors", "]"}], "\[Equal]", 
        RowBox[{"coeffinv", ".", 
         RowBox[{"-", "const"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"disceqs", "=", 
      RowBox[{"veleqs", "/.", 
       RowBox[{"Join", "[", 
        RowBox[{"discRules", ",", "brownianRules", ",", "xi2muRules"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"soln", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{"disceqs", ",", 
          RowBox[{"discvars", "[", "nmotors", "]"}]}], "]"}], "//", "First"}],
        "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"discvars", "[", "nmotors", "]"}], "==", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"discvars", "[", "nmotors", "]"}], "/.", "soln"}], "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.685752021873514*^9, 3.68575204526968*^9}, {
   3.68575208770603*^9, 3.6857521842190332`*^9}, {3.685752228757876*^9, 
   3.6857522323234243`*^9}, {3.685752264543935*^9, 3.685752284658534*^9}, {
   3.685752351179758*^9, 3.685752354430645*^9}, {3.685753459086227*^9, 
   3.685753531086829*^9}, {3.685820203075674*^9, 3.685820300949844*^9}, {
   3.685820336995573*^9, 3.685820351371944*^9}, 3.685820517706642*^9, {
   3.685820628818067*^9, 3.685820635541727*^9}, 3.685820677745757*^9, {
   3.685820782413342*^9, 3.6858208161300383`*^9}, {3.6858208774524727`*^9, 
   3.685820881217555*^9}, {3.685820923690524*^9, 3.6858209301028633`*^9}, {
   3.685821247565405*^9, 3.685821259354423*^9}, {3.685822755308692*^9, 
   3.685822811748394*^9}, {3.685824425209546*^9, 3.685824484230485*^9}, {
   3.6858268700985003`*^9, 3.6858268958146467`*^9}, {3.685827246218122*^9, 
   3.685827246250827*^9}, {3.685829704459293*^9, 3.685829752018261*^9}, {
   3.685829836815978*^9, 3.685829838378912*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing - deterministic", "Section",
 CellChangeTimes->{{3.6853117361432056`*^9, 3.6853117417205057`*^9}, {
  3.685985450249135*^9, 3.685985453285982*^9}}],

Cell["\<\
To test whether these equations make sense, we can look at simple cases. \
First, look at some simple cases with the stochastic terms removed - a rule \
to do so is\
\>", "Text",
 CellChangeTimes->{{3.6859873349090643`*^9, 3.685987415818853*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stochasticTo0", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Dba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
     "0"}], ",", 
    RowBox[{
     RowBox[{"Dbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
    RowBox[{
     RowBox[{"Rbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.685987421060203*^9, 3.685987446554652*^9}, {
  3.685987571755106*^9, 3.685987574584209*^9}, {3.685987617700138*^9, 
  3.6859876559495077`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Dba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
    "0"}], ",", 
   RowBox[{
    RowBox[{"Dbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
   RowBox[{
    RowBox[{"Rbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6859876622564383`*^9, 3.685990110295451*^9, 
  3.687122570795476*^9, 3.687123308618372*^9, 3.6894409118367643`*^9, 
  3.6894419598786182`*^9, 3.689537163792984*^9, 3.6896336331074467`*^9, 
  3.694813795971484*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"forcesTo0", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], ":>", "0"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], 
     "\[RuleDelayed]", "0"}], ",", 
    RowBox[{
     RowBox[{"Fsteric", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
    RowBox[{
     RowBox[{"Ftrap", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
    RowBox[{
     RowBox[{"TorqeExt", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.685988907577201*^9, 3.685988930998909*^9}, {
  3.685989021999111*^9, 3.685989024619398*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], 
    "\[RuleDelayed]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]",
     "0"}], ",", 
   RowBox[{
    RowBox[{"Fsteric", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
   RowBox[{
    RowBox[{"Ftrap", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
   RowBox[{
    RowBox[{"TorqeExt", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.685988937699194*^9, 3.6859890261735783`*^9, 
  3.685990110353808*^9, 3.687122570916091*^9, 3.687123308668651*^9, 
  3.689440911887513*^9, 3.6894419599271727`*^9, 3.6895371644887114`*^9, 
  3.6896336331660757`*^9, 3.694813796021739*^9}]
}, Open  ]],

Cell["0 motors case, easiest to look at", "Text",
 CellChangeTimes->{{3.685468243444017*^9, 3.685468246569477*^9}, {
  3.685829304331546*^9, 3.685829311969603*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "0", "]"}], "/.", 
  "stochasticTo0"}]], "Input",
 CellChangeTimes->{{3.685311743265396*^9, 3.685311755806418*^9}, {
   3.685311807129068*^9, 3.685311817816437*^9}, 3.685312289331439*^9, {
   3.685315190211714*^9, 3.685315216419607*^9}, {3.685465596646974*^9, 
   3.685465603122868*^9}, {3.685465731576527*^9, 3.685465768441174*^9}, {
   3.6854658921805353`*^9, 3.685465893034176*^9}, {3.685466014028411*^9, 
   3.685466016964177*^9}, {3.685466123998111*^9, 3.6854661250868187`*^9}, {
   3.685466915351313*^9, 3.685466915440946*^9}, {3.685466964378644*^9, 
   3.68546696440827*^9}, {3.685467340476569*^9, 3.6854673405430393`*^9}, {
   3.6854673712781897`*^9, 3.685467406068653*^9}, {3.6854674408004427`*^9, 
   3.685467447485281*^9}, {3.685467545417192*^9, 3.685467548386901*^9}, {
   3.685468096884213*^9, 3.685468096945269*^9}, {3.685468667071039*^9, 
   3.6854686806721163`*^9}, {3.6854687628765507`*^9, 3.685468767754199*^9}, {
   3.685479984826449*^9, 3.685479984913291*^9}, {3.685829027683874*^9, 
   3.685829027739738*^9}, {3.68598766835882*^9, 3.685987680829885*^9}, 
   3.6859877436998653`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6854656034895372`*^9, 3.685465689213483*^9, 3.685465735106903*^9, 
   3.685465768915318*^9, 3.685465893772629*^9, 3.68546612617142*^9, 
   3.685466880574355*^9, {3.6854669161991043`*^9, 3.685466964984136*^9}, 
   3.6854670429073687`*^9, {3.685467183253808*^9, 3.685467185255321*^9}, {
   3.6854673354207697`*^9, 3.685467341113183*^9}, {3.6854673718206882`*^9, 
   3.685467406384935*^9}, 3.685467448683988*^9, 3.68546755005589*^9, 
   3.685468097487165*^9, 3.6854685124959383`*^9, {3.685468664171893*^9, 
   3.685468668721938*^9}, {3.685468700456657*^9, 3.685468728004751*^9}, {
   3.6854687636334343`*^9, 3.685468768208918*^9}, {3.685479979743922*^9, 
   3.685479985829925*^9}, {3.685829028584985*^9, 3.685829047248519*^9}, 
   3.685829099240533*^9, {3.685829138445758*^9, 3.6858291879932823`*^9}, 
   3.685829337146323*^9, 3.6858299452296047`*^9, 3.685830000609424*^9, 
   3.685846175203927*^9, 3.6858933303553543`*^9, 3.6859875534960537`*^9, 
   3.6859876814826307`*^9, 3.6859877456185923`*^9, 3.685990110402038*^9, 
   3.687122571033265*^9, 3.6871233087182302`*^9, 3.6894409119409113`*^9, 
   3.689441959976942*^9, 3.689537164585577*^9, 3.689633633213924*^9, 
   3.694813796074181*^9}]
}, Open  ]],

Cell["\<\
If all forces are 0, should simplify to a1=a, c1=c, omega=0 - no motion\
\>", "Text",
 CellChangeTimes->{{3.685312226178508*^9, 3.685312269040287*^9}, {
  3.68598771844333*^9, 3.685987720445202*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"forcesTo0", ",", "stochasticTo0"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.685311743265396*^9, 3.685311755806418*^9}, {
   3.685311807129068*^9, 3.685311817816437*^9}, 3.685312289331439*^9, {
   3.685315190211714*^9, 3.685315216419607*^9}, {3.6859877259915752`*^9, 
   3.6859878817812853`*^9}, {3.6859889275557127`*^9, 3.685988941331477*^9}, {
   3.685989033428213*^9, 3.685989048750431*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.685987884164966*^9, 3.685988942302272*^9, 
  3.6859890492798986`*^9, 3.685990110610814*^9, 3.6871225720838757`*^9, 
  3.687123309551425*^9, 3.689440912626862*^9, 3.689441960578467*^9, 
  3.689537165340954*^9, 3.6896336349141483`*^9, 3.694813796857664*^9}]
}, Open  ]],

Cell["For more anchors ", "Text",
 CellChangeTimes->{{3.685469932854989*^9, 3.685469941074626*^9}, {
  3.685469972383471*^9, 3.685469974543227*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "3", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"stochasticTo0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], ":>", 
      "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], 
      "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685311743265396*^9, 3.685311755806418*^9}, {
   3.685311807129068*^9, 3.685311817816437*^9}, 3.685312289331439*^9, {
   3.685315190211714*^9, 3.685315216419607*^9}, {3.685469994158395*^9, 
   3.685469994243108*^9}, {3.6859878933692617`*^9, 3.68598791193403*^9}, {
   3.687123302339286*^9, 3.687123303340398*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "1", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "1", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "1", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "2", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "2", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "2", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.685987909128104*^9, 3.685987934856329*^9}, 
   3.6859901227674313`*^9, 3.687122598121142*^9, 3.687123317575685*^9, 
   3.689440918339872*^9, 3.689441967014575*^9, 3.689537171328623*^9, 
   3.689633648771818*^9, 3.694813802860589*^9}]
}, Open  ]],

Cell["\<\
Want to take a look at equations for only external torque in the z direction \
- should change location of anchors, but not the cargo.\
\>", "Text",
 CellChangeTimes->{{3.685470100520462*^9, 3.6854701195630827`*^9}, {
  3.685471093817589*^9, 3.685471095771871*^9}, {3.6854724282536697`*^9, 
  3.6854724307388973`*^9}, {3.685829356115245*^9, 3.68582937356329*^9}, {
  3.685829504546586*^9, 3.6858295184290533`*^9}, {3.6859879990737753`*^9, 
  3.6859880019641037`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invsoln", "=", 
  RowBox[{
   RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"stochasticTo0", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], ":>", 
       "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], 
       "\[RuleDelayed]", "0"}], ",", 
      RowBox[{
       RowBox[{"Fsteric", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
      RowBox[{
       RowBox[{"Ftrap", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TorqeExt", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"TorqeExt", "[", "1", "]"}], "\[Rule]", "0"}]}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.685470128162623*^9, 3.6854701282293262`*^9}, 
   3.685471596681834*^9, 3.685472300550909*^9, {3.685987928817751*^9, 
   3.685987965796608*^9}, {3.685988035354703*^9, 3.6859880568082037`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "[", "1", "]"}], " ", 
         RowBox[{"TorqeExt", "[", "2", "]"}]}], "-", 
        RowBox[{
         RowBox[{"TorqeExt", "[", "2", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"c", "[", "0", "]"}]}], " ", 
         RowBox[{"TorqeExt", "[", "2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"TorqeExt", "[", "2", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.685987968871426*^9, 3.685988057646339*^9, 
  3.685990123108564*^9, 3.687122598809825*^9, 3.687123318439905*^9, 
  3.689440918675906*^9, 3.6894419676667767`*^9, 3.68953717172945*^9, 
  3.6896336499211617`*^9, 3.694813803279438*^9}]
}, Open  ]],

Cell["\<\
Want to look at external force in x direction - should change locations of \
cargo and anchors together, only in x direction\
\>", "Text",
 CellChangeTimes->{{3.685472357470635*^9, 3.6854723737015533`*^9}, {
  3.6858295219615383`*^9, 3.685829548849044*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"stochasticTo0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], ":>", 
      "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], 
      "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ftrap", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685470128162623*^9, 3.6854701282293262`*^9}, 
   3.685471596681834*^9, 3.685472300550909*^9, {3.6859880146318827`*^9, 
   3.6859880185587378`*^9}, {3.68598807543793*^9, 3.685988105651586*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"Ftrap", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"Ftrap", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.685988102496682*^9, 3.685988106271151*^9}, 
   3.685990123321589*^9, 3.687122599146824*^9, 3.687123319238489*^9, 
   3.689440918862608*^9, 3.689441968168692*^9, 3.689537171942959*^9, 
   3.689633650854718*^9, 3.694813803488909*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing for stochastic equations", "Section",
 CellChangeTimes->{{3.685826489183947*^9, 3.685826497620698*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"generateEqsStochastic", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.6858264991887407`*^9, 3.68582650292021*^9}, {
  3.6858270080549707`*^9, 3.685827008122107*^9}, {3.685827507352364*^9, 
  3.6858275074043007`*^9}, {3.685829764095656*^9, 3.6858297869884768`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "0", "]"}]}], "+", 
     RowBox[{"theta", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
     RowBox[{"theta", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "2", "]"}]}], "+", 
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.685826504658276*^9, 3.685826905485097*^9, {3.685826953563291*^9, 
   3.685827008678941*^9}, 3.6858272626108837`*^9, 3.685827507831451*^9, {
   3.685829761434699*^9, 3.6858297873429537`*^9}, 3.685829984986368*^9, 
   3.6858300391522417`*^9, 3.685846221682173*^9, 3.685893290706628*^9, 
   3.685893363988223*^9, {3.6858939510562267`*^9, 3.685893975599105*^9}, 
   3.685894303825622*^9, 3.685894653537477*^9, 3.685895048761354*^9, 
   3.685895203807218*^9, 3.6858960819785624`*^9, 3.685909475420459*^9, 
   3.685909751607401*^9, 3.685987553747477*^9, 3.6859901233496447`*^9, 
   3.687122599207411*^9, 3.6871233193261003`*^9, 3.6894409189104*^9, 
   3.689441968245829*^9, 3.689537171976048*^9, 3.6896336509348097`*^9, 
   3.694813803540627*^9}]
}, Open  ]],

Cell[TextData[{
 "If all forces are 0 we should just get brownian movement with ",
 Cell[BoxData[
  FormBox[
   SqrtBox[
    RowBox[{"6", "D", " ", "dt"}]], TraditionalForm]]],
 "in front for the cargo (diffusion of a particle)"
}], "Text",
 CellChangeTimes->{{3.685830116860518*^9, 3.6858301317436447`*^9}, {
  3.685830278680277*^9, 3.685830383169176*^9}, {3.685896795617928*^9, 
  3.685896823469963*^9}, {3.685989071264306*^9, 3.685989088912842*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "0", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"forcesTo0", ",", 
     RowBox[{
      RowBox[{"Rbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685830106375854*^9, 3.685830111280898*^9}, {
  3.685830311743888*^9, 3.685830323825683*^9}, {3.6859889605406237`*^9, 
  3.685988971958437*^9}, {3.6859891158903027`*^9, 3.6859891343739853`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6858301134959297`*^9, {3.685830314294078*^9, 3.685830324233374*^9}, 
   3.685846221739214*^9, 3.685893290868232*^9, 3.685893364029952*^9, {
   3.685893951109572*^9, 3.6858939756631804`*^9}, 3.685894303880155*^9, 
   3.685894653591926*^9, 3.685895048818602*^9, 3.6858952038651543`*^9, 
   3.685896082036639*^9, 3.6859094754794483`*^9, 3.685909751659605*^9, 
   3.685987553858218*^9, 3.68598897294766*^9, 3.685989060203179*^9, 
   3.685989134806006*^9, 3.685990123407164*^9, 3.687122599237582*^9, 
   3.687123319381448*^9, 3.689440918956204*^9, 3.6894419683013153`*^9, 
   3.689537172031157*^9, 3.689633651000579*^9, 3.694813803591124*^9}]
}, Open  ]],

Cell["\<\
If we turn off diffusion for cargo, center shouldn\[CloseCurlyQuote]t move. \
By adding the reaction forces on the cargo we\[CloseCurlyQuote]ve modeled the \
brownian forces on the anchors as coming from the cargo itself.\
\>", "Text",
 CellChangeTimes->{{3.685896826608658*^9, 3.685896877739759*^9}, {
  3.6858969745006113`*^9, 3.685896984412034*^9}, {3.6858973206075907`*^9, 
  3.685897324554768*^9}, {3.685897548610469*^9, 3.6858975908191633`*^9}, {
  3.685909543715473*^9, 3.685909592258353*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"forcesTo0", ",", 
     RowBox[{
      RowBox[{"Dbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Rbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685896887955039*^9, 3.685896951483573*^9}, {
  3.6859891497079573`*^9, 3.6859892081738358`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["dt"], " ", 
      SqrtBox[
       RowBox[{"DAnchor", "[", "0", "]"}]], " ", 
      RowBox[{
       RowBox[{"Dba", "[", "0", "]"}], "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["dt"], " ", 
      SqrtBox[
       RowBox[{"DAnchor", "[", "0", "]"}]], " ", 
      RowBox[{
       RowBox[{"Dba", "[", "0", "]"}], "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["dt"], " ", 
      SqrtBox[
       RowBox[{"DAnchor", "[", "0", "]"}]], " ", 
      RowBox[{
       RowBox[{"Dba", "[", "0", "]"}], "[", "2", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6858969538034267`*^9, 3.685909476200326*^9, 
  3.6859097522129707`*^9, 3.68598755455759*^9, 3.685989209723731*^9, 
  3.6859901235927973`*^9, 3.6871225994493637`*^9, 3.687123320266004*^9, 
  3.689440919159759*^9, 3.6894419687975063`*^9, 3.689537172224842*^9, 
  3.689633651418316*^9, 3.694813803788992*^9}]
}, Open  ]],

Cell["\<\
Brownian motion of the cargo should move the anchors along with it\
\>", "Text",
 CellChangeTimes->{{3.685897647125134*^9, 3.6858976588813887`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"forcesTo0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Dba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{"Rbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685897606682579*^9, 3.685897624490458*^9}, {
  3.685989229008772*^9, 3.685989257538666*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6858976323207417`*^9, 3.6859094764714746`*^9, 
  3.685909752775352*^9, 3.6859875547594757`*^9, 3.685989258372151*^9, 
  3.685990123776114*^9, 3.6871225996588097`*^9, 3.687123321170623*^9, 
  3.689440919363888*^9, 3.689441969291861*^9, 3.689537172416716*^9, 
  3.68963365188628*^9, 3.6948138039755373`*^9}]
}, Open  ]],

Cell["\<\
Brownian rotation of cargo should move anchors but not center\
\>", "Text",
 CellChangeTimes->{{3.685897713736219*^9, 3.685897735144916*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"forcesTo0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Dba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{"Dbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6858976968398933`*^9, 3.685897700956555*^9}, {
  3.685989276440806*^9, 3.685989285416732*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"c", "[", "2", "]"}]}], " ", 
         RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"c", "[", "1", "]"}], " ", 
         RowBox[{"Rbc", "[", "2", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Rbc", "[", "2", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Rbc", "[", "1", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "[", "2", "]"}], " ", 
         RowBox[{"Rbc", "[", "0", "]"}]}], "-", 
        RowBox[{
         RowBox[{"c", "[", "0", "]"}], " ", 
         RowBox[{"Rbc", "[", "2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Rbc", "[", "2", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Rbc", "[", "0", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"c", "[", "1", "]"}]}], " ", 
         RowBox[{"Rbc", "[", "0", "]"}]}], "+", 
        RowBox[{
         RowBox[{"c", "[", "0", "]"}], " ", 
         RowBox[{"Rbc", "[", "1", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Rbc", "[", "1", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Rbc", "[", "0", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "0", "]"}]}], "+", 
     RowBox[{"theta", "[", "0", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
     RowBox[{"theta", "[", "1", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "2", "]"}]}], "+", 
     RowBox[{"theta", "[", "2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6858977057893667`*^9, 3.685909476756806*^9, 
  3.685909753121841*^9, 3.685987555049252*^9, 3.685989286447761*^9, 
  3.685990123985132*^9, 3.687122599862096*^9, 3.68712332203612*^9, 
  3.689440919760607*^9, 3.6894419698031893`*^9, 3.689537172652817*^9, 
  3.689633652263363*^9, 3.694813804259183*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate c-like file", "Chapter",
 CellChangeTimes->{{3.685987538173353*^9, 3.685987547398225*^9}}],

Cell[CellGroupData[{

Cell["Generate solutions", "Section",
 CellChangeTimes->{{3.685990505698781*^9, 3.685990521955017*^9}}],

Cell["\<\
Define the maximum number of motors we want to write equations for and \
generate the equations for each number of motors up to that one (including \
0). The equation generation can take a while\
\>", "Text",
 CellChangeTimes->{{3.685990780377955*^9, 3.685990816715549*^9}, {
  3.6859909029347897`*^9, 3.685990919641189*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmax", "=", "5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"j", "=", "0"}], ",", 
    RowBox[{"j", "\[LessEqual]", "nmax"}], ",", 
    RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"stochasticEqs", "[", "j", "]"}], "=", 
      RowBox[{"generateEqsStochastic", "[", "j", "]"}]}], ";"}]}], 
   "\[IndentingNewLine]", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.685990550013318*^9, 3.685990612438738*^9}, {
  3.685990881257484*^9, 3.685990881796736*^9}, {3.685990946068471*^9, 
  3.6859909462923803`*^9}, {3.6894409012714777`*^9, 3.689440901436007*^9}, {
  3.6894419328895683`*^9, 3.689441955681267*^9}, {3.6896335601310673`*^9, 
  3.689633560422171*^9}}],

Cell["Check an element", "Text",
 CellChangeTimes->{{3.6859908229927073`*^9, 3.685990827054187*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"stochasticEqs", "[", "1", "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.68599067388026*^9, 3.6859907308894253`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox["DCargoTranslation"], " ", 
    SqrtBox["dt"], " ", 
    RowBox[{"Dbc", "[", "0", "]"}]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "+", 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox["dt"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SqrtBox["DCargoRotation"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"c", "[", "2", "]"}]}], " ", 
          RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
         RowBox[{
          RowBox[{"c", "[", "1", "]"}], " ", 
          RowBox[{"Rbc", "[", "2", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Rbc", "[", "2", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Rbc", "[", "1", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"DAnchor", "[", "0", "]"}]], " ", 
       RowBox[{
        RowBox[{"Dba", "[", "0", "]"}], "[", "0", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"dt", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"muAnchor", "[", "0", "]"}], " ", 
       RowBox[{
        RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
      RowBox[{"muCargoTranslation", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Fsteric", "[", "0", "]"}], "+", 
         RowBox[{"Ftrap", "[", "0", "]"}], "+", 
         RowBox[{
          RowBox[{"FmRadial", "[", "0", "]"}], "[", "0", "]"}], "+", 
         RowBox[{
          RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], ")"}]}],
       "+", 
      RowBox[{"muCargoRotation", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"TorqeExt", "[", "2", "]"}]}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
         RowBox[{
          RowBox[{"TorqeExt", "[", "1", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"c", "[", "1", "]"}], "2"], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"c", "[", "2", "]"}], "2"], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "2"], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], "2"], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "1", "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
         RowBox[{
          RowBox[{"c", "[", "1", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TorqeExt", "[", "2", "]"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], " ", 
             RowBox[{
              RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"c", "[", "0", "]"}]}], "+", 
               RowBox[{
                RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], ")"}], " ", 
             RowBox[{
              RowBox[{"FmTangential", "[", "0", "]"}], "[", "1", "]"}]}]}], 
           ")"}]}], "+", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "2", "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "2", "]"}]}], "-", 
         RowBox[{
          RowBox[{"c", "[", "2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TorqeExt", "[", "1", "]"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], " ", 
             RowBox[{
              RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", "[", "0", "]"}], "-", 
               RowBox[{
                RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], ")"}], " ", 
             RowBox[{
              RowBox[{"FmTangential", "[", "0", "]"}], "[", "2", "]"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.685990679948995*^9, 3.6859907313187447`*^9}, 
   3.6859909978512383`*^9, 3.687122643075014*^9, 3.687123376302928*^9, 
   3.689441800343696*^9, 3.689456898425705*^9, 3.6896337730188093`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Write solutions", "Section",
 CellChangeTimes->{{3.685990513731245*^9, 3.685990517882678*^9}}],

Cell["\<\
Create and open a file to write to. If it already exists, delete the old one\
\>", "Text",
 CellChangeTimes->{{3.685989405081962*^9, 3.685989407972825*^9}, {
  3.6859895989977083`*^9, 3.685989632004455*^9}, {3.685989669647953*^9, 
  3.685989671356762*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"DeleteFile", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
   "\"\<stochasticequations.c\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outfileLoc", "=", 
   RowBox[{"CreateFile", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<stochasticequations.c\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outfile", "=", 
   RowBox[{"File", "[", "outfileLoc", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.684098648719748*^9, 3.684098677654524*^9}, 
   3.6840991788294983`*^9, 3.68409921040814*^9, {3.684102465568993*^9, 
   3.684102482037467*^9}, {3.684102558481722*^9, 3.684102578910823*^9}, {
   3.684122712337173*^9, 3.684122713519846*^9}, {3.685825583032132*^9, 
   3.685825584651936*^9}, {3.685850341986755*^9, 3.685850358549972*^9}, {
   3.685989573640522*^9, 3.685989584440605*^9}}],

Cell[BoxData[
 TemplateBox[{
  "DeleteFile","fdnfnd",
   "\"Directory or file \
\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/Matt/project_code/Motor_Freedom/tools/\
stochasticequations.c\\\\\\\"\\\"}]\\) not found.\"",2,80,10,
   25509452572971393413,"Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.6871226432006617`*^9, 3.687123376347416*^9, 
  3.689441800386855*^9, 3.689456898461998*^9, 3.6896337730577507`*^9}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.687122643209319*^9, 3.6871233764000387`*^9, 
  3.689441800454718*^9, 3.689456898530373*^9, 3.689633773126322*^9}]
}, Open  ]],

Cell["\<\
Write C function beginning lines to the equations for each number of motors \
in a switch case structure\
\>", "Text",
 CellChangeTimes->{{3.6840992130621567`*^9, 3.684099228238578*^9}, {
  3.685825660308721*^9, 3.685825661635256*^9}, {3.685989993825622*^9, 
  3.685990014762042*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<//prototypes\>\"", ",", "\"\<\\n\>\"", ",", 
    "\"\<void stochastic_equations();\>\"", ",", "\"\<\\n\\n\>\""}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"prototype", " ", "line"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<void stochastic_equations(){\>\"", ",", 
    "\"\<\\n\>\""}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"function", " ", "definition"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<    \>\"", ",", "\"\<switch(total_motors){\>\"", ",", 
    "\"\<\\n\>\""}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"declaration", " ", "of", " ", "switch", " ", "statement"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.684099231380281*^9, 3.684099240084999*^9}, {
  3.6840992762656183`*^9, 3.684099515878077*^9}, {3.6840996083649063`*^9, 
  3.684099671532875*^9}, {3.6840997024259577`*^9, 3.684099710873991*^9}, {
  3.68410043232519*^9, 3.684100434844616*^9}, {3.684100489632914*^9, 
  3.684100491769526*^9}, {3.684102822946341*^9, 3.684102824329294*^9}, {
  3.685388941745635*^9, 3.685388952817151*^9}, {3.685407473277313*^9, 
  3.685407474546224*^9}, {3.685825623847027*^9, 3.685825633602104*^9}, {
  3.685846086266388*^9, 3.68584610380118*^9}, {3.685989831493289*^9, 
  3.685989868850224*^9}}],

Cell["Write out equations for each number of motors up to some max", "Text",
 CellChangeTimes->{{3.685989691236011*^9, 3.6859897102478848`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "for", " ", "all", " ", "numbers", " ", "of", " ", "motors", " ", "up", 
    " ", "to", " ", "nmax"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"j", "=", "0"}], ",", 
    RowBox[{"j", "\[LessEqual]", "nmax"}], ",", 
    RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "write", " ", "a", " ", "line", " ", "for", " ", "the", " ", "case", " ",
       "of", " ", "j", " ", "motors"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WriteString", "[", 
      RowBox[{
      "outfile", ",", "\"\<        \>\"", ",", "\"\<case \>\"", ",", "j", 
       ",", "\"\<:\>\"", ",", "\"\<\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "for", " ", "of", " ", "the", " ", "equations", " ", "in", " ", "the", 
        " ", "solution"}], ",", " ", 
       RowBox[{
        RowBox[{"convert", " ", "it", " ", "to", " ", "c"}], "-", 
        RowBox[{
        "ish", " ", "form", " ", "and", " ", "write", " ", "it", " ", "out", 
         " ", "to", " ", "the", " ", "file"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"3", 
         RowBox[{"(", 
          RowBox[{"j", "+", "2"}], ")"}]}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"if", " ", 
          RowBox[{"it", "'"}], "s", " ", "a", " ", "line", " ", "with", " ", 
          "theta"}], ",", " ", 
         RowBox[{
         "comment", " ", "it", " ", "out", " ", "since", " ", "we", " ", 
          "never", " ", "use", " ", "the", " ", "value", " ", "of", " ", 
          "theta"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[Equal]", " ", 
            RowBox[{"3", 
             RowBox[{"(", 
              RowBox[{"j", "+", "2"}], ")"}]}]}], "||", 
           RowBox[{"i", "\[Equal]", " ", 
            RowBox[{
             RowBox[{"3", 
              RowBox[{"(", 
               RowBox[{"j", "+", "2"}], ")"}]}], "-", "1"}]}], "||", 
           RowBox[{"i", "\[Equal]", " ", 
            RowBox[{
             RowBox[{"3", 
              RowBox[{"(", 
               RowBox[{"j", "+", "2"}], ")"}]}], "-", "2"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<            \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"stochasticEqs", "[", "j", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<            \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"stochasticEqs", "[", "j", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "write", " ", "a", " ", "break", " ", "at", " ", "the", " ", "end", " ",
        "of", " ", "the", " ", "case"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{
      "outfile", ",", "\"\<            \>\"", ",", "\"\<break;\>\"", ",", 
       "\"\<\\n\\n\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.684098684247036*^9, 3.684098766686006*^9}, {
   3.684098856697693*^9, 3.684098878004724*^9}, {3.684099061289969*^9, 
   3.6840991277763557`*^9}, 3.6840991935196753`*^9, {3.684099519804295*^9, 
   3.684099541348055*^9}, {3.6840997343083973`*^9, 3.684099816432733*^9}, {
   3.684100169619607*^9, 3.6841001736468277`*^9}, {3.684100402884281*^9, 
   3.684100411512261*^9}, {3.6841005086000032`*^9, 3.684100540493479*^9}, {
   3.68410061534379*^9, 3.684100657686246*^9}, {3.684100711764319*^9, 
   3.684100715138089*^9}, {3.685310680916917*^9, 3.685310683885453*^9}, {
   3.6853114763699017`*^9, 3.685311479619326*^9}, {3.685407221763399*^9, 
   3.685407221799777*^9}, {3.685465676220456*^9, 3.685465676259206*^9}, {
   3.6854659373040123`*^9, 3.685465953817956*^9}, {3.6854685904634333`*^9, 
   3.68546859084135*^9}, {3.685468806323731*^9, 3.6854688063796387`*^9}, {
   3.685471190990142*^9, 3.685471191024145*^9}, {3.6858090438046227`*^9, 
   3.685809117375259*^9}, {3.685809192345202*^9, 3.685809227111394*^9}, {
   3.685809340496956*^9, 3.685809353218791*^9}, {3.685809387948227*^9, 
   3.685809391389855*^9}, {3.685809431936461*^9, 3.685809437741338*^9}, {
   3.685809615973763*^9, 3.6858096344905577`*^9}, {3.68580970844851*^9, 
   3.685809710641583*^9}, {3.6858098008331947`*^9, 3.6858098265387697`*^9}, {
   3.685825718954495*^9, 3.6858257450769653`*^9}, {3.685826976061697*^9, 
   3.685826976116604*^9}, {3.685989715424526*^9, 3.685989807156097*^9}, {
   3.6859898931505423`*^9, 3.685989980304138*^9}, {3.6859901054725103`*^9, 
   3.685990105549755*^9}, {3.685990261700066*^9, 3.685990273579719*^9}, {
   3.685990308897138*^9, 3.685990378237952*^9}, {3.6859904640868073`*^9, 
   3.685990466865103*^9}, {3.6859906369764147`*^9, 3.6859906690155983`*^9}, {
   3.685990742219083*^9, 3.685990772099668*^9}, {3.689460999388219*^9, 
   3.6894609994202967`*^9}, {3.689523539530192*^9, 3.689523541138032*^9}, {
   3.689633599162031*^9, 3.689633599394136*^9}}],

Cell["Finish case structure and function", "Text",
 CellChangeTimes->{{3.685990028971142*^9, 3.6859900437981052`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<        \>\"", ",", "\"\<default:\>\"", ",", 
    "\"\<\\n\>\"", ",", "\"\<            \>\"", ",", 
    "\"\<printf(\\\"Bad value for total_motors\\\\n\\\");\>\"", ",", 
    "\"\<\\n\>\""}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "write", " ", "default", " ", "case", " ", "with", " ", "error", " ", 
    "statement"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"WriteString", "[", 
  RowBox[{
  "outfile", ",", "\"\<            \>\"", ",", "\"\<exit(0);\>\"", ",", 
   "\"\<\\n\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"outfile", ",", "\"\<    }\\n\>\"", ",", "\"\<}\\n\>\""}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "write", " ", "the", " ", "bracket", " ", "to", " ", "end", " ", "the", 
    " ", "function"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.684099840640665*^9, 3.684099931812181*^9}, {
  3.6840999744158993`*^9, 3.68409998222359*^9}, {3.684100043368163*^9, 
  3.684100084620983*^9}, {3.6841001168977137`*^9, 3.684100160693183*^9}, {
  3.684100202273947*^9, 3.6841002029258747`*^9}, {3.684100279347612*^9, 
  3.684100298168747*^9}, {3.684100370877803*^9, 3.6841003714731607`*^9}, {
  3.684100419881982*^9, 3.6841004213560467`*^9}, {3.684100523328725*^9, 
  3.684100531020879*^9}, {3.684100563084326*^9, 3.684100566716979*^9}, {
  3.685416480599662*^9, 3.685416481870009*^9}, {3.6859900521466017`*^9, 
  3.685990087909483*^9}, {3.689443929058951*^9, 3.6894439521319942`*^9}}],

Cell["Finally, close the file", "Text",
 CellChangeTimes->{{3.6859900917003107`*^9, 3.685990094411708*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Close", "[", "outfile", "]"}]], "Input"],

Cell[BoxData["\<\"/Users/Matt/project_code/Motor_Freedom/tools/\
stochasticequations.c\"\>"], "Output",
 CellChangeTimes->{{3.684100300257049*^9, 3.6841003123613777`*^9}, 
   3.684100438657907*^9, 3.684100553368664*^9, 3.6841005843912697`*^9, 
   3.684100673530526*^9, {3.684100722534998*^9, 3.684100732493864*^9}, 
   3.684102391742468*^9, 3.684102594087244*^9, 3.6841028306272573`*^9, 
   3.684121002174754*^9, 3.684122725655195*^9, 3.684123019930887*^9, 
   3.6841233523696623`*^9, 3.685310548666443*^9, {3.685310618702059*^9, 
   3.6853106288145733`*^9}, 3.68531069968434*^9, {3.685310957682103*^9, 
   3.685310969501884*^9}, 3.685311255730791*^9, 3.685311402237832*^9, 
   3.6853115071808147`*^9, 3.685312010253036*^9, 3.685312841126239*^9, {
   3.685312985680805*^9, 3.6853130014500933`*^9}, 3.685314857065839*^9, 
   3.685316608044868*^9, 3.6853218660793743`*^9, 3.685389151945215*^9, 
   3.685407229598117*^9, 3.685407515813778*^9, 3.685416503740095*^9, {
   3.6854656908324947`*^9, 3.685465700600263*^9}, 3.685466038857834*^9, 
   3.685468637688806*^9, {3.685468811556815*^9, 3.6854688194929333`*^9}, 
   3.6854712321194677`*^9, 3.685809145536249*^9, 3.68580927994246*^9, 
   3.6858093874017143`*^9, 3.685809471968864*^9, 3.685809749058251*^9, 
   3.685825770949732*^9, 3.6858269969894533`*^9, 3.685827299476267*^9, 
   3.685829988554552*^9, 3.685830042478118*^9, 3.685846229066922*^9, 
   3.685893310046109*^9, 3.685893370932152*^9, {3.685893963828843*^9, 
   3.6858939863996572`*^9}, 3.68589432124051*^9, 3.685894669222761*^9, 
   3.685895064162703*^9, 3.685895219296137*^9, 3.685896097772681*^9, 
   3.685909484995805*^9, 3.685909759388433*^9, 3.6859901587780323`*^9, 
   3.6859908424946938`*^9, 3.685990997927788*^9, 3.687122643313582*^9, 
   3.6871233764811697`*^9, 3.689441800639526*^9, 3.6894568993827457`*^9, 
   3.689633773211581*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bead-Like Version", "Chapter",
 CellChangeTimes->{{3.6895235887477293`*^9, 3.689523593730813*^9}, {
  3.689523754830261*^9, 3.689523756911421*^9}}],

Cell["\<\
The stochastic version of the equations is workable up to about 20 motors on \
the cargo, but after that it starts to take a very long time to generate more \
equations (more than overnight to get the equations from 20 motors to 30 \
motors). In some situations, we\[CloseCurlyQuote]ll only need a cargo with \
motors stuck on it statically, for which the equations are less complicated \
and should be easier to generate.\
\>", "Text",
 CellChangeTimes->{{3.689523597263177*^9, 3.689523750881422*^9}}],

Cell["\<\
Sum of forces on cargo, now excluding drag forces from anchors in the membrane\
\>", "Text",
 CellChangeTimes->{{3.685828111406816*^9, 3.68582811720042*^9}, {
  3.6948913818182*^9, 3.6948913969367237`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumForcesCargoBead", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Thread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fbc", "[", "0", "]"}], ",", 
       RowBox[{"Fbc", "[", "1", "]"}], ",", 
       RowBox[{"Fbc", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"brownian", " ", "force", " ", "on", " ", "the", " ", "cargo"}],
       "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ftrap", "[", "0", "]"}], ",", 
       RowBox[{"Ftrap", "[", "1", "]"}], ",", 
       RowBox[{"Ftrap", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"external", " ", "force", " ", "on", " ", "the", " ", "cargo"}],
       "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fsteric", "[", "0", "]"}], ",", 
       RowBox[{"Fsteric", "[", "1", "]"}], ",", 
       RowBox[{"Fsteric", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"steric", " ", "force", " ", "on", " ", "the", " ", "cargo"}], 
      "*)"}], "\[IndentingNewLine]", "-", 
     RowBox[{"xiCargoTranslation", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vc", "[", "0", "]"}], ",", 
        RowBox[{"vc", "[", "1", "]"}], ",", 
        RowBox[{"vc", "[", "2", "]"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
      "drag", " ", "force", " ", "on", " ", "the", " ", "cargo", " ", "from", 
       " ", "the", " ", "water"}], "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"(*", 
      RowBox[{"anchor", " ", "forces"}], "*)"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "0", "]"}], ",", 
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "+", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FmTangential", "[", "i", "]"}], "[", "0", "]"}], ",", 
          RowBox[{
           RowBox[{"FmTangential", "[", "i", "]"}], "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"FmTangential", "[", "i", "]"}], "[", "2", "]"}]}], 
         "}"}]}], 
       RowBox[{"(*", 
        RowBox[{"motor", " ", "force", " ", "on", " ", "the", " ", "cargo"}], 
        "*)"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.68582064176493*^9, 3.685820733273151*^9}, {
  3.685908611545021*^9, 3.685908706643835*^9}, {3.685908751043458*^9, 
  3.685908800396866*^9}, {3.68590891563048*^9, 3.6859089572215023`*^9}, {
  3.689528880463039*^9, 3.6895288809239807`*^9}, {3.6895303934081087`*^9, 
  3.689530398413322*^9}, {3.6895380072461033`*^9, 3.6895380342120934`*^9}}],

Cell["\<\
Sum of torques on cargo, also excluding drag forces from anchors in the \
membrane\
\>", "Text",
 CellChangeTimes->{{3.685828120856576*^9, 3.6858281304641237`*^9}, {
  3.694891408288642*^9, 3.6948914123042517`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumTorquesCargoBead", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Tbc", "[", "0", "]"}], ",", 
       RowBox[{"Tbc", "[", "1", "]"}], ",", 
       RowBox[{"Tbc", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"brownian", " ", "torque", " ", "on", " ", "cargo"}], "*)"}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TorqeExt", "[", "0", "]"}], ",", 
       RowBox[{"TorqeExt", "[", "1", "]"}], ",", 
       RowBox[{"TorqeExt", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"external", " ", "torque", " ", "on", " ", "cargo"}], "*)"}], 
     "\[IndentingNewLine]", "-", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"omega", "[", "0", "]"}], ",", 
        RowBox[{"omega", "[", "1", "]"}], ",", 
        RowBox[{"omega", "[", "2", "]"}]}], "}"}], "xiCargoRotation"}], 
     RowBox[{"(*", 
      RowBox[{
      "rotational", " ", "drag", " ", "on", " ", "rotating", " ", "cargo", 
       " ", "from", " ", "water"}], "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
            RowBox[{
             RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
            RowBox[{
             RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"c", "[", "0", "]"}], ",", 
            RowBox[{"c", "[", "1", "]"}], ",", 
            RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"FmTangential", "[", "i", "]"}], "[", "0", "]"}], ",", 
           RowBox[{
            RowBox[{"FmTangential", "[", "i", "]"}], "[", "1", "]"}], ",", 
           RowBox[{
            RowBox[{"FmTangential", "[", "i", "]"}], "[", "2", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685820821629675*^9, 3.6858208555489264`*^9}, {
  3.685909038468484*^9, 3.685909089712001*^9}, {3.68590922797404*^9, 
  3.6859092331715307`*^9}, {3.685909331351536*^9, 3.685909427998534*^9}, {
  3.689528884445437*^9, 3.6895288849063787`*^9}, {3.6895304094949417`*^9, 
  3.6895304117562103`*^9}, {3.689530443897952*^9, 3.6895304862651033`*^9}}],

Cell["\<\
Velocity variables to solve for - note we don\[CloseCurlyQuote]t have anchor \
locations here, we\[CloseCurlyQuote]ll get to those later.\
\>", "Text",
 CellChangeTimes->{{3.685828139160968*^9, 3.685828146022786*^9}, {
  3.694891417220356*^9, 3.694891436367902*^9}}],

Cell[BoxData[
 RowBox[{"velvarsBead", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"vc", "[", "0", "]"}], ",", 
    RowBox[{"vc", "[", "1", "]"}], ",", 
    RowBox[{"vc", "[", "2", "]"}], ",", 
    RowBox[{"omega", "[", "0", "]"}], ",", 
    RowBox[{"omega", "[", "1", "]"}], ",", 
    RowBox[{"omega", "[", "2", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{
  3.685824185302882*^9, {3.689529876494774*^9, 3.689529896788726*^9}}],

Cell["Discretized variables to solve for", "Text",
 CellChangeTimes->{{3.68582814934149*^9, 3.685828156563992*^9}}],

Cell[BoxData[
 RowBox[{"discvarsBead", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], ",", 
    RowBox[{"c1", "[", "1", "]"}], ",", 
    RowBox[{"c1", "[", "2", "]"}], ",", 
    RowBox[{"theta1", "[", "0", "]"}], ",", 
    RowBox[{"theta1", "[", "1", "]"}], ",", 
    RowBox[{"theta1", "[", "2", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.685824128996464*^9, 3.68582413403589*^9}, 
   3.685824187709579*^9, {3.689529915509563*^9, 3.689529928457402*^9}}],

Cell["\<\
Similar to above, solve for the discretized next location and orientation of \
the bead\
\>", "Text",
 CellChangeTimes->{{3.6948914415660048`*^9, 3.6948914589916277`*^9}, {
  3.694891710350071*^9, 3.69489172157689*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsBead", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eqs", ",", "i", ",", "veleqs", ",", "disceqs", ",", "coeff", ",", 
      "coeffinv", ",", "const", ",", "soln"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumForcesCargoBead", "[", "nmotors", "]"}], ",", "eqs"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumTorquesCargoBead", "[", "nmotors", "]"}], ",", "eqs"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"const", ",", "coeff"}], "}"}], "=", 
      RowBox[{"Normal", "@", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"eqs", ",", "velvarsBead"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coeffinv", "=", 
      RowBox[{"Inverse", "[", "coeff", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"veleqs", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"velvarsBead", "\[Equal]", 
        RowBox[{"coeffinv", ".", 
         RowBox[{"-", "const"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"disceqs", "=", 
      RowBox[{"veleqs", "/.", 
       RowBox[{"Join", "[", 
        RowBox[{"discRules", ",", "brownianRules", ",", "xi2muRules"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"soln", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{"disceqs", ",", "discvarsBead"}], "]"}], "//", "First"}], "//",
        "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{"discvarsBead", "==", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"discvarsBead", "/.", "soln"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.685752021873514*^9, 3.68575204526968*^9}, {
   3.68575208770603*^9, 3.6857521842190332`*^9}, {3.685752228757876*^9, 
   3.6857522323234243`*^9}, {3.685752264543935*^9, 3.685752284658534*^9}, {
   3.685752351179758*^9, 3.685752354430645*^9}, {3.685753459086227*^9, 
   3.685753531086829*^9}, {3.685820203075674*^9, 3.685820300949844*^9}, {
   3.685820336995573*^9, 3.685820351371944*^9}, 3.685820517706642*^9, {
   3.685820628818067*^9, 3.685820635541727*^9}, 3.685820677745757*^9, {
   3.685820782413342*^9, 3.6858208161300383`*^9}, {3.6858208774524727`*^9, 
   3.685820881217555*^9}, {3.685820923690524*^9, 3.6858209301028633`*^9}, {
   3.685821247565405*^9, 3.685821259354423*^9}, {3.685822755308692*^9, 
   3.685822811748394*^9}, {3.685824425209546*^9, 3.685824484230485*^9}, {
   3.6858268700985003`*^9, 3.6858268958146467`*^9}, {3.685827246218122*^9, 
   3.685827246250827*^9}, {3.685829704459293*^9, 3.685829752018261*^9}, {
   3.685829836815978*^9, 3.685829838378912*^9}, {3.6895237917653303`*^9, 
   3.689523826707559*^9}, {3.6895258147007217`*^9, 3.689525826231224*^9}, {
   3.689526094815325*^9, 3.689526241276342*^9}, {3.689528232217679*^9, 
   3.689528276598075*^9}, {3.6895283785683193`*^9, 3.6895283871515007`*^9}, {
   3.6895285993733807`*^9, 3.6895286105536633`*^9}, {3.6895286685596313`*^9, 
   3.689528702792007*^9}, {3.689528736464991*^9, 3.6895287426618977`*^9}, {
   3.68952880251305*^9, 3.689528819004177*^9}, {3.689529006732106*^9, 
   3.689529008869536*^9}, {3.689529757684873*^9, 3.689529824103395*^9}, {
   3.689529940281693*^9, 3.6895299946637087`*^9}, {3.6895343210462217`*^9, 
   3.689534321225415*^9}, {3.689537355243432*^9, 3.689537356266573*^9}, 
   3.6895373988035727`*^9}],

Cell["\<\
Now, to take care of the anchors. If there is no rotation, we can just add \
the amount the bead translated.\
\>", "Text",
 CellChangeTimes->{{3.694891728001309*^9, 3.694891756013215*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nextAnchorLocationBead0", "[", "i_", "]"}], ":=", 
  RowBox[{"Thread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a1", "[", "i", "]"}], "[", "0", "]"}], ",", 
      RowBox[{
       RowBox[{"a1", "[", "i", "]"}], "[", "1", "]"}], ",", 
      RowBox[{
       RowBox[{"a1", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "\[Equal]", 
    RowBox[{"(*", 
     RowBox[{"previous", " ", "location"}], "*)"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
       RowBox[{
        RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{"(*", 
      RowBox[{"change", " ", "in", " ", "cargo", " ", "position"}], "*)"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c1", "[", "0", "]"}], ",", 
         RowBox[{"c1", "[", "1", "]"}], ",", 
         RowBox[{"c1", "[", "2", "]"}]}], "}"}], "-", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "[", "0", "]"}], ",", 
         RowBox[{"c", "[", "1", "]"}], ",", 
         RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ")"}]}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.689534538459046*^9, 3.68953457208256*^9}, {
   3.6895346048265944`*^9, 3.6895347355392103`*^9}, {3.6895348209720917`*^9, 
   3.689534865994645*^9}, {3.689534899532662*^9, 3.689534964443421*^9}, {
   3.6895354070744057`*^9, 3.6895354844861803`*^9}, {3.689535520203862*^9, 
   3.689535560354776*^9}, {3.689535606311481*^9, 3.689535656440773*^9}, 
   3.689535705648302*^9, {3.68953574025309*^9, 3.6895357449899607`*^9}, {
   3.68953579721297*^9, 3.689535799101924*^9}, {3.689535842595084*^9, 
   3.689535843663145*^9}, {3.6895359789214993`*^9, 3.689535981565387*^9}, {
   3.691175877066813*^9, 3.6911758873933573`*^9}}],

Cell["\<\
If the bead rotated, we have to do a little more work. In addition to \
translation, we change the anchor locations by rotating them by a rotation \
matrix derived from the thetas we solved for. This means we need to convert \
the axis & angle (thetas) to a rotation matrix. Mathematica can help with \
this:\
\>", "Text",
 CellChangeTimes->{{3.694891760535461*^9, 3.6948919094063663`*^9}}],

Cell["General rotation matrix, simplified for real entries", "Text",
 CellChangeTimes->{{3.694891916561874*^9, 3.6948919401188307`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"\[CapitalOmega]", ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Omega]", "x"], ",", 
       SubscriptBox["\[Omega]", "y"], ",", 
       SubscriptBox["\[Omega]", "z"]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6911665199578867`*^9, 3.691166576216812*^9}, {
   3.691171620530095*^9, 3.691171633034052*^9}, 3.691171703588664*^9, 
   3.691174995025234*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matsimp", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"mat", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Omega]", "x"], ",", 
       SubscriptBox["\[Omega]", "y"], ",", 
       SubscriptBox["\[Omega]", "z"]}], "}"}], "\[Element]", "Reals"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.691166591730487*^9, 3.691166606232193*^9}, {
  3.691166869626656*^9, 3.691166877410488*^9}, {3.691174711446513*^9, 
  3.691174725496584*^9}, {3.691175002945077*^9, 3.691175009007122*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "z", "2"]}], ")"}]}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "x"], " ", 
          SubscriptBox["\[Omega]", "y"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "z"], " ", 
          SqrtBox[
           RowBox[{
            SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
            SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
            SubsuperscriptBox["\[Omega]", "z", "2"]}]]}]}], ")"}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "x"], " ", 
          SubscriptBox["\[Omega]", "z"]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "y"], " ", 
          SqrtBox[
           RowBox[{
            SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
            SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
            SubsuperscriptBox["\[Omega]", "z", "2"]}]]}]}], ")"}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "x"], " ", 
          SubscriptBox["\[Omega]", "y"]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "z"], " ", 
          SqrtBox[
           RowBox[{
            SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
            SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
            SubsuperscriptBox["\[Omega]", "z", "2"]}]]}]}], ")"}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], " ", 
        SubsuperscriptBox["\[Omega]", "x", "2"]}], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], " ", 
        SubsuperscriptBox["\[Omega]", "z", "2"]}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          FractionBox["\[CapitalOmega]", "2"], "]"}], "2"], " ", 
        SubscriptBox["\[Omega]", "y"], " ", 
        SubscriptBox["\[Omega]", "z"]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", "\[CapitalOmega]", "]"}], " ", 
        SubscriptBox["\[Omega]", "x"], " ", 
        SqrtBox[
         RowBox[{
          SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "z", "2"]}]]}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          FractionBox["\[CapitalOmega]", "2"], "]"}], "2"], " ", 
        SubscriptBox["\[Omega]", "x"], " ", 
        SubscriptBox["\[Omega]", "z"]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", "\[CapitalOmega]", "]"}], " ", 
        SubscriptBox["\[Omega]", "y"], " ", 
        SqrtBox[
         RowBox[{
          SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "z", "2"]}]]}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]], ",", 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Sin", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "y"], " ", 
          SubscriptBox["\[Omega]", "z"]}], 
         RowBox[{
          SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "z", "2"]}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "x"]}], 
         SqrtBox[
          RowBox[{
           SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
           SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
           SubsuperscriptBox["\[Omega]", "z", "2"]}]]]}], ")"}]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], " ", 
        SubsuperscriptBox["\[Omega]", "x", "2"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], " ", 
        SubsuperscriptBox["\[Omega]", "y", "2"]}], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.691166613718129*^9, 3.6911668793807898`*^9, {3.691174672871846*^9, 
   3.691174726251483*^9}, {3.691175011053851*^9, 3.691175017429266*^9}, 
   3.691178601871182*^9, 3.691178647851969*^9, 3.691178803142549*^9, {
   3.691178995326764*^9, 3.691179014296371*^9}, 3.694813848216971*^9}]
}, Open  ]],

Cell["Check it corresponds with what we know it should", "Text",
 CellChangeTimes->{{3.6948919462724867`*^9, 3.69489195704993*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"matsimp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Omega]", "x"], "\[Rule]", "0"}], ",", 
      RowBox[{
       SubscriptBox["\[Omega]", "y"], "\[Rule]", "0"}], ",", 
      RowBox[{
       SubscriptBox["\[Omega]", "z"], "\[Rule]", "1"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.691171750728436*^9, 3.691171753730175*^9}, {
  3.691172235587734*^9, 3.69117226437584*^9}, {3.691172514429995*^9, 
  3.691172517215262*^9}, {3.691172625038744*^9, 3.6911726272509003`*^9}, {
  3.691175032003006*^9, 3.691175048787057*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[CapitalOmega]", "]"}]}], "0"},
     {
      RowBox[{"Sin", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6911722648819933`*^9, 3.691172517550068*^9, 3.691172627572398*^9, 
   3.691175050023797*^9, 3.69117860196268*^9, 3.6911786479065104`*^9, 
   3.691178803275221*^9, {3.691178995417976*^9, 3.691179014355851*^9}, 
   3.694813848600498*^9}]
}, Open  ]],

Cell["\<\
Put in the program syntax and simplify it further if possible\
\>", "Text",
 CellChangeTimes->{{3.694891967658678*^9, 3.694892018767449*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"simpnorm", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Omega]", "x"], ",", 
       SubscriptBox["\[Omega]", "y"], ",", 
       SubscriptBox["\[Omega]", "z"]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Omega]", "x"], ",", 
       SubscriptBox["\[Omega]", "y"], ",", 
       SubscriptBox["\[Omega]", "z"]}], "}"}], "\[Element]", "Reals"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.691166964580158*^9, 3.6911670132762012`*^9}, {
  3.6911700903665247`*^9, 3.69117011425034*^9}, {3.6911750818189507`*^9, 
  3.691175085924721*^9}}],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
   SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
   SubsuperscriptBox["\[Omega]", "z", "2"]}]]], "Output",
 CellChangeTimes->{{3.691166996215536*^9, 3.691167013746937*^9}, 
   3.691170115726864*^9, 3.691175087139516*^9, 3.691178602012438*^9, 
   3.691178647953261*^9, 3.6911788033252153`*^9, {3.691178995468719*^9, 
   3.691179014406046*^9}, 3.6948138486501503`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rotmat", "=", 
  RowBox[{
   RowBox[{"matsimp", "/.", 
    RowBox[{"\[CapitalOmega]", "\[Rule]", "simpnorm"}]}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Omega]", "x"], ",", 
       SubscriptBox["\[Omega]", "y"], ",", 
       SubscriptBox["\[Omega]", "z"]}], "}"}], "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"omega", "[", "0", "]"}], ",", 
       RowBox[{"omega", "[", "1", "]"}], ",", 
       RowBox[{"omega", "[", "2", "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.69116688326438*^9, 3.691166895387876*^9}, {
   3.6911670183271313`*^9, 3.691167057870839*^9}, {3.6911671024104147`*^9, 
   3.691167114818067*^9}, {3.691167157118064*^9, 3.691167161302965*^9}, 
   3.691170139360635*^9, {3.6911750962413483`*^9, 3.691175132003231*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}]], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "2", "]"}], "2"]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"omega", "[", "1", "]"}], " ", 
         RowBox[{"omega", "[", "2", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], "2"]}], 
        "-", 
        RowBox[{
         RowBox[{"omega", "[", "0", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"omega", "[", "0", "]"}], " ", 
         RowBox[{"omega", "[", "2", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], "2"]}], 
        "-", 
        RowBox[{
         RowBox[{"omega", "[", "1", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"omega", "[", "0", "]"}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"omega", "[", "1", "]"}], " ", 
          RowBox[{"omega", "[", "2", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "1", "]"}], "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.691166888506033*^9, 3.691167059419135*^9, 3.691167115641041*^9, 
   3.691167174770357*^9, 3.691170141246707*^9, 3.691175097411887*^9, 
   3.691175132829554*^9, 3.691178602056418*^9, 3.691178648000985*^9, 
   3.691178803372175*^9, {3.6911789955224123`*^9, 3.6911790144606733`*^9}, 
   3.6948138486997833`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "rotmat", "]"}]], "Input",
 CellChangeTimes->{{3.691167245690151*^9, 3.69116724979622*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], 
         ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], 
         ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]]},
     {
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], 
         ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "2", "]"}], "2"]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"omega", "[", "1", "]"}], " ", 
         RowBox[{"omega", "[", "2", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], "2"]}], 
        "-", 
        RowBox[{
         RowBox[{"omega", "[", "0", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"omega", "[", "0", "]"}], " ", 
         RowBox[{"omega", "[", "2", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], "2"]}], 
        "-", 
        RowBox[{
         RowBox[{"omega", "[", "1", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}]}], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], ")"}]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "1", "]"}], "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6911672501083508`*^9, 3.6911701489716063`*^9, 3.6911751386194353`*^9, 
   3.691178602125866*^9, 3.691178648071301*^9, 3.69117880343764*^9, {
   3.691178995587976*^9, 3.691179014560678*^9}, 3.69481384878434*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"simprotmat", "=", 
  RowBox[{"FullSimplify", "[", "rotmat", "]"}]}]], "Input",
 CellChangeTimes->{{3.691167178685166*^9, 3.691167216146216*^9}, {
  3.69116725634311*^9, 3.6911672580807257`*^9}, {3.691167322313026*^9, 
  3.691167330816963*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}]], ",", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
           " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "2", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
           RowBox[{"Sin", "[", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}]}], 
         " ", 
         RowBox[{"omega", "[", "0", "]"}], " ", 
         RowBox[{"omega", "[", "2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"omega", "[", "1", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}]}], 
         " ", 
         RowBox[{"omega", "[", "0", "]"}], " ", 
         RowBox[{"omega", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"omega", "[", "2", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}]], ",", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
           " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
           RowBox[{"Sin", "[", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ")"}]}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
           " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
           RowBox[{"Sin", "[", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ")"}]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"omega", "[", "0", "]"}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"omega", "[", "1", "]"}], " ", 
          RowBox[{"omega", "[", "2", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], ")"}]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"]}], ")"}]}], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.691167184645104*^9, 3.691167227138487*^9, 3.691167258627092*^9, 
   3.6911673318286133`*^9, 3.691170154736829*^9, 3.691175147299012*^9, 
   3.691178602790864*^9, 3.6911786488120728`*^9, 3.691178803940333*^9, {
   3.691178996385046*^9, 3.6911790153420258`*^9}, 3.6948138508204603`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "simprotmat", "]"}]], "Input",
 CellChangeTimes->{{3.69117033787586*^9, 3.691170343163741*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
          " ", 
          RowBox[{"omega", "[", "0", "]"}], " ", 
          RowBox[{"omega", "[", "1", "]"}]}], "+", 
         RowBox[{
          RowBox[{"omega", "[", "2", "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
          RowBox[{"Sin", "[", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}]}], 
         " ", 
         RowBox[{"omega", "[", "0", "]"}], " ", 
         RowBox[{"omega", "[", "2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"omega", "[", "1", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}]}], 
         " ", 
         RowBox[{"omega", "[", "0", "]"}], " ", 
         RowBox[{"omega", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"omega", "[", "2", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
          " ", 
          RowBox[{"omega", "[", "1", "]"}], " ", 
          RowBox[{"omega", "[", "2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"omega", "[", "0", "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
          RowBox[{"Sin", "[", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"omega", "[", "2", "]"}], "2"]}]]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
          " ", 
          RowBox[{"omega", "[", "0", "]"}], " ", 
          RowBox[{"omega", "[", "2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"omega", "[", "1", "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
          RowBox[{"Sin", "[", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], 
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}]}], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], ")"}]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"]}], ")"}]}], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6911703434316463`*^9, 3.691175159954604*^9, 3.691178602840336*^9, 
   3.691178648851609*^9, 3.691178804005556*^9, {3.6911789964680643`*^9, 
   3.6911790154218903`*^9}, 3.6948138509333353`*^9}]
}, Open  ]],

Cell["\<\
Now, the next anchor location is given by the change due to the cargo \
translation, plus the change due to cargo rotation. For the rotation, we must \
translate the vector back to (0,0,0), rotate it, then translate it back.\
\>", "Text",
 CellChangeTimes->{{3.694892036598535*^9, 3.694892153778487*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"nextAnchorLocationBead", "[", "i_", "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a1", "[", "i", "]"}], "[", "0", "]"}], ",", 
      RowBox[{
       RowBox[{"a1", "[", "i", "]"}], "[", "1", "]"}], ",", 
      RowBox[{
       RowBox[{"a1", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "\[Equal]", 
    "\[IndentingNewLine]", 
    RowBox[{"Simplify", "[", 
     RowBox[{"(*", 
      RowBox[{"rotation", " ", "of", " ", "cargo"}], "*)"}], 
     RowBox[{
      RowBox[{"simprotmat", " ", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
           RowBox[{
            RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
           RowBox[{
            RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], ",", 
           RowBox[{"c", "[", "1", "]"}], ",", 
           RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ")"}]}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "[", "0", "]"}], ",", 
        RowBox[{"c", "[", "1", "]"}], ",", 
        RowBox[{"c", "[", "2", "]"}]}], "}"}], "+", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"change", " ", "in", " ", "cargo", " ", "position"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c1", "[", "0", "]"}], ",", 
          RowBox[{"c1", "[", "1", "]"}], ",", 
          RowBox[{"c1", "[", "2", "]"}]}], "}"}], "-", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], ",", 
          RowBox[{"c", "[", "1", "]"}], ",", 
          RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ")"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.691168999874055*^9, 3.691169070848284*^9}, {
  3.69116914416628*^9, 3.6911691515445833`*^9}, {3.6911691921467257`*^9, 
  3.6911692011005373`*^9}, {3.691169664532398*^9, 3.691169672193089*^9}, {
  3.691173102296533*^9, 3.691173108428508*^9}, {3.691178788908313*^9, 
  3.6911787936778603`*^9}, {3.6911789266978617`*^9, 3.691178930431992*^9}}],

Cell[CellGroupData[{

Cell["Test rotation matrix version", "Section",
 CellChangeTimes->{{3.691169354100391*^9, 3.691169361940896*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nextAnchorLocationBead", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.691169382208085*^9, 3.691169387231165*^9}, {
  3.691170310460235*^9, 3.6911703222390747`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"c", "[", "0", "]"}]}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"c1", "[", "0", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"c", "[", "1", "]"}], " ", 
        RowBox[{"omega", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"c1", "[", "0", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"c", "[", "2", "]"}], " ", 
        RowBox[{"omega", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "2", "]"}]}], "+", 
       RowBox[{
        RowBox[{"c1", "[", "0", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], " ", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
       RowBox[{
        RowBox[{"omega", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "1", "]"}], " ", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"omega", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "2", "]"}], " ", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], "-", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
        RowBox[{"Sin", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "2", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}]}], "-", 
          RowBox[{
           RowBox[{"c", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "-", 
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"c", "[", "2", "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "-", 
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "-", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "-", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"c1", "[", "1", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"c", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "1", "]"}]}], "-", 
       RowBox[{
        RowBox[{"c", "[", "1", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"c1", "[", "1", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"c", "[", "2", "]"}], " ", 
        RowBox[{"omega", "[", "1", "]"}], " ", 
        RowBox[{"omega", "[", "2", "]"}]}], "+", 
       RowBox[{
        RowBox[{"c1", "[", "1", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"omega", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "1", "]"}], " ", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], " ", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"omega", "[", "1", "]"}], " ", 
        RowBox[{"omega", "[", "2", "]"}], " ", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
        RowBox[{"Sin", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "2", "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}]}], "-", 
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "-", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"c", "[", "2", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "-", 
          RowBox[{
           RowBox[{"c", "[", "1", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "-", 
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"c1", "[", "2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
           " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
           RowBox[{"Sin", "[", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], "-", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], ")"}],
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "[", "1", "]"}], "-", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"]}], ")"}]}], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "[", "2", "]"}], "-", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], ")"}]}]}], ")"}], 
     "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6911693884610443`*^9, 3.6911702047495823`*^9, {3.691170312300336*^9, 
   3.691170322720973*^9}, 3.691178609051744*^9, 3.691178656497231*^9, 
   3.691178845965578*^9, 3.691178936080535*^9, {3.691178996882538*^9, 
   3.691179015810013*^9}, 3.694813851595492*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nextAnchorLocationBead", "[", "0", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"omega", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"omega", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"omega", "[", "2", "]"}], "\[Rule]", "Pi"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c1", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"c1", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c1", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.691169394881568*^9, 3.691169548443801*^9}, {
  3.691169602050109*^9, 3.6911696020830917`*^9}, {3.6911698221663637`*^9, 
  3.691169824573421*^9}, {3.691169955714546*^9, 3.691169989104185*^9}, {
  3.6911702105833197`*^9, 3.69117022993326*^9}, {3.691172922353491*^9, 
  3.691172927369928*^9}, {3.691173128531476*^9, 3.691173151457922*^9}, {
  3.691173191575757*^9, 3.691173270606242*^9}, {3.691175262211203*^9, 
  3.6911752721215143`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", "2"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.691169549636314*^9, 3.69116960371618*^9, 3.6911696898515997`*^9, 
   3.691169825664865*^9, 3.691169956296318*^9, 3.691169989506824*^9, 
   3.691170231394102*^9, 3.691172927921238*^9, {3.691173119981124*^9, 
   3.691173153611908*^9}, {3.69117319265729*^9, 3.691173239086309*^9}, 
   3.6911732713760157`*^9, 3.6911751835701933`*^9, {3.691175263454906*^9, 
   3.691175272947053*^9}, 3.691178609110025*^9, 3.691178656552796*^9, 
   3.691178846015263*^9, 3.691178953709917*^9, {3.691178996938466*^9, 
   3.691179015860837*^9}, 3.6948138516508102`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nextAnchorLocationBead", "[", "0", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"omega", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"omega", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"Pi", "/", "2"}]}], ",", 
    RowBox[{
     RowBox[{"omega", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c1", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"c1", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c1", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.691180918786867*^9, 3.69118093339953*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", "1"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", "1"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.691180924883718*^9, 3.691180933668387*^9}, 
   3.694813851703353*^9}]
}, Open  ]],

Cell["\<\
This is probably the best test we can do here, since this version shouldn\
\[CloseCurlyQuote]t reduce to the stochastic version or anything.\
\>", "Text",
 CellChangeTimes->{{3.69489124468053*^9, 3.694891271679768*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Write Bead File", "Chapter",
 CellChangeTimes->{{3.694813825074492*^9, 3.6948138325662603`*^9}}],

Cell[CellGroupData[{

Cell["Generate solutions for bead", "Section",
 CellChangeTimes->{{3.685990505698781*^9, 3.685990521955017*^9}, {
  3.6895382256191053`*^9, 3.689538227024633*^9}}],

Cell["\<\
Define the maximum number of motors we want to write equations for and \
generate the equations for each number of motors up to that one (including \
0). The equation generation can take a while\
\>", "Text",
 CellChangeTimes->{{3.685990780377955*^9, 3.685990816715549*^9}, {
  3.6859909029347897`*^9, 3.685990919641189*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmaxbead", "=", "101"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iterator", "=", "10"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6948922004554367`*^9, 3.6948922381197433`*^9}}],

Cell[BoxData[
 RowBox[{"Monitor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", "nmaxbead"}], ",", 
      RowBox[{"j", "=", 
       RowBox[{"j", "+", "iterator"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"beadEqs", "[", "j", "]"}], "=", 
        RowBox[{"generateEqsBead", "[", "j", "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], ",", "j"}], "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQAmIwnXtAqKLstaMKV58UiPa31bAB0XfqLMH0KwMnFxCt
F+0Jpj+tX3GBp/a149HPa8F0RPmcQF4g/eFMaQiIXr5fP8IGSCf/fR0Jor1L
p54H0aJPpoHpr7r3Su2A9A6rdWUgOmu66yF7IP3/mxeYfhfs9QRE37nkA6ZL
mUKvOQDppNvhYFrgooFfCpB22isdBKKnpz5qANGnhLc1gmih6XZsqUD65rkD
HCBaSNxAGkSXLJKVAdGbouIVQXSdej6YPtNx0yu24bXjib43YDqu5Xg9iD5w
/jSYFkl4Vx4HpF8ofwHTv37MWgWifZKXgmmO/VMn+7QD7VsyF0yXltgy+ALp
8uc+YFqsTaEcRO/ZdR1Mn3hzxjAfSJ9XugCmldqNphUB6WdX7cH0+zUMs0C0
ho0dmAYAbBLSBw==
  "]],

Cell["Check an element", "Text",
 CellChangeTimes->{{3.6859908229927073`*^9, 3.685990827054187*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"beadEqs", "[", "1", "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.68599067388026*^9, 3.6859907308894253`*^9}, {
  3.689538261495512*^9, 3.689538263092286*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"c", "[", "0", "]"}], "+", 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox["DCargoTranslation"], " ", 
    SqrtBox["dt"], " ", 
    RowBox[{"Dbc", "[", "0", "]"}]}], "+", 
   RowBox[{"dt", " ", "muCargoTranslation", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Fsteric", "[", "0", "]"}], "+", 
      RowBox[{"Ftrap", "[", "0", "]"}], "+", 
      RowBox[{
       RowBox[{"FmRadial", "[", "0", "]"}], "[", "0", "]"}], "+", 
      RowBox[{
       RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.685990679948995*^9, 3.6859907313187447`*^9}, 
   3.6859909978512383`*^9, 3.687122643075014*^9, 3.687123376302928*^9, 
   3.689441800343696*^9, 3.689456898425705*^9, 3.689539056841305*^9, 
   3.6895401139416523`*^9, 3.6895425918370667`*^9, 3.6895450768492947`*^9, 
   3.689545262929785*^9, 3.689547045277054*^9, 3.689547448734997*^9, 
   3.691178609360409*^9, 3.691178656694998*^9, 3.691178846165007*^9, {
   3.69117899710688*^9, 3.691179016842898*^9}, 3.691181002797296*^9, 
   3.691181401160927*^9, 3.6948143971711206`*^9, 3.694816141054824*^9, 
   3.694886585466592*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Write solutions for bead", "Section",
 CellChangeTimes->{{3.685990513731245*^9, 3.685990517882678*^9}, {
  3.689538229285549*^9, 3.689538230219554*^9}}],

Cell["\<\
Create and open a file to write to. If it already exists, delete the old one\
\>", "Text",
 CellChangeTimes->{{3.685989405081962*^9, 3.685989407972825*^9}, {
  3.6859895989977083`*^9, 3.685989632004455*^9}, {3.685989669647953*^9, 
  3.685989671356762*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"DeleteFile", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<beadequations.c\>\""}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outfileLoc", "=", 
   RowBox[{"CreateFile", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<beadequations.c\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outfile", "=", 
   RowBox[{"File", "[", "outfileLoc", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.684098648719748*^9, 3.684098677654524*^9}, 
   3.6840991788294983`*^9, 3.68409921040814*^9, {3.684102465568993*^9, 
   3.684102482037467*^9}, {3.684102558481722*^9, 3.684102578910823*^9}, {
   3.684122712337173*^9, 3.684122713519846*^9}, {3.685825583032132*^9, 
   3.685825584651936*^9}, {3.685850341986755*^9, 3.685850358549972*^9}, {
   3.685989573640522*^9, 3.685989584440605*^9}, {3.6895381551834307`*^9, 
   3.689538159963882*^9}}],

Cell[BoxData[
 TemplateBox[{
  "DeleteFile","fdnfnd",
   "\"Directory or file \
\\!\\(\\*RowBox[{\\\"\\\\\\\"/Users/Matt/project_code/Motor_Freedom/tools/\
beadequations.c\\\\\\\"\\\"}]\\) not found.\"",2,167,6,25543485835099039305,
   "Local"},
  "MessageTemplate"]], "Message", "MSG",
 CellChangeTimes->{3.694889431366705*^9, 3.6948894736301193`*^9, 
  3.694889515486308*^9, 3.694889630580328*^9}],

Cell[BoxData["$Failed"], "Output",
 CellChangeTimes->{3.694889431374312*^9, 3.694889473678337*^9, 
  3.694889515542657*^9, 3.694889630630794*^9}]
}, Open  ]],

Cell["\<\
Write C function beginning lines to the equations for each number of motors \
in a switch case structure\
\>", "Text",
 CellChangeTimes->{{3.6840992130621567`*^9, 3.684099228238578*^9}, {
  3.685825660308721*^9, 3.685825661635256*^9}, {3.685989993825622*^9, 
  3.685990014762042*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<//prototypes\>\"", ",", "\"\<\\n\>\"", ",", 
    "\"\<void bead_equations();\>\"", ",", "\"\<\\n\\n\>\""}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"prototype", " ", "line"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<void bead_equations(){\>\"", ",", "\"\<\\n\>\""}], 
   "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"function", " ", "definition"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<    \>\"", ",", "\"\<switch(total_motors){\>\"", ",", 
    "\"\<\\n\>\""}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"declaration", " ", "of", " ", "switch", " ", "statement"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.684099231380281*^9, 3.684099240084999*^9}, {
  3.6840992762656183`*^9, 3.684099515878077*^9}, {3.6840996083649063`*^9, 
  3.684099671532875*^9}, {3.6840997024259577`*^9, 3.684099710873991*^9}, {
  3.68410043232519*^9, 3.684100434844616*^9}, {3.684100489632914*^9, 
  3.684100491769526*^9}, {3.684102822946341*^9, 3.684102824329294*^9}, {
  3.685388941745635*^9, 3.685388952817151*^9}, {3.685407473277313*^9, 
  3.685407474546224*^9}, {3.685825623847027*^9, 3.685825633602104*^9}, {
  3.685846086266388*^9, 3.68584610380118*^9}, {3.685989831493289*^9, 
  3.685989868850224*^9}, {3.689538198416264*^9, 3.689538205548904*^9}}],

Cell["Write out equations for each number of motors up to some max", "Text",
 CellChangeTimes->{{3.685989691236011*^9, 3.6859897102478848`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "for", " ", "all", " ", "numbers", " ", "of", " ", "motors", " ", "up", 
    " ", "to", " ", "nmax"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", "nmaxbead"}], ",", 
      RowBox[{"j", "=", 
       RowBox[{"j", "+", "iterator"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "write", " ", "a", " ", "line", " ", "for", " ", "the", " ", "case", 
        " ", "of", " ", "j", " ", "motors"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<        \>\"", ",", "\"\<case \>\"", ",", "j", 
         ",", "\"\<:\>\"", ",", "\"\<\\n\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "for", " ", "each", " ", "of", " ", "the", " ", "equations", " ", 
          "in", " ", "the", " ", "solution"}], ",", " ", 
         RowBox[{
          RowBox[{"convert", " ", "it", " ", "to", " ", "c"}], "-", 
          RowBox[{
          "ish", " ", "form", " ", "and", " ", "write", " ", "it", " ", "out",
            " ", "to", " ", "the", " ", "file"}]}]}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "first", " ", "the", " ", "equations", " ", "for", " ", "the", " ", 
         "center", " ", "and", " ", "theta"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "6"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"WriteString", "[", 
          RowBox[{"outfile", ",", "\"\<            \>\"", ",", 
           RowBox[{"CForm", "[", 
            RowBox[{
             RowBox[{"beadEqs", "[", "j", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
           "\"\<\\n\\n\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"then", " ", "for", " ", "the", " ", "anchor"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", 
         "\"\<omega[0] = theta1[0]-theta[0]\>\"", ",", "\"\<;\>\"", ",", 
         "\"\<\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", 
         "\"\<omega[1] = theta1[1]-theta[1]\>\"", ",", "\"\<;\>\"", ",", 
         "\"\<\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", 
         "\"\<omega[2] = theta1[2]-theta[2]\>\"", ",", "\"\<;\>\"", ",", 
         "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", 
         "\"\<if(sqrt(omega[0]*omega[0] + omega[1]*omega[1] + \
omega[2]*omega[2])<1E-12){\>\"", ",", "\"\<\\n\\n\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", " ", "j"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<                \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"nextAnchorLocationBead0", "[", "i", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<                \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"nextAnchorLocationBead0", "[", "i", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<                \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"nextAnchorLocationBead0", "[", "i", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", "\"\<}else{\>\"", ",", 
         "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", " ", "j"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<                \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"nextAnchorLocationBead", "[", "i", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<                \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"nextAnchorLocationBead", "[", "i", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<                \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"nextAnchorLocationBead", "[", "i", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", "\"\<}\>\"", ",", 
         "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "write", " ", "a", " ", "break", " ", "at", " ", "the", " ", "end", 
         " ", "of", " ", "the", " ", "case"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", "\"\<break;\>\"", ",", 
         "\"\<\\n\\n\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ",", "j"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.684098684247036*^9, 3.684098766686006*^9}, {
   3.684098856697693*^9, 3.684098878004724*^9}, {3.684099061289969*^9, 
   3.6840991277763557`*^9}, 3.6840991935196753`*^9, {3.684099519804295*^9, 
   3.684099541348055*^9}, {3.6840997343083973`*^9, 3.684099816432733*^9}, {
   3.684100169619607*^9, 3.6841001736468277`*^9}, {3.684100402884281*^9, 
   3.684100411512261*^9}, {3.6841005086000032`*^9, 3.684100540493479*^9}, {
   3.68410061534379*^9, 3.684100657686246*^9}, {3.684100711764319*^9, 
   3.684100715138089*^9}, {3.685310680916917*^9, 3.685310683885453*^9}, {
   3.6853114763699017`*^9, 3.685311479619326*^9}, {3.685407221763399*^9, 
   3.685407221799777*^9}, {3.685465676220456*^9, 3.685465676259206*^9}, {
   3.6854659373040123`*^9, 3.685465953817956*^9}, {3.6854685904634333`*^9, 
   3.68546859084135*^9}, {3.685468806323731*^9, 3.6854688063796387`*^9}, {
   3.685471190990142*^9, 3.685471191024145*^9}, {3.6858090438046227`*^9, 
   3.685809117375259*^9}, {3.685809192345202*^9, 3.685809227111394*^9}, {
   3.685809340496956*^9, 3.685809353218791*^9}, {3.685809387948227*^9, 
   3.685809391389855*^9}, {3.685809431936461*^9, 3.685809437741338*^9}, {
   3.685809615973763*^9, 3.6858096344905577`*^9}, {3.68580970844851*^9, 
   3.685809710641583*^9}, {3.6858098008331947`*^9, 3.6858098265387697`*^9}, {
   3.685825718954495*^9, 3.6858257450769653`*^9}, {3.685826976061697*^9, 
   3.685826976116604*^9}, {3.685989715424526*^9, 3.685989807156097*^9}, {
   3.6859898931505423`*^9, 3.685989980304138*^9}, {3.6859901054725103`*^9, 
   3.685990105549755*^9}, {3.685990261700066*^9, 3.685990273579719*^9}, {
   3.685990308897138*^9, 3.685990378237952*^9}, {3.6859904640868073`*^9, 
   3.685990466865103*^9}, {3.6859906369764147`*^9, 3.6859906690155983`*^9}, {
   3.685990742219083*^9, 3.685990772099668*^9}, {3.689460999388219*^9, 
   3.6894609994202967`*^9}, {3.689523539530192*^9, 3.689523541138032*^9}, {
   3.689538283062244*^9, 3.689538314257856*^9}, {3.689538400457271*^9, 
   3.689538427760085*^9}, 3.689538478552753*^9, {3.6895385186363363`*^9, 
   3.689538562870904*^9}, {3.68953877016282*^9, 3.6895389224447317`*^9}, {
   3.689544971454884*^9, 3.689544975492734*^9}, {3.6896237403112917`*^9, 
   3.689623746329125*^9}, {3.691179046533091*^9, 3.691179065679762*^9}, {
   3.691179277652215*^9, 3.691179332337575*^9}, {3.6911798122175083`*^9, 
   3.691179865305491*^9}, {3.691179938037023*^9, 3.691180084410191*^9}, {
   3.6911811062690077`*^9, 3.6911811171129007`*^9}, {3.694885421019146*^9, 
   3.69488544104211*^9}, {3.6948860807267942`*^9, 3.6948861251295643`*^9}, 
   3.694886635823718*^9, {3.6948894057527647`*^9, 3.694889416315817*^9}, {
   3.694889468404161*^9, 3.694889468582849*^9}, {3.694889512215295*^9, 
   3.6948895123557463`*^9}, {3.69488962719713*^9, 3.694889627263637*^9}, {
   3.694892191145398*^9, 3.694892191997386*^9}, {3.694892253771701*^9, 
   3.694892256177758*^9}}],

Cell["Finish case structure and function", "Text",
 CellChangeTimes->{{3.685990028971142*^9, 3.6859900437981052`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<        \>\"", ",", "\"\<default:\>\"", ",", 
    "\"\<\\n\>\"", ",", "\"\<            \>\"", ",", 
    "\"\<printf(\\\"Bad value for total_motors\\\\n\\\");\>\"", ",", 
    "\"\<\\n\>\""}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "write", " ", "default", " ", "case", " ", "with", " ", "error", " ", 
    "statement"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"WriteString", "[", 
  RowBox[{
  "outfile", ",", "\"\<            \>\"", ",", "\"\<exit(0);\>\"", ",", 
   "\"\<\\n\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"outfile", ",", "\"\<    }\\n\>\"", ",", "\"\<}\\n\>\""}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "write", " ", "the", " ", "bracket", " ", "to", " ", "end", " ", "the", 
    " ", "function"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.684099840640665*^9, 3.684099931812181*^9}, {
  3.6840999744158993`*^9, 3.68409998222359*^9}, {3.684100043368163*^9, 
  3.684100084620983*^9}, {3.6841001168977137`*^9, 3.684100160693183*^9}, {
  3.684100202273947*^9, 3.6841002029258747`*^9}, {3.684100279347612*^9, 
  3.684100298168747*^9}, {3.684100370877803*^9, 3.6841003714731607`*^9}, {
  3.684100419881982*^9, 3.6841004213560467`*^9}, {3.684100523328725*^9, 
  3.684100531020879*^9}, {3.684100563084326*^9, 3.684100566716979*^9}, {
  3.685416480599662*^9, 3.685416481870009*^9}, {3.6859900521466017`*^9, 
  3.685990087909483*^9}, {3.689443929058951*^9, 3.6894439521319942`*^9}}],

Cell["Finally, close the file", "Text",
 CellChangeTimes->{{3.6859900917003107`*^9, 3.685990094411708*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Close", "[", "outfile", "]"}]], "Input"],

Cell[BoxData["\<\"/Users/Matt/project_code/Motor_Freedom/tools/beadequations.\
c\"\>"], "Output",
 CellChangeTimes->{{3.684100300257049*^9, 3.6841003123613777`*^9}, 
   3.684100438657907*^9, 3.684100553368664*^9, 3.6841005843912697`*^9, 
   3.684100673530526*^9, {3.684100722534998*^9, 3.684100732493864*^9}, 
   3.684102391742468*^9, 3.684102594087244*^9, 3.6841028306272573`*^9, 
   3.684121002174754*^9, 3.684122725655195*^9, 3.684123019930887*^9, 
   3.6841233523696623`*^9, 3.685310548666443*^9, {3.685310618702059*^9, 
   3.6853106288145733`*^9}, 3.68531069968434*^9, {3.685310957682103*^9, 
   3.685310969501884*^9}, 3.685311255730791*^9, 3.685311402237832*^9, 
   3.6853115071808147`*^9, 3.685312010253036*^9, 3.685312841126239*^9, {
   3.685312985680805*^9, 3.6853130014500933`*^9}, 3.685314857065839*^9, 
   3.685316608044868*^9, 3.6853218660793743`*^9, 3.685389151945215*^9, 
   3.685407229598117*^9, 3.685407515813778*^9, 3.685416503740095*^9, {
   3.6854656908324947`*^9, 3.685465700600263*^9}, 3.685466038857834*^9, 
   3.685468637688806*^9, {3.685468811556815*^9, 3.6854688194929333`*^9}, 
   3.6854712321194677`*^9, 3.685809145536249*^9, 3.68580927994246*^9, 
   3.6858093874017143`*^9, 3.685809471968864*^9, 3.685809749058251*^9, 
   3.685825770949732*^9, 3.6858269969894533`*^9, 3.685827299476267*^9, 
   3.685829988554552*^9, 3.685830042478118*^9, 3.685846229066922*^9, 
   3.685893310046109*^9, 3.685893370932152*^9, {3.685893963828843*^9, 
   3.6858939863996572`*^9}, 3.68589432124051*^9, 3.685894669222761*^9, 
   3.685895064162703*^9, 3.685895219296137*^9, 3.685896097772681*^9, 
   3.685909484995805*^9, 3.685909759388433*^9, 3.6859901587780323`*^9, 
   3.6859908424946938`*^9, 3.685990997927788*^9, 3.687122643313582*^9, 
   3.6871233764811697`*^9, 3.689441800639526*^9, 3.6894568993827457`*^9, 
   3.6895390726475277`*^9, 3.689540117563945*^9, 3.689542595965947*^9, 
   3.689545080354351*^9, 3.689545263719652*^9, 3.689547048551601*^9, 
   3.689547449127163*^9, 3.689623756082953*^9, 3.691178609608861*^9, 
   3.691178656822648*^9, 3.691178846254046*^9, {3.691178997490048*^9, 
   3.691179017289966*^9}, 3.691179074270817*^9, 3.691179877844925*^9, {
   3.6911800643310013`*^9, 3.691180089823759*^9}, 3.6911810191012707`*^9, 
   3.691181404765334*^9, 3.6948144978974323`*^9, 3.6948168370422277`*^9, 
   3.694886973544084*^9, 3.694889434097623*^9, 3.6948894885805273`*^9, 
   3.6948895974879913`*^9, 3.694890299484033*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{969, 1018},
WindowMargins->{{Automatic, 568}, {Automatic, 61}},
FrontEndVersion->"11.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (September \
21, 2016)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 162, 2, 92, "Title"],
Cell[745, 26, 961, 15, 144, "Text"],
Cell[CellGroupData[{
Cell[1731, 45, 170, 2, 65, "Chapter"],
Cell[CellGroupData[{
Cell[1926, 51, 217, 3, 64, "Section"],
Cell[2146, 56, 444, 9, 87, "Text"],
Cell[2593, 67, 107, 1, 30, "Text"],
Cell[2703, 70, 3428, 87, 201, "Input"],
Cell[6134, 159, 103, 1, 30, "Text"],
Cell[6240, 162, 4834, 121, 243, "Input"],
Cell[11077, 285, 107, 1, 30, "Text"],
Cell[11187, 288, 5123, 131, 243, "Input"],
Cell[16313, 421, 113, 1, 30, "Text"],
Cell[16429, 424, 978, 28, 75, "Input"],
Cell[17410, 454, 115, 1, 30, "Text"],
Cell[17528, 457, 1031, 29, 75, "Input"],
Cell[18562, 488, 139, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[18726, 493, 1369, 36, 54, "Input"],
Cell[20098, 531, 1408, 33, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21543, 569, 1834, 47, 75, "Input"],
Cell[23380, 618, 1748, 44, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[25165, 667, 438, 11, 54, "Input"],
Cell[25606, 680, 688, 15, 47, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[26343, 701, 117, 1, 64, "Section"],
Cell[26463, 704, 685, 10, 68, "Text"],
Cell[27151, 716, 318, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[27494, 726, 1363, 35, 159, "Input"],
Cell[28860, 763, 2569, 58, 117, "Output"]
}, Open  ]],
Cell[31444, 824, 286, 6, 49, "Text"],
Cell[CellGroupData[{
Cell[31755, 834, 378, 7, 54, "Input"],
Cell[32136, 843, 1252, 18, 32, "Output"],
Cell[33391, 863, 1274, 19, 32, "Output"]
}, Open  ]],
Cell[34680, 885, 212, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[34917, 893, 136, 2, 32, "Input"],
Cell[35056, 897, 604, 13, 32, "Output"]
}, Open  ]],
Cell[35675, 913, 484, 10, 87, "Text"],
Cell[CellGroupData[{
Cell[36184, 927, 890, 23, 75, "Input"],
Cell[37077, 952, 2383, 55, 124, "Output"]
}, Open  ]],
Cell[39475, 1010, 1793, 45, 152, "Text"],
Cell[CellGroupData[{
Cell[41293, 1059, 379, 8, 32, "Input"],
Cell[41675, 1069, 4408, 121, 342, "Output"]
}, Open  ]],
Cell[46098, 1193, 271, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[46394, 1202, 133, 2, 32, "Input"],
Cell[46530, 1206, 607, 13, 32, "Output"]
}, Open  ]],
Cell[47152, 1222, 119, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[47296, 1227, 566, 12, 32, "Input"],
Cell[47865, 1241, 3579, 92, 180, "Output"]
}, Open  ]],
Cell[51459, 1336, 124, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[51608, 1341, 305, 8, 32, "Input"],
Cell[51916, 1351, 3502, 91, 180, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[55467, 1448, 227, 3, 64, "Section"],
Cell[55697, 1453, 162, 3, 30, "Text"],
Cell[55862, 1458, 3665, 83, 306, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59564, 1546, 161, 2, 64, "Section"],
Cell[59728, 1550, 256, 5, 49, "Text"],
Cell[CellGroupData[{
Cell[60009, 1559, 543, 15, 32, "Input"],
Cell[60555, 1576, 568, 15, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61160, 1596, 703, 20, 32, "Input"],
Cell[61866, 1618, 812, 21, 32, "Output"]
}, Open  ]],
Cell[62693, 1642, 164, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[62882, 1648, 1167, 18, 32, "Input"],
Cell[64052, 1668, 2889, 65, 117, "Output"]
}, Open  ]],
Cell[66956, 1736, 209, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[67190, 1744, 541, 10, 32, "Input"],
Cell[67734, 1756, 1458, 39, 54, "Output"]
}, Open  ]],
Cell[69207, 1798, 148, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[69380, 1804, 1037, 25, 75, "Input"],
Cell[70420, 1831, 2421, 69, 75, "Output"]
}, Open  ]],
Cell[72856, 1903, 477, 8, 30, "Text"],
Cell[CellGroupData[{
Cell[73358, 1915, 1069, 27, 75, "Input"],
Cell[74430, 1944, 2337, 65, 96, "Output"]
}, Open  ]],
Cell[76782, 2012, 267, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[77074, 2021, 1016, 26, 75, "Input"],
Cell[78093, 2049, 1668, 45, 75, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[79810, 2100, 117, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[79952, 2105, 291, 4, 32, "Input"],
Cell[80246, 2111, 3362, 89, 180, "Output"]
}, Open  ]],
Cell[83623, 2203, 452, 10, 34, "Text"],
Cell[CellGroupData[{
Cell[84100, 2217, 483, 11, 32, "Input"],
Cell[84586, 2230, 1864, 48, 97, "Output"]
}, Open  ]],
Cell[86465, 2281, 510, 8, 49, "Text"],
Cell[CellGroupData[{
Cell[87000, 2293, 470, 12, 32, "Input"],
Cell[87473, 2307, 2192, 64, 98, "Output"]
}, Open  ]],
Cell[89680, 2374, 158, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[89863, 2381, 507, 14, 32, "Input"],
Cell[90373, 2397, 2537, 76, 151, "Output"]
}, Open  ]],
Cell[92925, 2476, 151, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[93101, 2483, 509, 14, 32, "Input"],
Cell[93613, 2499, 4116, 123, 180, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[97790, 2629, 105, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[97920, 2634, 103, 1, 64, "Section"],
Cell[98026, 2637, 335, 6, 49, "Text"],
Cell[98364, 2645, 784, 18, 96, "Input"],
Cell[99151, 2665, 100, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[99276, 2670, 184, 4, 32, "Input"],
Cell[99463, 2676, 5892, 159, 249, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[105404, 2841, 100, 1, 64, "Section"],
Cell[105507, 2844, 266, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[105798, 2853, 900, 19, 75, "Input"],
Cell[106701, 2874, 429, 9, 24, "Message"],
Cell[107133, 2885, 169, 2, 32, "Output"]
}, Open  ]],
Cell[107317, 2890, 294, 6, 30, "Text"],
Cell[107614, 2898, 1430, 31, 96, "Input"],
Cell[109047, 2931, 144, 1, 30, "Text"],
Cell[109194, 2934, 5719, 118, 327, "Input"],
Cell[114916, 3054, 118, 1, 30, "Text"],
Cell[115037, 3057, 1534, 31, 117, "Input"],
Cell[116574, 3090, 107, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[116706, 3095, 64, 1, 32, "Input"],
Cell[116773, 3098, 1852, 26, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[118686, 3131, 153, 2, 65, "Chapter"],
Cell[118842, 3135, 512, 8, 68, "Text"],
Cell[119357, 3145, 216, 4, 30, "Text"],
Cell[119576, 3151, 3036, 75, 201, "Input"],
Cell[122615, 3228, 225, 5, 30, "Text"],
Cell[122843, 3235, 2728, 69, 117, "Input"],
Cell[125574, 3306, 276, 5, 30, "Text"],
Cell[125853, 3313, 433, 11, 32, "Input"],
Cell[126289, 3326, 115, 1, 30, "Text"],
Cell[126407, 3329, 483, 11, 32, "Input"],
Cell[126893, 3342, 229, 5, 30, "Text"],
Cell[127125, 3349, 3738, 76, 243, "Input"],
Cell[130866, 3427, 198, 4, 30, "Text"],
Cell[131067, 3433, 1975, 48, 75, "Input"],
Cell[133045, 3483, 400, 7, 68, "Text"],
Cell[133448, 3492, 136, 1, 30, "Text"],
Cell[133587, 3495, 481, 12, 35, "Input"],
Cell[CellGroupData[{
Cell[134093, 3511, 533, 13, 35, "Input"],
Cell[134629, 3526, 7374, 190, 328, "Output"]
}, Open  ]],
Cell[142018, 3719, 131, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[142174, 3724, 651, 16, 35, "Input"],
Cell[142828, 3742, 1092, 28, 76, "Output"]
}, Open  ]],
Cell[143935, 3773, 151, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[144111, 3780, 689, 19, 35, "Input"],
Cell[144803, 3801, 452, 9, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145292, 3815, 849, 20, 35, "Input"],
Cell[146144, 3837, 15943, 447, 746, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[162124, 4289, 133, 2, 32, "Input"],
Cell[162260, 4293, 15899, 440, 146, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[178196, 4738, 267, 5, 32, "Input"],
Cell[178466, 4745, 13937, 395, 702, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[192440, 5145, 137, 2, 32, "Input"],
Cell[192580, 5149, 13810, 386, 148, "Output"]
}, Open  ]],
Cell[206405, 5538, 314, 5, 49, "Text"],
Cell[206722, 5545, 2250, 58, 96, "Input"],
Cell[CellGroupData[{
Cell[208997, 5607, 113, 1, 64, "Section"],
Cell[CellGroupData[{
Cell[209135, 5612, 192, 3, 32, "Input"],
Cell[209330, 5617, 15630, 431, 637, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[224997, 6053, 1561, 38, 54, "Input"],
Cell[226561, 6093, 936, 21, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[227534, 6119, 1193, 33, 54, "Input"],
Cell[228730, 6154, 457, 14, 32, "Output"]
}, Open  ]],
Cell[229202, 6171, 229, 4, 30, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[229480, 6181, 102, 1, 65, "Chapter"],
Cell[CellGroupData[{
Cell[229607, 6186, 163, 2, 64, "Section"],
Cell[229773, 6190, 335, 6, 49, "Text"],
Cell[230111, 6198, 224, 5, 54, "Input"],
Cell[230338, 6205, 991, 24, 75, "Input"],
Cell[231332, 6231, 100, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[231457, 6236, 227, 5, 32, "Input"],
Cell[231687, 6243, 1229, 28, 61, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[232965, 6277, 158, 2, 64, "Section"],
Cell[233126, 6281, 266, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[233417, 6290, 939, 20, 75, "Input"],
Cell[234359, 6312, 399, 9, 24, "Message"],
Cell[234761, 6323, 145, 2, 32, "Output"]
}, Open  ]],
Cell[234921, 6328, 294, 6, 30, "Text"],
Cell[235218, 6336, 1463, 31, 96, "Input"],
Cell[236684, 6369, 144, 1, 30, "Text"],
Cell[236831, 6372, 9878, 191, 684, "Input"],
Cell[246712, 6565, 118, 1, 30, "Text"],
Cell[246833, 6568, 1534, 31, 117, "Input"],
Cell[248370, 6601, 107, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[248502, 6606, 64, 1, 32, "Input"],
Cell[248569, 6609, 2446, 34, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

