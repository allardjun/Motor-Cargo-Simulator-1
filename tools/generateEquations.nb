(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.4' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    288132,       7327]
NotebookOptionsPosition[    269304,       7030]
NotebookOutlinePosition[    269657,       7046]
CellTagsIndexPosition[    269614,       7043]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Equations for Euler-Maruyama", "Title",
 CellChangeTimes->{{3.670201171182211*^9, 3.670201183646469*^9}, {
  3.685990992169792*^9, 
  3.6859909956345043`*^9}},ExpressionUUID->"c48312f1-7150-4f67-b001-\
2f86a03d886e"],

Cell["\<\
This notebook generates a system of equations, solves it, then writes the \
resulting solved equations to a file in c-ish syntax. When the bash script \
CformToC.sh is then run on the written file, the result should be a c file \
which encodes the equations for the next value of the locations of the \
anchors of each motor, as well as the cargo.

The first section goes through the calculation in detail. Following that is a \
function which performs all the steps for a certain number of attached \
motors. Finally, there is code which loops over numbers of attached motors up \
from 1 to however many are desired and writes as close as possible to a c \
function which will return the next location given the previous one.\
\>", "Text",
 CellChangeTimes->{{3.684120504191019*^9, 3.684120894327046*^9}, {
  3.68412289746591*^9, 3.684122903544365*^9}, {3.6841232064572563`*^9, 
  3.684123224352906*^9}, {3.685985561274387*^9, 
  3.685985561994651*^9}},ExpressionUUID->"097bc474-593c-456b-adfc-\
fd52c51b4956"],

Cell[CellGroupData[{

Cell["Write full equations, solve and test", "Chapter",
 CellChangeTimes->{{3.685987506921569*^9, 3.685987525326046*^9}, {
  3.689633623242589*^9, 
  3.689633629519298*^9}},ExpressionUUID->"ba482971-6389-4f95-a083-\
a88b62cfaeb3"],

Cell[CellGroupData[{

Cell["Equations for stochastic version", "Section",
 CellChangeTimes->{{3.685751990239071*^9, 3.685751996342305*^9}, {
  3.685753440849455*^9, 3.6857534544499607`*^9}, {3.685825822014893*^9, 
  3.685825847698616*^9}},ExpressionUUID->"51f63eb8-6abb-4bbc-97fd-\
600807964568"],

Cell["\<\
First, list out the force balance equations we\[CloseCurlyQuote]ll use to \
eventually get to our numerical result.

We want to generate the system of equations for the time evolution of the \
locations of the motor anchors and the cargo center. Derivation of equations \
is detailed in the documentation.\
\>", "Text",
 CellChangeTimes->{{3.685985469936562*^9, 3.685985522000815*^9}, {
  3.685985579387431*^9, 
  3.685985589680482*^9}},ExpressionUUID->"06ea877b-ee3b-4efa-ad09-\
3a9a3c56ba35"],

Cell["Sum of forces on anchor i", "Text",
 CellChangeTimes->{{3.685828096051152*^9, 
  3.685828107795451*^9}},ExpressionUUID->"1a2860fe-df78-4eaa-a5f9-\
ae80ceb6d13f"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumForcesAnchorStocahstic", "[", "i_", "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Fba", "[", "i", "]"}], "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"Fba", "[", "i", "]"}], "[", "1", "]"}], ",", 
       RowBox[{
        RowBox[{"Fba", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"brownian", " ", "force", " ", "on", " ", "anchor"}], "*)"}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"FmTangential", "[", "i", "]"}], "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"FmTangential", "[", "i", "]"}], "[", "1", "]"}], ",", 
       RowBox[{
        RowBox[{"FmTangential", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{
      "motor", " ", "force", " ", "that", " ", "pulls", " ", "on", " ", "the",
        " ", "anchor"}], "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"(*", 
      RowBox[{"drag", " ", "forces"}], "*)"}], 
     RowBox[{
      RowBox[{"xiAnchor", "[", "i", "]"}], " ", 
      RowBox[{"(", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"vc", "[", "0", "]"}], ",", 
          RowBox[{"vc", "[", "1", "]"}], ",", 
          RowBox[{"vc", "[", "2", "]"}]}], "}"}], 
        RowBox[{"(*", 
         RowBox[{
         "movement", " ", "of", " ", "the", " ", "cargo", " ", "drags", " ", 
          "the", " ", "anchor"}], "*)"}], "\[IndentingNewLine]", "+", 
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"omega", "[", "0", "]"}], ",", 
            RowBox[{"omega", "[", "1", "]"}], ",", 
            RowBox[{"omega", "[", "2", "]"}]}], "}"}], ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "[", "0", "]"}], ",", 
             RowBox[{"c", "[", "1", "]"}], ",", 
             RowBox[{"c", "[", "2", "]"}]}], "}"}]}]}], "]"}], 
        RowBox[{"(*", 
         RowBox[{
         "rotation", " ", "of", " ", "the", " ", "cargo", " ", "drags", " ", 
          "the", " ", "anchor"}], "*)"}], "\[IndentingNewLine]", "-", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"va", "[", "i", "]"}], "[", "0", "]"}], ",", 
          RowBox[{
           RowBox[{"va", "[", "i", "]"}], "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"va", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}], 
       RowBox[{"(*", 
        RowBox[{
        "drag", " ", "on", " ", "the", " ", "anchor", " ", "due", " ", "to", 
         " ", "moving", " ", "in", " ", "the", " ", "membrane"}], "*)"}], 
       ")"}]}]}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.685820474680799*^9, 3.685820518861616*^9}, 
   3.685820611042869*^9, {3.685908295773295*^9, 3.685908395252804*^9}, {
   3.685908441973132*^9, 3.68590858524286*^9}, {3.685909175797319*^9, 
   3.685909186067964*^9}},
 CellLabel->"In[36]:=",ExpressionUUID->"682925a0-1d56-498b-be07-17b57e3a563a"],

Cell["Sum of forces on cargo", "Text",
 CellChangeTimes->{{3.685828111406816*^9, 
  3.68582811720042*^9}},ExpressionUUID->"2069f52b-5a5f-44a0-98fc-\
524b5a3a8ed5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumForcesCargoStochastic", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Thread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fbc", "[", "0", "]"}], ",", 
       RowBox[{"Fbc", "[", "1", "]"}], ",", 
       RowBox[{"Fbc", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"brownian", " ", "force", " ", "on", " ", "the", " ", "cargo"}],
       "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ftrap", "[", "0", "]"}], ",", 
       RowBox[{"Ftrap", "[", "1", "]"}], ",", 
       RowBox[{"Ftrap", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"external", " ", "force", " ", "on", " ", "the", " ", "cargo"}],
       "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fsteric", "[", "0", "]"}], ",", 
       RowBox[{"Fsteric", "[", "1", "]"}], ",", 
       RowBox[{"Fsteric", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"steric", " ", "force", " ", "on", " ", "the", " ", "cargo"}], 
      "*)"}], "\[IndentingNewLine]", "-", 
     RowBox[{"xiCargoTranslation", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vc", "[", "0", "]"}], ",", 
        RowBox[{"vc", "[", "1", "]"}], ",", 
        RowBox[{"vc", "[", "2", "]"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
      "drag", " ", "force", " ", "on", " ", "the", " ", "cargo", " ", "from", 
       " ", "the", " ", "water"}], "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"(*", 
      RowBox[{"anchor", " ", "forces"}], "*)"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "0", "]"}], ",", 
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
        RowBox[{"(*", 
         RowBox[{"motor", " ", "force", " ", "on", " ", "the", " ", "cargo"}],
          "*)"}], "\[IndentingNewLine]", "-", 
        RowBox[{"(*", 
         RowBox[{
         "reaction", " ", "pairs", " ", "to", " ", "anchor", " ", "forces"}], 
         "*)"}], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Fba", "[", "i", "]"}], "[", "0", "]"}], ",", 
            RowBox[{
             RowBox[{"Fba", "[", "i", "]"}], "[", "1", "]"}], ",", 
            RowBox[{
             RowBox[{"Fba", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
          RowBox[{"(*", 
           RowBox[{"brownian", " ", "force", " ", "on", " ", "anchor"}], 
           "*)"}], "\[IndentingNewLine]", "+", 
          RowBox[{
           RowBox[{"xiAnchor", "[", "i", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"vc", "[", "0", "]"}], ",", 
               RowBox[{"vc", "[", "1", "]"}], ",", 
               RowBox[{"vc", "[", "2", "]"}]}], "}"}], "+", 
             RowBox[{"Cross", "[", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"omega", "[", "0", "]"}], ",", 
                 RowBox[{"omega", "[", "1", "]"}], ",", 
                 RowBox[{"omega", "[", "2", "]"}]}], "}"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
                  RowBox[{
                   RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
                  RowBox[{
                   RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
                "-", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"c", "[", "0", "]"}], ",", 
                  RowBox[{"c", "[", "1", "]"}], ",", 
                  RowBox[{"c", "[", "2", "]"}]}], "}"}]}]}], "]"}], "-", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{
                RowBox[{"va", "[", "i", "]"}], "[", "0", "]"}], ",", 
               RowBox[{
                RowBox[{"va", "[", "i", "]"}], "[", "1", "]"}], ",", 
               RowBox[{
                RowBox[{"va", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}], 
            ")"}]}]}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.68582064176493*^9, 3.685820733273151*^9}, {
  3.685908611545021*^9, 3.685908706643835*^9}, {3.685908751043458*^9, 
  3.685908800396866*^9}, {3.68590891563048*^9, 3.6859089572215023`*^9}},
 CellLabel->"In[37]:=",ExpressionUUID->"7654dee9-cced-4ac5-892d-0fc433eb0820"],

Cell["Sum of torques on cargo", "Text",
 CellChangeTimes->{{3.685828120856576*^9, 
  3.6858281304641237`*^9}},ExpressionUUID->"fb3463b3-b080-47f8-939d-\
dfe8778f6a2b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumTorquesCargoStochastic", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Tbc", "[", "0", "]"}], ",", 
       RowBox[{"Tbc", "[", "1", "]"}], ",", 
       RowBox[{"Tbc", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"brwonian", " ", "torque", " ", "on", " ", "cargo"}], "*)"}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TorqeExt", "[", "0", "]"}], ",", 
       RowBox[{"TorqeExt", "[", "1", "]"}], ",", 
       RowBox[{"TorqeExt", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"external", " ", "torque", " ", "on", " ", "cargo"}], "*)"}], 
     "\[IndentingNewLine]", "-", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"omega", "[", "0", "]"}], ",", 
        RowBox[{"omega", "[", "1", "]"}], ",", 
        RowBox[{"omega", "[", "2", "]"}]}], "}"}], "xiCargoRotation"}], 
     RowBox[{"(*", 
      RowBox[{
      "rotational", " ", "drag", " ", "on", " ", "rotating", " ", "cargo", 
       " ", "from", " ", "water"}], "*)"}], "\[IndentingNewLine]", "-", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"Cross", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
             RowBox[{
              RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"c", "[", "0", "]"}], ",", 
             RowBox[{"c", "[", "1", "]"}], ",", 
             RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Fba", "[", "i", "]"}], "[", "0", "]"}], ",", 
            RowBox[{
             RowBox[{"Fba", "[", "i", "]"}], "[", "1", "]"}], ",", 
            RowBox[{
             RowBox[{"Fba", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}], 
         "]"}], 
        RowBox[{"(*", 
         RowBox[{
         "reaction", " ", "torque", " ", "from", " ", "brownian", " ", 
          "force", " ", "on", " ", "cargo"}], "*)"}], "\[IndentingNewLine]", 
        "+", 
        RowBox[{"(*", 
         RowBox[{
         "reaction", " ", "torques", " ", "to", " ", "drag", " ", "forces", 
          " ", "on", " ", "anchor"}], "*)"}], 
        RowBox[{
         RowBox[{"xiAnchor", "[", "i", "]"}], 
         RowBox[{"Cross", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
              RowBox[{
               RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
              RowBox[{
               RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"c", "[", "0", "]"}], ",", 
              RowBox[{"c", "[", "1", "]"}], ",", 
              RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ",", " ", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"vc", "[", "0", "]"}], ",", 
              RowBox[{"vc", "[", "1", "]"}], ",", 
              RowBox[{"vc", "[", "2", "]"}]}], "}"}], "+", 
            RowBox[{"Cross", "[", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"omega", "[", "0", "]"}], ",", 
                RowBox[{"omega", "[", "1", "]"}], ",", 
                RowBox[{"omega", "[", "2", "]"}]}], "}"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{
                  RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
                 RowBox[{
                  RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
                 RowBox[{
                  RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"c", "[", "0", "]"}], ",", 
                 RowBox[{"c", "[", "1", "]"}], ",", 
                 RowBox[{"c", "[", "2", "]"}]}], "}"}]}]}], "]"}], "-", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{
               RowBox[{"va", "[", "i", "]"}], "[", "0", "]"}], ",", 
              RowBox[{
               RowBox[{"va", "[", "i", "]"}], "[", "1", "]"}], ",", 
              RowBox[{
               RowBox[{"va", "[", "i", "]"}], "[", "2", "]"}]}], "}"}]}]}], 
          "]"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685820821629675*^9, 3.6858208555489264`*^9}, {
  3.685909038468484*^9, 3.685909089712001*^9}, {3.68590922797404*^9, 
  3.6859092331715307`*^9}, {3.685909331351536*^9, 3.685909427998534*^9}},
 CellLabel->"In[38]:=",ExpressionUUID->"2cf856a3-687a-496b-a1aa-73bf74217078"],

Cell["Velocity variables to solve for", "Text",
 CellChangeTimes->{{3.685828139160968*^9, 
  3.685828146022786*^9}},ExpressionUUID->"8f2aea30-a566-4931-b324-\
379a4addcd11"],

Cell[BoxData[
 RowBox[{
  RowBox[{"velvars", "[", "nmotors_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"va", "[", "i", "]"}], "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"va", "[", "i", "]"}], "[", "1", "]"}], ",", 
         RowBox[{
          RowBox[{"va", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"vc", "[", "0", "]"}], ",", 
       RowBox[{"vc", "[", "1", "]"}], ",", 
       RowBox[{"vc", "[", "2", "]"}], ",", 
       RowBox[{"omega", "[", "0", "]"}], ",", 
       RowBox[{"omega", "[", "1", "]"}], ",", 
       RowBox[{"omega", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{3.685824185302882*^9},
 CellLabel->"In[39]:=",ExpressionUUID->"b9a3eaad-0fa8-41ff-b68c-5ca1264cc13a"],

Cell["Discretized variables to solve for", "Text",
 CellChangeTimes->{{3.68582814934149*^9, 
  3.685828156563992*^9}},ExpressionUUID->"d6a839bf-aa71-453f-a96f-\
8e6846926a5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"discvars", "[", "nmotors_", "]"}], ":=", 
  RowBox[{
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"a1", "[", "i", "]"}], "[", "0", "]"}], ",", 
         RowBox[{
          RowBox[{"a1", "[", "i", "]"}], "[", "1", "]"}], ",", 
         RowBox[{
          RowBox[{"a1", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"c1", "[", "0", "]"}], ",", 
       RowBox[{"c1", "[", "1", "]"}], ",", 
       RowBox[{"c1", "[", "2", "]"}], ",", 
       RowBox[{"theta1", "[", "0", "]"}], ",", 
       RowBox[{"theta1", "[", "1", "]"}], ",", 
       RowBox[{"theta1", "[", "2", "]"}]}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.685824128996464*^9, 3.68582413403589*^9}, 
   3.685824187709579*^9},
 CellLabel->"In[40]:=",ExpressionUUID->"e5de4c9f-b96a-4ab4-be0d-d8595bf5a7c1"],

Cell["List of rules to turn the equation into a discretized one", "Text",
 CellChangeTimes->{{3.685828160557166*^9, 
  3.685828183293991*^9}},ExpressionUUID->"1a3db608-df31-4440-9940-\
4f5d5a695f61"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"discRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"va", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"a1", "[", "x", "]"}], "[", "y", "]"}], "-", 
        RowBox[{
         RowBox[{"a", "[", "x", "]"}], "[", "y", "]"}]}], ")"}], "/", 
      "dt"}]}], ",", 
    RowBox[{
     RowBox[{"vc", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"c1", "[", "x", "]"}], "-", 
        RowBox[{"c", "[", "x", "]"}]}], ")"}], "/", "dt"}]}], ",", 
    RowBox[{
     RowBox[{"omega", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"theta1", "[", "x", "]"}], "-", 
        RowBox[{"theta", "[", "x", "]"}]}], ")"}], "/", "dt"}]}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.685821609262302*^9, 3.6858216448691874`*^9}, {
   3.685821676254924*^9, 3.685821702894902*^9}, {3.685821739684156*^9, 
   3.6858217971584253`*^9}, {3.6858218349702177`*^9, 3.685821861276149*^9}, {
   3.6858219917492113`*^9, 3.685822096294816*^9}, 3.6858227136827927`*^9, {
   3.685823248517694*^9, 3.685823419741835*^9}, {3.685823456225264*^9, 
   3.68582349864916*^9}, 3.685824203808404*^9, {3.68582961378611*^9, 
   3.685829674556435*^9}},
 CellLabel->"In[41]:=",ExpressionUUID->"e92a590d-9f57-425e-ba44-d4d344f48342"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"va", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"a1", "[", "x", "]"}], "[", "y", "]"}], "-", 
      RowBox[{
       RowBox[{"a", "[", "x", "]"}], "[", "y", "]"}]}], "dt"]}], ",", 
   RowBox[{
    RowBox[{"vc", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      RowBox[{"c1", "[", "x", "]"}], "-", 
      RowBox[{"c", "[", "x", "]"}]}], "dt"]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      RowBox[{"theta1", "[", "x", "]"}], "-", 
      RowBox[{"theta", "[", "x", "]"}]}], "dt"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6858296758729486`*^9, 3.685829984621456*^9, 3.685830038797429*^9, 
   3.685846221429665*^9, {3.685893290204076*^9, 3.6858933127476587`*^9}, 
   3.68589336364888*^9, {3.6858939507028103`*^9, 3.6858939752141438`*^9}, 
   3.685894303488386*^9, 3.6858946531956167`*^9, 3.685895048449067*^9, 
   3.6858952034390574`*^9, 3.6858960816221952`*^9, 3.685909475042844*^9, 
   3.685909751293475*^9, 3.6859875528350554`*^9, 3.685990109738111*^9, 
   3.68712257015186*^9, 3.68712330799284*^9, 3.689440911226816*^9, 
   3.68944195930623*^9, 3.689537162616474*^9, 3.689620563839838*^9, 
   3.689633632548707*^9, 3.69117863573809*^9, 3.694813795365307*^9, 
   3.748788314132848*^9, 3.748789180337923*^9, 3.7489797892545643`*^9, 
   3.758414535025124*^9, 3.758557833549258*^9, 3.758558036149921*^9},
 CellLabel->"Out[41]=",ExpressionUUID->"fbbcad46-0ab9-4ee9-9ba3-5eda7869c529"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"brownianRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Fba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", " ", 
          RowBox[{"DAnchor", "[", "x", "]"}]}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"muAnchor", "[", "x", "]"}], " ", 
          RowBox[{"Sqrt", "[", "dt", "]"}]}], ")"}]}], ")"}], 
      RowBox[{
       RowBox[{"Dba", "[", "x", "]"}], "[", "y", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"Fbc", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", " ", "DCargoTranslation"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"muCargoTranslation", " ", 
          RowBox[{"Sqrt", "[", "dt", "]"}]}], ")"}]}], ")"}], 
      RowBox[{"Dbc", "[", "x", "]"}]}]}], ",", 
    RowBox[{
     RowBox[{"Tbc", "[", "x_", "]"}], "\[RuleDelayed]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Sqrt", "[", 
         RowBox[{"2", " ", "DCargoRotation"}], "]"}], "/", 
        RowBox[{"(", 
         RowBox[{"muCargoRotation", " ", 
          RowBox[{"Sqrt", "[", "dt", "]"}]}], ")"}]}], ")"}], 
      RowBox[{"Rbc", "[", "x", "]"}]}]}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6858296550201693`*^9, 3.6858296618438883`*^9}, {
  3.685893254004937*^9, 3.6858932754892387`*^9}, {3.685893599251741*^9, 
  3.685893608082184*^9}, {3.685893709535286*^9, 3.685893831173573*^9}, {
  3.685894254011365*^9, 3.68589426221187*^9}, {3.685909727384384*^9, 
  3.6859097382158003`*^9}, {3.687122553761495*^9, 3.6871225538557653`*^9}, {
  3.687123261075919*^9, 3.687123263841868*^9}, {3.687888547655604*^9, 
  3.687888552821357*^9}},
 CellLabel->"In[42]:=",ExpressionUUID->"d065afec-9750-4dc9-afe4-bec5ef19b8d6"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Fba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{"2", " ", 
        RowBox[{"DAnchor", "[", "x", "]"}]}]], " ", 
      RowBox[{
       RowBox[{"Dba", "[", "x", "]"}], "[", "y", "]"}]}], 
     RowBox[{
      RowBox[{"muAnchor", "[", "x", "]"}], " ", 
      SqrtBox["dt"]}]]}], ",", 
   RowBox[{
    RowBox[{"Fbc", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{"2", " ", "DCargoTranslation"}]], " ", 
      RowBox[{"Dbc", "[", "x", "]"}]}], 
     RowBox[{"muCargoTranslation", " ", 
      SqrtBox["dt"]}]]}], ",", 
   RowBox[{
    RowBox[{"Tbc", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox[
     RowBox[{
      SqrtBox[
       RowBox[{"2", " ", "DCargoRotation"}]], " ", 
      RowBox[{"Rbc", "[", "x", "]"}]}], 
     RowBox[{"muCargoRotation", " ", 
      SqrtBox["dt"]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.685829679242303*^9, 3.6858299846861057`*^9, 3.685830038849503*^9, 
   3.68584622146734*^9, {3.685893290244563*^9, 3.685893312802332*^9}, 
   3.685893363693542*^9, 3.685893622229151*^9, {3.685893814043271*^9, 
   3.6858938315734777`*^9}, {3.685893950753817*^9, 3.68589397527682*^9}, 
   3.6858943035346746`*^9, 3.6858946532278852`*^9, 3.6858950484808807`*^9, 
   3.685895203493576*^9, 3.6858960816686707`*^9, 3.685909475090109*^9, 
   3.685909751350587*^9, 3.6859875528981657`*^9, 3.685990109782908*^9, 
   3.687122570201221*^9, 3.687123308049953*^9, 3.689440911275498*^9, 
   3.6894419593600693`*^9, 3.689537162678151*^9, 3.689620563879796*^9, 
   3.689633632600169*^9, 3.691178635774542*^9, 3.6948137954073553`*^9, 
   3.7487883142213306`*^9, 3.7487891804173737`*^9, 3.7489797893314247`*^9, 
   3.7584145351126423`*^9, 3.758557833657645*^9, 3.75855803623538*^9},
 CellLabel->"Out[42]=",ExpressionUUID->"1e227682-4f10-4038-841f-3e9922d0e5c4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xi2muRules", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"xiAnchor", "[", "x_", "]"}], "\[RuleDelayed]", " ", 
     RowBox[{"1", "/", 
      RowBox[{"muAnchor", "[", "x", "]"}]}]}], ",", 
    RowBox[{"xiCargoRotation", "\[Rule]", 
     RowBox[{"1", "/", "muCargoRotation"}]}], ",", 
    RowBox[{"xiCargoTranslation", "\[Rule]", 
     RowBox[{"1", "/", "muCargoTranslation"}]}]}], "}"}]}]], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"2891c795-710f-4932-b777-9403c398c3b4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"xiAnchor", "[", "x_", "]"}], "\[RuleDelayed]", 
    FractionBox["1", 
     RowBox[{"muAnchor", "[", "x", "]"}]]}], ",", 
   RowBox[{"xiCargoRotation", "\[Rule]", 
    FractionBox["1", "muCargoRotation"]}], ",", 
   RowBox[{"xiCargoTranslation", "\[Rule]", 
    FractionBox["1", "muCargoTranslation"]}]}], "}"}]], "Output",
 CellChangeTimes->{3.685911528464794*^9, 3.685987552948924*^9, 
  3.685990109832219*^9, 3.68712257024826*^9, 3.687123308112534*^9, 
  3.689440911324542*^9, 3.6894419594142733`*^9, 3.689537162745871*^9, 
  3.6896205639335938`*^9, 3.689633632650197*^9, 3.6911786358308372`*^9, 
  3.694813795452962*^9, 3.7487883143035603`*^9, 3.748789180501294*^9, 
  3.748979789422092*^9, 3.75841453519615*^9, 3.758557833759348*^9, 
  3.758558036322768*^9},
 CellLabel->"Out[43]=",ExpressionUUID->"2fcaea53-b87c-49ee-b0dd-45bf51f1f62c"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Step through stochastic solution", "Section",
 CellChangeTimes->{{3.685825799796288*^9, 
  3.685825806152383*^9}},ExpressionUUID->"5f11cc2b-58a3-4b2d-8b49-\
8c6d12c6d04e"],

Cell["\<\
To go from the force balance equations written above to the numerical scheme \
to solve them (Euler -Maryuama), we first need to solve for the velocities, \
then discretize. The above equations are all coupled together, but are liner, \
so we can use linear algebra to solve for an equation for each velocity (of \
the anchors, the cargo, and the cargo rotation) individually.\
\>", "Text",
 CellChangeTimes->{{3.685754095226262*^9, 3.685754323532625*^9}, {
   3.68582016911197*^9, 3.6858201963235064`*^9}, {3.685827552835374*^9, 
   3.685827579429392*^9}, {3.685827922936791*^9, 3.6858280646519213`*^9}, {
   3.6859856575303*^9, 3.685985812182311*^9}, 
   3.685986077063218*^9},ExpressionUUID->"6caa3bc2-249f-4fee-b876-\
4f53c04f4c59"],

Cell["\<\
First, write out equations in terms of velocities. Then generate a list of \
equations for a given number of motors - set here for the example solution \
that follows. The equations bet big very quickly.\
\>", "Text",
 CellChangeTimes->{
  3.685827582838533*^9, {3.685986149715364*^9, 
   3.685986172518361*^9}},ExpressionUUID->"de75ca16-83f5-466f-a4e2-\
b6d61877b60d"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmotors", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"i", "=", "0"}], ",", 
    RowBox[{"i", "<", "nmotors"}], ",", 
    RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumForcesAnchorStocahstic", "[", "i", "]"}], ",", "eqs"}], 
       "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"Join", "[", 
    RowBox[{
     RowBox[{"sumForcesCargoStochastic", "[", "nmotors", "]"}], ",", "eqs"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"eqs", "=", 
  RowBox[{"Join", "[", 
   RowBox[{
    RowBox[{"sumTorquesCargoStochastic", "[", "nmotors", "]"}], ",", "eqs"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.68582356568734*^9, 3.68582364267073*^9}, {
  3.6858239661976852`*^9, 3.685823973363969*^9}, {3.68582405564684*^9, 
  3.685824056670148*^9}, {3.6858242189846077`*^9, 3.685824219029139*^9}, {
  3.6858270225337887`*^9, 3.685827022601071*^9}, {3.685827517588771*^9, 
  3.6858275176445723`*^9}, {3.689529248977901*^9, 3.689529249055563*^9}, {
  3.689536254208871*^9, 3.689536254242065*^9}},
 CellLabel->"In[44]:=",ExpressionUUID->"4164c214-6c3f-4fca-912c-630271b2ba41"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "0", "]"}]}], "+", 
     RowBox[{"Tbc", "[", "0", "]"}], "+", 
     RowBox[{"TorqeExt", "[", "0", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "1", "]"}]}], "+", 
     RowBox[{"Tbc", "[", "1", "]"}], "+", 
     RowBox[{"TorqeExt", "[", "1", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "xiCargoRotation"}], " ", 
      RowBox[{"omega", "[", "2", "]"}]}], "+", 
     RowBox[{"Tbc", "[", "2", "]"}], "+", 
     RowBox[{"TorqeExt", "[", "2", "]"}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"Fbc", "[", "0", "]"}], "+", 
     RowBox[{"Fsteric", "[", "0", "]"}], "+", 
     RowBox[{"Ftrap", "[", "0", "]"}], "-", 
     RowBox[{"xiCargoTranslation", " ", 
      RowBox[{"vc", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"Fbc", "[", "1", "]"}], "+", 
     RowBox[{"Fsteric", "[", "1", "]"}], "+", 
     RowBox[{"Ftrap", "[", "1", "]"}], "-", 
     RowBox[{"xiCargoTranslation", " ", 
      RowBox[{"vc", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{"0", "\[Equal]", 
    RowBox[{
     RowBox[{"Fbc", "[", "2", "]"}], "+", 
     RowBox[{"Fsteric", "[", "2", "]"}], "+", 
     RowBox[{"Ftrap", "[", "2", "]"}], "-", 
     RowBox[{"xiCargoTranslation", " ", 
      RowBox[{"vc", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.685824041658144*^9, 3.6858240584843082`*^9}, 
   3.6858242211653137`*^9, 3.685824257080385*^9, 3.685826559962892*^9, 
   3.685826807930655*^9, {3.6858269533105917`*^9, 3.685826980027155*^9}, 
   3.685827025336381*^9, 3.685827522052499*^9, 3.6858298978440523`*^9, 
   3.685829984735773*^9, 3.6858300389002542`*^9, 3.685846221496068*^9, 
   3.685893290292556*^9, 3.68589332038494*^9, 3.685893363746293*^9, 
   3.685893627997445*^9, 3.685893839445168*^9, {3.6858939508064947`*^9, 
   3.685893975326516*^9}, 3.685894303576399*^9, 3.685894653276979*^9, 
   3.685895048517456*^9, 3.685895203543894*^9, 3.685896081720436*^9, 
   3.685909475137748*^9, 3.685909751393105*^9, 3.6859875529967537`*^9, 
   3.685990109886348*^9, 3.6871225702971287`*^9, 3.68712330816225*^9, 
   3.6894409113752317`*^9, 3.689441959464602*^9, 3.6895292494663153`*^9, {
   3.6895362547806797`*^9, 3.689536262694169*^9}, 3.689537162794837*^9, 
   3.689633632700697*^9, 3.694813795503853*^9, 3.748979793970587*^9, 
   3.75841453528118*^9, 3.758557833857882*^9, 3.758558036398468*^9},
 CellLabel->"Out[48]=",ExpressionUUID->"9e3915a9-4a11-4173-9928-572196c0016c"]
}, Open  ]],

Cell["\<\
There are 3(nmotors+2) equations (3 components: x, y, z for each of the \
nmotors sum of forces equations for each motor, plus 2 for sum of forces and \
torques on cargo)\
\>", "Text",
 CellChangeTimes->{{3.685986186683929*^9, 3.685986192678359*^9}, 
   3.685986224427182*^9},ExpressionUUID->"c7234642-e3af-46e4-97f0-\
0f02efe0159e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"3", 
  RowBox[{"(", 
   RowBox[{"nmotors", "+", "2"}], ")"}]}], "\[IndentingNewLine]", 
 RowBox[{"Dimensions", "[", "eqs", "]"}]}], "Input",
 CellChangeTimes->{{3.6840073635073347`*^9, 3.684007374239601*^9}, {
  3.684090336371669*^9, 3.684090341610797*^9}, {3.68409048355317*^9, 
  3.684090510507255*^9}, {3.685986252337638*^9, 3.6859862564770393`*^9}},
 CellLabel->"In[49]:=",ExpressionUUID->"014ebcba-710b-4ee5-9da4-5ae19befb19b"],

Cell[BoxData["6"], "Output",
 CellChangeTimes->{
  3.6840073745679693`*^9, 3.684090274299241*^9, 3.6840903419678907`*^9, {
   3.684090493743384*^9, 3.684090511548506*^9}, 3.684097995580967*^9, 
   3.6841210011171627`*^9, 3.68412301856791*^9, 3.6841231823267403`*^9, 
   3.6853105476689053`*^9, {3.68531061492318*^9, 3.685310627529491*^9}, 
   3.685310698510097*^9, {3.685310955889697*^9, 3.685310967860005*^9}, {
   3.6853112207724257`*^9, 3.685311239337963*^9}, 3.685311387996059*^9, 
   3.6853114936080837`*^9, 3.685312008985652*^9, 3.685312840214675*^9, {
   3.685312984545863*^9, 3.685313000700417*^9}, 3.685314856186658*^9, 
   3.685316607540236*^9, 3.68532186573781*^9, 3.68538915128854*^9, 
   3.685407227339322*^9, 3.685407514299226*^9, 3.6854165023059273`*^9, 
   3.685465689070839*^9, 3.6854664292788057`*^9, 3.685828633602516*^9, 
   3.685829945010229*^9, 3.6858300003405523`*^9, 3.685846174926586*^9, 
   3.685893330152071*^9, 3.68598625725861*^9, 3.685987553048293*^9, 
   3.685990109932991*^9, 3.687122570349784*^9, 3.687123308216076*^9, 
   3.689440911424996*^9, 3.689441959514434*^9, 3.689529254813422*^9, {
   3.6895362583921127`*^9, 3.6895362627727413`*^9}, 3.6895371628456583`*^9, 
   3.6896336327507973`*^9, 3.6948137955537233`*^9, 3.748979794079681*^9, 
   3.758414535364233*^9, 3.758557833959372*^9, 3.7585580364902163`*^9},
 CellLabel->"Out[49]=",ExpressionUUID->"8be7e2ad-2146-4eb3-ba2d-59c7305e8261"],

Cell[BoxData[
 RowBox[{"{", "6", "}"}]], "Output",
 CellChangeTimes->{
  3.6840073745679693`*^9, 3.684090274299241*^9, 3.6840903419678907`*^9, {
   3.684090493743384*^9, 3.684090511548506*^9}, 3.684097995580967*^9, 
   3.6841210011171627`*^9, 3.68412301856791*^9, 3.6841231823267403`*^9, 
   3.6853105476689053`*^9, {3.68531061492318*^9, 3.685310627529491*^9}, 
   3.685310698510097*^9, {3.685310955889697*^9, 3.685310967860005*^9}, {
   3.6853112207724257`*^9, 3.685311239337963*^9}, 3.685311387996059*^9, 
   3.6853114936080837`*^9, 3.685312008985652*^9, 3.685312840214675*^9, {
   3.685312984545863*^9, 3.685313000700417*^9}, 3.685314856186658*^9, 
   3.685316607540236*^9, 3.68532186573781*^9, 3.68538915128854*^9, 
   3.685407227339322*^9, 3.685407514299226*^9, 3.6854165023059273`*^9, 
   3.685465689070839*^9, 3.6854664292788057`*^9, 3.685828633602516*^9, 
   3.685829945010229*^9, 3.6858300003405523`*^9, 3.685846174926586*^9, 
   3.685893330152071*^9, 3.68598625725861*^9, 3.685987553048293*^9, 
   3.685990109932991*^9, 3.687122570349784*^9, 3.687123308216076*^9, 
   3.689440911424996*^9, 3.689441959514434*^9, 3.689529254813422*^9, {
   3.6895362583921127`*^9, 3.6895362627727413`*^9}, 3.6895371628456583`*^9, 
   3.6896336327507973`*^9, 3.6948137955537233`*^9, 3.748979794079681*^9, 
   3.758414535364233*^9, 3.758557833959372*^9, 3.758558036505962*^9},
 CellLabel->"Out[50]=",ExpressionUUID->"f48e700e-9e58-43ad-bf37-281ca223c870"]
}, Open  ]],

Cell["\<\
Now we want to solve the equations above for the velocities. First write out \
the velocity variables we want to solve for\
\>", "Text",
 CellChangeTimes->{{3.685986090866044*^9, 
  3.685986125696065*^9}},ExpressionUUID->"1242e921-792e-4e85-ab01-\
b3f7baf558a3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"velvars", "[", "nmotors", "]"}]], "Input",
 CellChangeTimes->{{3.6859861305902033`*^9, 3.6859861357767677`*^9}},
 CellLabel->"In[51]:=",ExpressionUUID->"6105120e-b054-4bd4-967a-15eb4bb89376"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"vc", "[", "0", "]"}], ",", 
   RowBox[{"vc", "[", "1", "]"}], ",", 
   RowBox[{"vc", "[", "2", "]"}], ",", 
   RowBox[{"omega", "[", "0", "]"}], ",", 
   RowBox[{"omega", "[", "1", "]"}], ",", 
   RowBox[{"omega", "[", "2", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.685986136556161*^9, 3.685987553111257*^9, 
  3.685990109987267*^9, 3.6871225704157667`*^9, 3.687123308279217*^9, 
  3.6894409114918747`*^9, 3.689441959577112*^9, 3.689529257545677*^9, 
  3.689536262828424*^9, 3.689537162893627*^9, 3.689633632801317*^9, 
  3.6948137956081133`*^9, 3.748979794177299*^9, 3.7584145356628113`*^9, 
  3.758557834058612*^9, 3.758558036590705*^9},
 CellLabel->"Out[51]=",ExpressionUUID->"3f7f13e0-0bcb-46c4-a236-8f3fbd7b1ba2"]
}, Open  ]],

Cell["\<\
Solve the equations for the velocities by inverting the matrix of \
coefficients of the velocities. Note we solve by multiplying the inverted \
coefficient matrix by (-) the constant vector, this is a quirk in \
CoefficientArrays

Note: Solve doesn\[CloseCurlyQuote]t appear to work for this.\
\>", "Text",
 CellChangeTimes->{{3.685822438518442*^9, 3.685822445786024*^9}, {
  3.685985827864505*^9, 3.685986017044003*^9}, {3.6859863442383823`*^9, 
  3.6859863697977123`*^9}},ExpressionUUID->"a29b0080-e7c7-4ab1-b370-\
a746e250b011"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"const", ",", "coeff"}], "}"}], "=", 
   RowBox[{"Normal", "@", 
    RowBox[{"CoefficientArrays", "[", 
     RowBox[{"eqs", ",", 
      RowBox[{"velvars", "[", "nmotors", "]"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"coeffinv", "=", 
   RowBox[{"Inverse", "[", "coeff", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"veleqs", "=", 
  RowBox[{
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"velvars", "[", "nmotors", "]"}], "\[Equal]", 
     RowBox[{"coeffinv", ".", 
      RowBox[{"-", "const"}]}]}], "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.685821646207342*^9, 3.685821660212678*^9}, {
   3.6858238251124477`*^9, 3.685823835495564*^9}, 3.685824091490088*^9, {
   3.6858242920307503`*^9, 3.685824325206559*^9}, {3.6895294976096363`*^9, 
   3.6895294988626013`*^9}},
 CellLabel->"In[52]:=",ExpressionUUID->"c99298fa-4f87-41a6-a0fa-e5ffe8d13275"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"vc", "[", "0", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Fbc", "[", "0", "]"}], "+", 
      RowBox[{"Fsteric", "[", "0", "]"}], "+", 
      RowBox[{"Ftrap", "[", "0", "]"}]}], "xiCargoTranslation"]}], ",", 
   RowBox[{
    RowBox[{"vc", "[", "1", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Fbc", "[", "1", "]"}], "+", 
      RowBox[{"Fsteric", "[", "1", "]"}], "+", 
      RowBox[{"Ftrap", "[", "1", "]"}]}], "xiCargoTranslation"]}], ",", 
   RowBox[{
    RowBox[{"vc", "[", "2", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Fbc", "[", "2", "]"}], "+", 
      RowBox[{"Fsteric", "[", "2", "]"}], "+", 
      RowBox[{"Ftrap", "[", "2", "]"}]}], "xiCargoTranslation"]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "0", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Tbc", "[", "0", "]"}], "+", 
      RowBox[{"TorqeExt", "[", "0", "]"}]}], "xiCargoRotation"]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "1", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Tbc", "[", "1", "]"}], "+", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}], "xiCargoRotation"]}], ",", 
   RowBox[{
    RowBox[{"omega", "[", "2", "]"}], "\[Equal]", 
    FractionBox[
     RowBox[{
      RowBox[{"Tbc", "[", "2", "]"}], "+", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}], "xiCargoRotation"]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.685824316831094*^9, 3.68582432760667*^9}, 
   3.685826560052609*^9, 3.685826808026104*^9, {3.685826953363693*^9, 
   3.6858269800630608`*^9}, 3.685827025484111*^9, 3.685827522164817*^9, 
   3.6858298979308977`*^9, 3.6858299847867126`*^9, 3.685830038951179*^9, 
   3.685846221525075*^9, 3.685893290342133*^9, 3.685893320440287*^9, 
   3.6858933638216333`*^9, 3.685893628076323*^9, 3.685893839500454*^9, {
   3.685893950853346*^9, 3.6858939753879538`*^9}, 3.6858943036239843`*^9, 
   3.6858946533315363`*^9, 3.685895048553543*^9, 3.685895203597702*^9, 
   3.685896081770046*^9, 3.685909475191102*^9, 3.685909751437297*^9, 
   3.68598755316197*^9, 3.6859901100334883`*^9, 3.687122570465611*^9, 
   3.687123308332554*^9, 3.689440911540938*^9, 3.689441959630855*^9, 
   3.689529269162655*^9, 3.689529499982712*^9, 3.689536262880424*^9, 
   3.6895371629425907`*^9, 3.689633632854134*^9, 3.694813795681411*^9, 
   3.748979794256579*^9, 3.758414536313692*^9, 3.758557834157464*^9, 
   3.75855803666923*^9},
 CellLabel->"Out[54]=",ExpressionUUID->"2c39c4aa-6fd7-49ee-b704-31b743733660"]
}, Open  ]],

Cell[TextData[{
 "Discretize the equations by enforcing ",
 Cell[BoxData[
  FormBox[
   RowBox[{"v", "=", 
    RowBox[{
     FractionBox["dx", "dt"], "\[Rule]", 
     FractionBox[
      RowBox[{
       SuperscriptBox["x", 
        RowBox[{"n", "+", "1"}]], "-", 
       SuperscriptBox["x", "n"]}], "\[CapitalDelta]t"]}]}], TraditionalForm]],
  ExpressionUUID->"977171fd-1c7a-4500-9dbb-69b4d2a1755d"],
 ". Rules given in discRules above. \nFurthermore, we integrate the brownian \
force term to get a brownian displacement, ",
 Cell[BoxData[
  FormBox[
   RowBox[{"Fb", "=", 
    RowBox[{
     RowBox[{
      SqrtBox[
       RowBox[{"\[Sigma]", " ", "D"}]], 
      RowBox[{"W", "(", "t", ")"}]}], "\[Rule]", 
     RowBox[{
      FractionBox[
       RowBox[{" ", 
        SqrtBox[
         RowBox[{"\[Sigma]", " ", "D"}]]}], 
       RowBox[{"\[Mu]", 
        SqrtBox["\[CapitalDelta]t"]}]], 
      RowBox[{"N", "(", 
       RowBox[{"0", ",", "1"}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"f0f5e9d4-d7fe-4c1f-9a60-ac81332d5048"],
 ", where \[Sigma] depends on the number of degrees of freedom the diffuser \
has (\[Sigma]=2 for one degree of freedom, 4 for two and 6 for 3). N(0,1) \
represents a random variable drawn from the gaussian distribution with mean 0 \
and variance 1.\nFinally, we simplify the equation numerically by changing \
drag coefficient (which we would need to divide by) into mobility, its \
inverse, which we multiply by."
}], "Text",
 CellChangeTimes->{{3.685822450162264*^9, 3.685822463752226*^9}, {
  3.6858225697382936`*^9, 3.685822583406938*^9}, {3.685823008858972*^9, 
  3.685823120697291*^9}, {3.685823159428072*^9, 3.6858232203721848`*^9}, {
  3.685986468033107*^9, 3.68598664105689*^9}, {3.685986686181158*^9, 
  3.685986697340425*^9}, {3.6859867287289743`*^9, 3.685986862366263*^9}, {
  3.685986923768314*^9, 
  3.685987129856472*^9}},ExpressionUUID->"b8d7d8e7-644b-4caf-9711-\
f33a44430a36"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"discEqs", "=", 
  RowBox[{"veleqs", "/.", 
   RowBox[{"Join", "[", 
    RowBox[{"discRules", ",", "brownianRules", ",", "xi2muRules"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6858243581122847`*^9, 3.685824399096319*^9}, {
   3.685829880611598*^9, 3.6858298915694513`*^9}, {3.6895293789576406`*^9, 
   3.689529382260166*^9}, 3.689536309075001*^9},
 CellLabel->"In[55]:=",ExpressionUUID->"beae1f40-dcbf-4e69-a598-f20f13344fc3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"c", "[", "0", "]"}]}], "+", 
      RowBox[{"c1", "[", "0", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoTranslation", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox["DCargoTranslation"], " ", 
         RowBox[{"Dbc", "[", "0", "]"}]}], 
        RowBox[{
         SqrtBox["dt"], " ", "muCargoTranslation"}]], "+", 
       RowBox[{"Fsteric", "[", "0", "]"}], "+", 
       RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"c", "[", "1", "]"}]}], "+", 
      RowBox[{"c1", "[", "1", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoTranslation", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox["DCargoTranslation"], " ", 
         RowBox[{"Dbc", "[", "1", "]"}]}], 
        RowBox[{
         SqrtBox["dt"], " ", "muCargoTranslation"}]], "+", 
       RowBox[{"Fsteric", "[", "1", "]"}], "+", 
       RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"c", "[", "2", "]"}]}], "+", 
      RowBox[{"c1", "[", "2", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoTranslation", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox["DCargoTranslation"], " ", 
         RowBox[{"Dbc", "[", "2", "]"}]}], 
        RowBox[{
         SqrtBox["dt"], " ", "muCargoTranslation"}]], "+", 
       RowBox[{"Fsteric", "[", "2", "]"}], "+", 
       RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"theta", "[", "0", "]"}]}], "+", 
      RowBox[{"theta1", "[", "0", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox["DCargoRotation"], " ", 
         RowBox[{"Rbc", "[", "0", "]"}]}], 
        RowBox[{
         SqrtBox["dt"], " ", "muCargoRotation"}]], "+", 
       RowBox[{"TorqeExt", "[", "0", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"theta", "[", "1", "]"}]}], "+", 
      RowBox[{"theta1", "[", "1", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox["DCargoRotation"], " ", 
         RowBox[{"Rbc", "[", "1", "]"}]}], 
        RowBox[{
         SqrtBox["dt"], " ", "muCargoRotation"}]], "+", 
       RowBox[{"TorqeExt", "[", "1", "]"}]}], ")"}]}]}], ",", 
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"-", 
       RowBox[{"theta", "[", "2", "]"}]}], "+", 
      RowBox[{"theta1", "[", "2", "]"}]}], "dt"], "\[Equal]", 
    RowBox[{"muCargoRotation", " ", 
     RowBox[{"(", 
      RowBox[{
       FractionBox[
        RowBox[{
         SqrtBox["2"], " ", 
         SqrtBox["DCargoRotation"], " ", 
         RowBox[{"Rbc", "[", "2", "]"}]}], 
        RowBox[{
         SqrtBox["dt"], " ", "muCargoRotation"}]], "+", 
       RowBox[{"TorqeExt", "[", "2", "]"}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.68582437013113*^9, 3.6858243999829073`*^9}, 
   3.685826560102429*^9, 3.6858268080799427`*^9, {3.685826953415012*^9, 
   3.685826980121085*^9}, 3.685827025596992*^9, 3.685827522198017*^9, {
   3.685829893333518*^9, 3.6858298979820232`*^9}, 3.685829984836589*^9, 
   3.68583003900056*^9, 3.685846221556336*^9, 3.6858932904475193`*^9, 
   3.6858933205004463`*^9, 3.685893363859996*^9, 3.685893628124845*^9, 
   3.68589383954272*^9, {3.6858939509032793`*^9, 3.685893975421361*^9}, 
   3.685894303673387*^9, 3.685894653379899*^9, 3.6858950486009407`*^9, 
   3.6858952036474123`*^9, 3.68589608182015*^9, 3.685909475236932*^9, 
   3.685909751490508*^9, 3.685987151306456*^9, 3.685987553214076*^9, 
   3.685990110082856*^9, 3.6871225705160427`*^9, 3.6871233083819227`*^9, 
   3.689440911590804*^9, 3.689441959677163*^9, 3.689529323992359*^9, 
   3.689529384917647*^9, 3.689536263011483*^9, 3.6895363095375557`*^9, 
   3.6895371629961567`*^9, 3.689633632900692*^9, 3.6948137957202578`*^9, 
   3.748979794341126*^9, 3.758414537141634*^9, 3.758557834252541*^9, 
   3.758558036756938*^9},
 CellLabel->"Out[55]=",ExpressionUUID->"d96b4fd1-a053-483a-8022-f1b9061cde04"]
}, Open  ]],

Cell["\<\
Now that the equations are discretized, we solve the resulting discretized \
equations for the values at the next step, which are\
\>", "Text",
 CellChangeTimes->{{3.6858225984368763`*^9, 3.68582262158928*^9}, {
  3.6859872191364202`*^9, 
  3.685987239340711*^9}},ExpressionUUID->"d4a4e7fa-7c0c-40e7-af3f-\
f37a95686add"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"discvars", "[", "nmotors", "]"}]], "Input",
 CellChangeTimes->{{3.685987242897832*^9, 3.685987248555406*^9}},
 CellLabel->"In[56]:=",ExpressionUUID->"d6417aaf-f6fd-44dc-a1f8-0f35b21d29c1"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"c1", "[", "0", "]"}], ",", 
   RowBox[{"c1", "[", "1", "]"}], ",", 
   RowBox[{"c1", "[", "2", "]"}], ",", 
   RowBox[{"theta1", "[", "0", "]"}], ",", 
   RowBox[{"theta1", "[", "1", "]"}], ",", 
   RowBox[{"theta1", "[", "2", "]"}]}], "}"}]], "Output",
 CellChangeTimes->{3.685987249036489*^9, 3.6859875532649593`*^9, 
  3.68599011013313*^9, 3.687122570565961*^9, 3.687123308432251*^9, 
  3.6894409116423397`*^9, 3.6894419597269363`*^9, 3.68952935818083*^9, 
  3.6895362631068993`*^9, 3.689537163043661*^9, 3.689633632951785*^9, 
  3.694813795773677*^9, 3.748979794423546*^9, 3.7584145372453613`*^9, 
  3.758557834357525*^9, 3.758558036835788*^9},
 CellLabel->"Out[56]=",ExpressionUUID->"29d33caa-b56a-4e52-8e15-f66bd417fa94"]
}, Open  ]],

Cell["Solve the equations and simplify them", "Text",
 CellChangeTimes->{{3.685987253282423*^9, 
  3.685987268658169*^9}},ExpressionUUID->"0fea4cac-e2cd-45b1-8f93-\
921f5500c3aa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"soln", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{"discEqs", ",", 
      RowBox[{"discvars", "[", "nmotors", "]"}]}], "]"}], "//", "First"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.685821894162339*^9, 3.685821966391511*^9}, {
   3.685822116061079*^9, 3.6858221371700974`*^9}, 3.685822717911746*^9, 
   3.685824119131777*^9, 3.6858243503398123`*^9, {3.685824387059539*^9, 
   3.6858244088957453`*^9}, {3.6858265478416033`*^9, 3.685826633610422*^9}, {
   3.685826834558629*^9, 3.68582683678015*^9}},
 CellLabel->"In[57]:=",ExpressionUUID->"0cf6b4a1-0f5f-4f42-8a69-2342bf786b48"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "0", "]"}]}], "+", 
     RowBox[{"theta", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
     RowBox[{"theta", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Rule]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "2", "]"}]}], "+", 
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6858244092379427`*^9, {3.685826552336358*^9, 3.685826601691846*^9}, 
   3.685826634755744*^9, {3.6858268081568327`*^9, 3.685826837804154*^9}, {
   3.6858269534628353`*^9, 3.68582698018293*^9}, 3.685827025857699*^9, 
   3.685827522254377*^9, 3.685829898058585*^9, 3.685829984886984*^9, 
   3.6858300390488043`*^9, 3.685846221609638*^9, 3.6858932905129023`*^9, 
   3.6858933205734673`*^9, 3.6858933639266243`*^9, 3.685893628180231*^9, 
   3.685893839609456*^9, {3.685893950956829*^9, 3.685893975485365*^9}, 
   3.6858943037289*^9, 3.6858946534307337`*^9, 3.6858950486559343`*^9, 
   3.685895203698777*^9, 3.6858960818867683`*^9, 3.685909475299529*^9, 
   3.6859097515381308`*^9, 3.685987271342372*^9, 3.685987553330535*^9, 
   3.685990110187022*^9, 3.6871225706388083`*^9, 3.6871233084811583`*^9, 
   3.68944091170849*^9, 3.6894419597806683`*^9, 3.68952936612753*^9, 
   3.689536263156723*^9, 3.689537163129133*^9, 3.689633633004163*^9, 
   3.6948137958526373`*^9, 3.748979794507584*^9, 3.75841453734077*^9, 
   3.758557834491098*^9, 3.7585580369414253`*^9},
 CellLabel->"Out[57]=",ExpressionUUID->"3e60fd91-4da4-438f-afc0-448cd2053d00"]
}, Open  ]],

Cell["Finally, put these into a printable form", "Text",
 CellChangeTimes->{{3.6858276344873877`*^9, 
  3.685827644735396*^9}},ExpressionUUID->"3284bdbd-a013-4cb0-aab9-\
240ced42bf26"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Thread", "[", 
  RowBox[{
   RowBox[{"discvars", "[", "nmotors", "]"}], "==", 
   RowBox[{"Evaluate", "[", 
    RowBox[{
     RowBox[{"discvars", "[", "nmotors", "]"}], "/.", "soln"}], "]"}]}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6858266174622383`*^9, 3.685826714262645*^9}},
 CellLabel->"In[58]:=",ExpressionUUID->"3628abec-bb9e-4657-a2ed-cdd669b88276"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "0", "]"}]}], "+", 
     RowBox[{"theta", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
     RowBox[{"theta", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "2", "]"}]}], "+", 
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.685826637848789*^9, {3.6858266812360573`*^9, 3.685826735374387*^9}, 
   3.685826808211841*^9, 3.685826840313208*^9, {3.685826953512967*^9, 
   3.685826980232581*^9}, 3.685827025915041*^9, 3.685827522301631*^9, 
   3.685829898100388*^9, 3.685829984937006*^9, 3.685830039100217*^9, 
   3.685846221640491*^9, 3.685893290578204*^9, 3.685893320667735*^9, 
   3.685893363955656*^9, 3.685893628228155*^9, 3.6858938396360064`*^9, {
   3.685893951004298*^9, 3.6858939755429907`*^9}, 3.685894303776984*^9, 
   3.685894653480569*^9, 3.685895048700057*^9, 3.6858952037446613`*^9, 
   3.6858960819166822`*^9, 3.6859094753292418`*^9, 3.685909751566081*^9, 
   3.685987553378067*^9, 3.685990110232836*^9, 3.6871225706987963`*^9, 
   3.68712330851723*^9, 3.689440911758058*^9, 3.689441959826487*^9, 
   3.689536263207635*^9, 3.68953716326188*^9, 3.6896336330469627`*^9, 
   3.694813795902956*^9, 3.748979794591655*^9, 3.758414537577098*^9, 
   3.758557834619618*^9, 3.758558037040224*^9},
 CellLabel->"Out[58]=",ExpressionUUID->"14b021a2-9ade-45cf-b814-873e14b670ea"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stochastic equations generating function", "Section",
 CellChangeTimes->{{3.685821445743783*^9, 3.685821459614382*^9}, {
  3.685822690484136*^9, 3.685822704287971*^9}, {3.6858255455388107`*^9, 
  3.6858255578542213`*^9}},ExpressionUUID->"e3a825d9-779d-4af0-b5e9-\
101af52c3314"],

Cell["\<\
This function does all the steps outlined above, given a number of motors\
\>", "Text",
 CellChangeTimes->{{3.68598730501864*^9, 
  3.685987327056621*^9}},ExpressionUUID->"f07f7883-deeb-43a0-a143-\
db57a5732b32"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eqs", ",", "i", ",", "veleqs", ",", "disceqs", ",", "coeff", ",", 
      "coeffinv", ",", "const", ",", "soln"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "0"}], ",", 
       RowBox[{"i", "<", "nmotors"}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"eqs", "=", 
         RowBox[{"Join", "[", 
          RowBox[{
           RowBox[{"sumForcesAnchorStocahstic", "[", "i", "]"}], ",", "eqs"}],
           "]"}]}], ";"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumForcesCargoStochastic", "[", "nmotors", "]"}], ",", 
        "eqs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumTorquesCargoStochastic", "[", "nmotors", "]"}], ",", 
        "eqs"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"const", ",", "coeff"}], "}"}], "=", 
      RowBox[{"Normal", "@", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"eqs", ",", 
         RowBox[{"velvars", "[", "nmotors", "]"}]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coeffinv", "=", 
      RowBox[{"Inverse", "[", "coeff", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"veleqs", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{
        RowBox[{"velvars", "[", "nmotors", "]"}], "\[Equal]", 
        RowBox[{"coeffinv", ".", 
         RowBox[{"-", "const"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"disceqs", "=", 
      RowBox[{"veleqs", "/.", 
       RowBox[{"Join", "[", 
        RowBox[{"discRules", ",", "brownianRules", ",", "xi2muRules"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"soln", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{"disceqs", ",", 
          RowBox[{"discvars", "[", "nmotors", "]"}]}], "]"}], "//", "First"}],
        "//", "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{
       RowBox[{"discvars", "[", "nmotors", "]"}], "==", 
       RowBox[{"Evaluate", "[", 
        RowBox[{
         RowBox[{"discvars", "[", "nmotors", "]"}], "/.", "soln"}], "]"}]}], 
      "]"}]}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.685752021873514*^9, 3.68575204526968*^9}, {
   3.68575208770603*^9, 3.6857521842190332`*^9}, {3.685752228757876*^9, 
   3.6857522323234243`*^9}, {3.685752264543935*^9, 3.685752284658534*^9}, {
   3.685752351179758*^9, 3.685752354430645*^9}, {3.685753459086227*^9, 
   3.685753531086829*^9}, {3.685820203075674*^9, 3.685820300949844*^9}, {
   3.685820336995573*^9, 3.685820351371944*^9}, 3.685820517706642*^9, {
   3.685820628818067*^9, 3.685820635541727*^9}, 3.685820677745757*^9, {
   3.685820782413342*^9, 3.6858208161300383`*^9}, {3.6858208774524727`*^9, 
   3.685820881217555*^9}, {3.685820923690524*^9, 3.6858209301028633`*^9}, {
   3.685821247565405*^9, 3.685821259354423*^9}, {3.685822755308692*^9, 
   3.685822811748394*^9}, {3.685824425209546*^9, 3.685824484230485*^9}, {
   3.6858268700985003`*^9, 3.6858268958146467`*^9}, {3.685827246218122*^9, 
   3.685827246250827*^9}, {3.685829704459293*^9, 3.685829752018261*^9}, {
   3.685829836815978*^9, 3.685829838378912*^9}},
 CellLabel->"In[59]:=",ExpressionUUID->"e86ce833-6c81-48da-8870-43b39f6a7e16"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing - deterministic", "Section",
 CellChangeTimes->{{3.6853117361432056`*^9, 3.6853117417205057`*^9}, {
  3.685985450249135*^9, 
  3.685985453285982*^9}},ExpressionUUID->"a065e7a0-6c91-42ca-af58-\
6c2683c77e22"],

Cell["\<\
To test whether these equations make sense, we can look at simple cases. \
First, look at some simple cases with the stochastic terms removed - a rule \
to do so is\
\>", "Text",
 CellChangeTimes->{{3.6859873349090643`*^9, 
  3.685987415818853*^9}},ExpressionUUID->"33c9f3dc-9d74-41a6-95a6-\
2f0cc3f76dba"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stochasticTo0", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Dba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
     "0"}], ",", 
    RowBox[{
     RowBox[{"Dbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
    RowBox[{
     RowBox[{"Rbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.685987421060203*^9, 3.685987446554652*^9}, {
  3.685987571755106*^9, 3.685987574584209*^9}, {3.685987617700138*^9, 
  3.6859876559495077`*^9}},
 CellLabel->"In[60]:=",ExpressionUUID->"8b88e35f-04aa-4ee1-bc93-f2a50a0648d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Dba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
    "0"}], ",", 
   RowBox[{
    RowBox[{"Dbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
   RowBox[{
    RowBox[{"Rbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6859876622564383`*^9, 3.685990110295451*^9, 
  3.687122570795476*^9, 3.687123308618372*^9, 3.6894409118367643`*^9, 
  3.6894419598786182`*^9, 3.689537163792984*^9, 3.6896336331074467`*^9, 
  3.694813795971484*^9, 3.748979804817992*^9, 3.758414538047223*^9, 
  3.758557834724739*^9, 3.758558037169045*^9},
 CellLabel->"Out[60]=",ExpressionUUID->"54c0bc3e-41dd-4045-b11f-e5a82b481ff3"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"forcesTo0", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], ":>", "0"}],
     ",", 
    RowBox[{
     RowBox[{
      RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], 
     "\[RuleDelayed]", "0"}], ",", 
    RowBox[{
     RowBox[{"Fsteric", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
    RowBox[{
     RowBox[{"Ftrap", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
    RowBox[{
     RowBox[{"TorqeExt", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], 
   "}"}]}]], "Input",
 CellChangeTimes->{{3.685988907577201*^9, 3.685988930998909*^9}, {
  3.685989021999111*^9, 3.685989024619398*^9}},
 CellLabel->"In[61]:=",ExpressionUUID->"b221cda3-bec5-419d-993f-b164bef96855"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], 
    "\[RuleDelayed]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]",
     "0"}], ",", 
   RowBox[{
    RowBox[{"Fsteric", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
   RowBox[{
    RowBox[{"Ftrap", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
   RowBox[{
    RowBox[{"TorqeExt", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.685988937699194*^9, 3.6859890261735783`*^9, 
  3.685990110353808*^9, 3.687122570916091*^9, 3.687123308668651*^9, 
  3.689440911887513*^9, 3.6894419599271727`*^9, 3.6895371644887114`*^9, 
  3.6896336331660757`*^9, 3.694813796021739*^9, 3.748979804979031*^9, 
  3.7584145386304626`*^9, 3.758557834824421*^9, 3.75855803724555*^9},
 CellLabel->"Out[61]=",ExpressionUUID->"8fbf19d1-fc7c-4bd8-ab26-88536c1af763"]
}, Open  ]],

Cell["0 motors case, easiest to look at", "Text",
 CellChangeTimes->{{3.685468243444017*^9, 3.685468246569477*^9}, {
  3.685829304331546*^9, 
  3.685829311969603*^9}},ExpressionUUID->"7e1e83a2-9456-4222-b2e0-\
711b95b74c78"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "0", "]"}], "/.", 
  "stochasticTo0"}]], "Input",
 CellChangeTimes->{{3.685311743265396*^9, 3.685311755806418*^9}, {
   3.685311807129068*^9, 3.685311817816437*^9}, 3.685312289331439*^9, {
   3.685315190211714*^9, 3.685315216419607*^9}, {3.685465596646974*^9, 
   3.685465603122868*^9}, {3.685465731576527*^9, 3.685465768441174*^9}, {
   3.6854658921805353`*^9, 3.685465893034176*^9}, {3.685466014028411*^9, 
   3.685466016964177*^9}, {3.685466123998111*^9, 3.6854661250868187`*^9}, {
   3.685466915351313*^9, 3.685466915440946*^9}, {3.685466964378644*^9, 
   3.68546696440827*^9}, {3.685467340476569*^9, 3.6854673405430393`*^9}, {
   3.6854673712781897`*^9, 3.685467406068653*^9}, {3.6854674408004427`*^9, 
   3.685467447485281*^9}, {3.685467545417192*^9, 3.685467548386901*^9}, {
   3.685468096884213*^9, 3.685468096945269*^9}, {3.685468667071039*^9, 
   3.6854686806721163`*^9}, {3.6854687628765507`*^9, 3.685468767754199*^9}, {
   3.685479984826449*^9, 3.685479984913291*^9}, {3.685829027683874*^9, 
   3.685829027739738*^9}, {3.68598766835882*^9, 3.685987680829885*^9}, 
   3.6859877436998653`*^9},
 CellLabel->"In[62]:=",ExpressionUUID->"116d1a8f-ff4a-4ef5-8f50-49196999acd0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6854656034895372`*^9, 3.685465689213483*^9, 3.685465735106903*^9, 
   3.685465768915318*^9, 3.685465893772629*^9, 3.68546612617142*^9, 
   3.685466880574355*^9, {3.6854669161991043`*^9, 3.685466964984136*^9}, 
   3.6854670429073687`*^9, {3.685467183253808*^9, 3.685467185255321*^9}, {
   3.6854673354207697`*^9, 3.685467341113183*^9}, {3.6854673718206882`*^9, 
   3.685467406384935*^9}, 3.685467448683988*^9, 3.68546755005589*^9, 
   3.685468097487165*^9, 3.6854685124959383`*^9, {3.685468664171893*^9, 
   3.685468668721938*^9}, {3.685468700456657*^9, 3.685468728004751*^9}, {
   3.6854687636334343`*^9, 3.685468768208918*^9}, {3.685479979743922*^9, 
   3.685479985829925*^9}, {3.685829028584985*^9, 3.685829047248519*^9}, 
   3.685829099240533*^9, {3.685829138445758*^9, 3.6858291879932823`*^9}, 
   3.685829337146323*^9, 3.6858299452296047`*^9, 3.685830000609424*^9, 
   3.685846175203927*^9, 3.6858933303553543`*^9, 3.6859875534960537`*^9, 
   3.6859876814826307`*^9, 3.6859877456185923`*^9, 3.685990110402038*^9, 
   3.687122571033265*^9, 3.6871233087182302`*^9, 3.6894409119409113`*^9, 
   3.689441959976942*^9, 3.689537164585577*^9, 3.689633633213924*^9, 
   3.694813796074181*^9, 3.748979805079246*^9, 3.758414539476264*^9, 
   3.758557834924305*^9, 3.758558037340954*^9},
 CellLabel->"Out[62]=",ExpressionUUID->"4d179780-18da-495a-891c-81056ad7e52d"]
}, Open  ]],

Cell["\<\
If all forces are 0, should simplify to a1=a, c1=c, omega=0 - no motion\
\>", "Text",
 CellChangeTimes->{{3.685312226178508*^9, 3.685312269040287*^9}, {
  3.68598771844333*^9, 
  3.685987720445202*^9}},ExpressionUUID->"5e2f4da1-bb43-4a8e-be29-\
bf5a2045d022"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"forcesTo0", ",", "stochasticTo0"}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.685311743265396*^9, 3.685311755806418*^9}, {
   3.685311807129068*^9, 3.685311817816437*^9}, 3.685312289331439*^9, {
   3.685315190211714*^9, 3.685315216419607*^9}, {3.6859877259915752`*^9, 
   3.6859878817812853`*^9}, {3.6859889275557127`*^9, 3.685988941331477*^9}, {
   3.685989033428213*^9, 3.685989048750431*^9}},
 CellLabel->"In[63]:=",ExpressionUUID->"452971f9-30b3-47a3-b571-4e4b465a1f60"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.685987884164966*^9, 3.685988942302272*^9, 
  3.6859890492798986`*^9, 3.685990110610814*^9, 3.6871225720838757`*^9, 
  3.687123309551425*^9, 3.689440912626862*^9, 3.689441960578467*^9, 
  3.689537165340954*^9, 3.6896336349141483`*^9, 3.694813796857664*^9, 
  3.7489798059525423`*^9, 3.758414540382207*^9, 3.75855783799148*^9, 
  3.7585580375429897`*^9},
 CellLabel->"Out[63]=",ExpressionUUID->"52474541-0f94-40c0-9ad2-9c6a72a39995"]
}, Open  ]],

Cell["For more anchors ", "Text",
 CellChangeTimes->{{3.685469932854989*^9, 3.685469941074626*^9}, {
  3.685469972383471*^9, 
  3.685469974543227*^9}},ExpressionUUID->"c6186fa5-d70d-45e0-b884-\
fa1aaae9b99d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "3", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"stochasticTo0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], ":>", 
      "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], 
      "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685311743265396*^9, 3.685311755806418*^9}, {
   3.685311807129068*^9, 3.685311817816437*^9}, 3.685312289331439*^9, {
   3.685315190211714*^9, 3.685315216419607*^9}, {3.685469994158395*^9, 
   3.685469994243108*^9}, {3.6859878933692617`*^9, 3.68598791193403*^9}, {
   3.687123302339286*^9, 3.687123303340398*^9}},
 CellLabel->"In[64]:=",ExpressionUUID->"8033793d-838c-444f-8847-d53d8cf3e56f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "1", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "1", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "1", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "1", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "2", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "2", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "2", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "2", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.685987909128104*^9, 3.685987934856329*^9}, 
   3.6859901227674313`*^9, 3.687122598121142*^9, 3.687123317575685*^9, 
   3.689440918339872*^9, 3.689441967014575*^9, 3.689537171328623*^9, 
   3.689633648771818*^9, 3.694813802860589*^9, 3.748979812909946*^9, 
   3.7584145471354017`*^9, 3.758558043919689*^9},
 CellLabel->"Out[64]=",ExpressionUUID->"7ec87803-b95c-4978-8c91-489f08634875"]
}, Open  ]],

Cell["\<\
Want to take a look at equations for only external torque in the z direction \
- should change location of anchors, but not the cargo.\
\>", "Text",
 CellChangeTimes->{{3.685470100520462*^9, 3.6854701195630827`*^9}, {
  3.685471093817589*^9, 3.685471095771871*^9}, {3.6854724282536697`*^9, 
  3.6854724307388973`*^9}, {3.685829356115245*^9, 3.68582937356329*^9}, {
  3.685829504546586*^9, 3.6858295184290533`*^9}, {3.6859879990737753`*^9, 
  3.6859880019641037`*^9}},ExpressionUUID->"f8dd1db6-9508-47fc-bc81-\
4b681099a327"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invsoln", "=", 
  RowBox[{
   RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
   RowBox[{"Flatten", "[", 
    RowBox[{"{", 
     RowBox[{"stochasticTo0", ",", 
      RowBox[{
       RowBox[{
        RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], ":>", 
       "0"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], 
       "\[RuleDelayed]", "0"}], ",", 
      RowBox[{
       RowBox[{"Fsteric", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
      RowBox[{
       RowBox[{"Ftrap", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"TorqeExt", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
      RowBox[{
       RowBox[{"TorqeExt", "[", "1", "]"}], "\[Rule]", "0"}]}], "}"}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.685470128162623*^9, 3.6854701282293262`*^9}, 
   3.685471596681834*^9, 3.685472300550909*^9, {3.685987928817751*^9, 
   3.685987965796608*^9}, {3.685988035354703*^9, 3.6859880568082037`*^9}},
 CellLabel->"In[65]:=",ExpressionUUID->"9b36bdff-0277-40b2-9568-912c584ddefe"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "[", "1", "]"}], " ", 
         RowBox[{"TorqeExt", "[", "2", "]"}]}], "-", 
        RowBox[{
         RowBox[{"TorqeExt", "[", "2", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"c", "[", "0", "]"}]}], " ", 
         RowBox[{"TorqeExt", "[", "2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"TorqeExt", "[", "2", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.685987968871426*^9, 3.685988057646339*^9, 
  3.685990123108564*^9, 3.687122598809825*^9, 3.687123318439905*^9, 
  3.689440918675906*^9, 3.6894419676667767`*^9, 3.68953717172945*^9, 
  3.6896336499211617`*^9, 3.694813803279438*^9, 3.748979813452035*^9, 
  3.7584145476464567`*^9, 3.7585580443092003`*^9},
 CellLabel->"Out[65]=",ExpressionUUID->"00920590-a2d6-4b07-8210-0acc7541fe96"]
}, Open  ]],

Cell["\<\
Want to look at external force in x direction - should change locations of \
cargo and anchors together, only in x direction\
\>", "Text",
 CellChangeTimes->{{3.685472357470635*^9, 3.6854723737015533`*^9}, {
  3.6858295219615383`*^9, 
  3.685829548849044*^9}},ExpressionUUID->"48d03932-76de-4719-a284-\
805fd0d2f846"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"stochasticTo0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], ":>", 
      "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], 
      "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Ftrap", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685470128162623*^9, 3.6854701282293262`*^9}, 
   3.685471596681834*^9, 3.685472300550909*^9, {3.6859880146318827`*^9, 
   3.6859880185587378`*^9}, {3.68598807543793*^9, 3.685988105651586*^9}},
 CellLabel->"In[66]:=",ExpressionUUID->"e171a703-9065-47cf-907f-706fccd2bfbf"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"Ftrap", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"Ftrap", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.685988102496682*^9, 3.685988106271151*^9}, 
   3.685990123321589*^9, 3.687122599146824*^9, 3.687123319238489*^9, 
   3.689440918862608*^9, 3.689441968168692*^9, 3.689537171942959*^9, 
   3.689633650854718*^9, 3.694813803488909*^9, 3.74897981373869*^9, 
   3.758414547883103*^9, 3.758558044512035*^9},
 CellLabel->"Out[66]=",ExpressionUUID->"0671d016-76fa-467c-995f-c61723ec1a8d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"stochasticTo0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmTangential", "[", "x_", "]"}], "[", "y_", "]"}], ":>", 
      "0"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"FmRadial", "[", "x_", "]"}], "[", "y_", "]"}], 
      "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Fsteric", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Ftrap", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
     RowBox[{
      RowBox[{"TorqeExt", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.748979867441255*^9, 3.748979904351377*^9}, {
  3.74898003367148*^9, 3.748980033733127*^9}},
 CellLabel->"In[67]:=",ExpressionUUID->"fd6809fa-60a3-40b3-aee3-64501880a8be"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"c", "[", "2", "]"}]}], " ", 
         RowBox[{"TorqeExt", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"TorqeExt", "[", "1", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "[", "0", "]"}], " ", 
         RowBox[{"TorqeExt", "[", "1", "]"}]}], "-", 
        RowBox[{
         RowBox[{"TorqeExt", "[", "1", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"theta", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.748979904888277*^9, 3.7489800348836727`*^9, 
  3.758414548090948*^9, 3.758558044716545*^9},
 CellLabel->"Out[67]=",ExpressionUUID->"ea5ac71e-8644-4222-bdde-25e511920501"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Testing for stochastic equations", "Section",
 CellChangeTimes->{{3.685826489183947*^9, 
  3.685826497620698*^9}},ExpressionUUID->"b1a7a0e6-cc04-4264-9d39-\
aee44ae796fd"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"generateEqsStochastic", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.6858264991887407`*^9, 3.68582650292021*^9}, {
  3.6858270080549707`*^9, 3.685827008122107*^9}, {3.685827507352364*^9, 
  3.6858275074043007`*^9}, {3.685829764095656*^9, 3.6858297869884768`*^9}},
 CellLabel->"In[68]:=",ExpressionUUID->"00e08789-301f-48d1-879c-2c60b7544721"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "0", "]"}], "+", 
        RowBox[{"Ftrap", "[", "0", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "1", "]"}], "+", 
        RowBox[{"Ftrap", "[", "1", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}], "+", 
     RowBox[{"dt", " ", "muCargoTranslation", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fsteric", "[", "2", "]"}], "+", 
        RowBox[{"Ftrap", "[", "2", "]"}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "0", "]"}]}], "+", 
     RowBox[{"theta", "[", "0", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
     RowBox[{"theta", "[", "1", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "2", "]"}]}], "+", 
     RowBox[{"theta", "[", "2", "]"}], "+", 
     RowBox[{"dt", " ", "muCargoRotation", " ", 
      RowBox[{"TorqeExt", "[", "2", "]"}]}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.685826504658276*^9, 3.685826905485097*^9, {3.685826953563291*^9, 
   3.685827008678941*^9}, 3.6858272626108837`*^9, 3.685827507831451*^9, {
   3.685829761434699*^9, 3.6858297873429537`*^9}, 3.685829984986368*^9, 
   3.6858300391522417`*^9, 3.685846221682173*^9, 3.685893290706628*^9, 
   3.685893363988223*^9, {3.6858939510562267`*^9, 3.685893975599105*^9}, 
   3.685894303825622*^9, 3.685894653537477*^9, 3.685895048761354*^9, 
   3.685895203807218*^9, 3.6858960819785624`*^9, 3.685909475420459*^9, 
   3.685909751607401*^9, 3.685987553747477*^9, 3.6859901233496447`*^9, 
   3.687122599207411*^9, 3.6871233193261003`*^9, 3.6894409189104*^9, 
   3.689441968245829*^9, 3.689537171976048*^9, 3.6896336509348097`*^9, 
   3.694813803540627*^9, 3.758414548218958*^9, 3.7585580448085423`*^9},
 CellLabel->"Out[68]=",ExpressionUUID->"30a784bf-57fc-455a-b552-0eded8f31473"]
}, Open  ]],

Cell[TextData[{
 "If all forces are 0 we should just get brownian movement with ",
 Cell[BoxData[
  FormBox[
   SqrtBox[
    RowBox[{"6", "D", " ", "dt"}]], TraditionalForm]],ExpressionUUID->
  "c8e077b6-7de6-4ba9-a276-66aed3cdf050"],
 "in front for the cargo (diffusion of a particle)"
}], "Text",
 CellChangeTimes->{{3.685830116860518*^9, 3.6858301317436447`*^9}, {
  3.685830278680277*^9, 3.685830383169176*^9}, {3.685896795617928*^9, 
  3.685896823469963*^9}, {3.685989071264306*^9, 
  3.685989088912842*^9}},ExpressionUUID->"47c26f05-2eb4-4321-93a9-\
c8378c622b50"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "0", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"forcesTo0", ",", 
     RowBox[{
      RowBox[{"Rbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685830106375854*^9, 3.685830111280898*^9}, {
  3.685830311743888*^9, 3.685830323825683*^9}, {3.6859889605406237`*^9, 
  3.685988971958437*^9}, {3.6859891158903027`*^9, 3.6859891343739853`*^9}},
 CellLabel->"In[69]:=",ExpressionUUID->"4df4310d-f92d-4662-8413-f01810319d84"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6858301134959297`*^9, {3.685830314294078*^9, 3.685830324233374*^9}, 
   3.685846221739214*^9, 3.685893290868232*^9, 3.685893364029952*^9, {
   3.685893951109572*^9, 3.6858939756631804`*^9}, 3.685894303880155*^9, 
   3.685894653591926*^9, 3.685895048818602*^9, 3.6858952038651543`*^9, 
   3.685896082036639*^9, 3.6859094754794483`*^9, 3.685909751659605*^9, 
   3.685987553858218*^9, 3.68598897294766*^9, 3.685989060203179*^9, 
   3.685989134806006*^9, 3.685990123407164*^9, 3.687122599237582*^9, 
   3.687123319381448*^9, 3.689440918956204*^9, 3.6894419683013153`*^9, 
   3.689537172031157*^9, 3.689633651000579*^9, 3.694813803591124*^9, 
   3.758414548376254*^9, 3.7585580448937197`*^9},
 CellLabel->"Out[69]=",ExpressionUUID->"5a8b4f63-5652-46d7-b7ac-5862a6759c0f"]
}, Open  ]],

Cell["\<\
If we turn off diffusion for cargo, center shouldn\[CloseCurlyQuote]t move. \
By adding the reaction forces on the cargo we\[CloseCurlyQuote]ve modeled the \
brownian forces on the anchors as coming from the cargo itself.\
\>", "Text",
 CellChangeTimes->{{3.685896826608658*^9, 3.685896877739759*^9}, {
  3.6858969745006113`*^9, 3.685896984412034*^9}, {3.6858973206075907`*^9, 
  3.685897324554768*^9}, {3.685897548610469*^9, 3.6858975908191633`*^9}, {
  3.685909543715473*^9, 
  3.685909592258353*^9}},ExpressionUUID->"6a2d80ec-40be-40e5-935f-\
6d8da9ad8291"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"forcesTo0", ",", 
     RowBox[{
      RowBox[{"Dbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}], ",", 
     RowBox[{
      RowBox[{"Rbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685896887955039*^9, 3.685896951483573*^9}, {
  3.6859891497079573`*^9, 3.6859892081738358`*^9}},
 CellLabel->"In[70]:=",ExpressionUUID->"b3f91b48-5d0c-4c6c-8678-ab406b9aa6af"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["dt"], " ", 
      SqrtBox[
       RowBox[{"DAnchor", "[", "0", "]"}]], " ", 
      RowBox[{
       RowBox[{"Dba", "[", "0", "]"}], "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["dt"], " ", 
      SqrtBox[
       RowBox[{"DAnchor", "[", "0", "]"}]], " ", 
      RowBox[{
       RowBox[{"Dba", "[", "0", "]"}], "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["dt"], " ", 
      SqrtBox[
       RowBox[{"DAnchor", "[", "0", "]"}]], " ", 
      RowBox[{
       RowBox[{"Dba", "[", "0", "]"}], "[", "2", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6858969538034267`*^9, 3.685909476200326*^9, 
  3.6859097522129707`*^9, 3.68598755455759*^9, 3.685989209723731*^9, 
  3.6859901235927973`*^9, 3.6871225994493637`*^9, 3.687123320266004*^9, 
  3.689440919159759*^9, 3.6894419687975063`*^9, 3.689537172224842*^9, 
  3.689633651418316*^9, 3.694813803788992*^9, 3.758414548581874*^9, 
  3.7585580451072197`*^9},
 CellLabel->"Out[70]=",ExpressionUUID->"1ec86766-7abb-44d0-a89d-b16e1391e21e"]
}, Open  ]],

Cell["\<\
Brownian motion of the cargo should move the anchors along with it\
\>", "Text",
 CellChangeTimes->{{3.685897647125134*^9, 
  3.6858976588813887`*^9}},ExpressionUUID->"c5e317a6-d289-4f07-b55c-\
9a613de96caa"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"forcesTo0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Dba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{"Rbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685897606682579*^9, 3.685897624490458*^9}, {
  3.685989229008772*^9, 3.685989257538666*^9}},
 CellLabel->"In[71]:=",ExpressionUUID->"e0107da5-fd61-40ba-981f-25657c3d1bd5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "0", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "1", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoTranslation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Dbc", "[", "2", "]"}]}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"theta", "[", "2", "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6858976323207417`*^9, 3.6859094764714746`*^9, 
  3.685909752775352*^9, 3.6859875547594757`*^9, 3.685989258372151*^9, 
  3.685990123776114*^9, 3.6871225996588097`*^9, 3.687123321170623*^9, 
  3.689440919363888*^9, 3.689441969291861*^9, 3.689537172416716*^9, 
  3.68963365188628*^9, 3.6948138039755373`*^9, 3.758414548790574*^9, 
  3.758558045371117*^9},
 CellLabel->"Out[71]=",ExpressionUUID->"58fa6fd5-0d22-43c2-9096-ec6d9f1b92c0"]
}, Open  ]],

Cell["\<\
Brownian rotation of cargo should move anchors but not center\
\>", "Text",
 CellChangeTimes->{{3.685897713736219*^9, 
  3.685897735144916*^9}},ExpressionUUID->"0ced8229-e793-4961-99b0-\
1fea0221975a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsStochastic", "[", "1", "]"}], "/.", 
  RowBox[{"Flatten", "[", 
   RowBox[{"{", 
    RowBox[{"forcesTo0", ",", 
     RowBox[{
      RowBox[{
       RowBox[{"Dba", "[", "x_", "]"}], "[", "y_", "]"}], "\[RuleDelayed]", 
      "0"}], ",", 
     RowBox[{
      RowBox[{"Dbc", "[", "x_", "]"}], "\[RuleDelayed]", "0"}]}], "}"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6858976968398933`*^9, 3.685897700956555*^9}, {
  3.685989276440806*^9, 3.685989285416732*^9}},
 CellLabel->"In[72]:=",ExpressionUUID->"3ca56db8-dace-4173-9351-cdd0c041cd21"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"c", "[", "2", "]"}]}], " ", 
         RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"c", "[", "1", "]"}], " ", 
         RowBox[{"Rbc", "[", "2", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Rbc", "[", "2", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Rbc", "[", "1", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "+", 
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"c", "[", "2", "]"}], " ", 
         RowBox[{"Rbc", "[", "0", "]"}]}], "-", 
        RowBox[{
         RowBox[{"c", "[", "0", "]"}], " ", 
         RowBox[{"Rbc", "[", "2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Rbc", "[", "2", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Rbc", "[", "0", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"c", "[", "1", "]"}]}], " ", 
         RowBox[{"Rbc", "[", "0", "]"}]}], "+", 
        RowBox[{
         RowBox[{"c", "[", "0", "]"}], " ", 
         RowBox[{"Rbc", "[", "1", "]"}]}], "-", 
        RowBox[{
         RowBox[{"Rbc", "[", "1", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
        RowBox[{
         RowBox[{"Rbc", "[", "0", "]"}], " ", 
         RowBox[{
          RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}]}], ")"}]}], "+", 
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "0", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "1", "]"}]}], ",", 
   RowBox[{
    RowBox[{"c1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{"c", "[", "2", "]"}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "0", "]"}]}], "+", 
     RowBox[{"theta", "[", "0", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
     RowBox[{"theta", "[", "1", "]"}]}]}], ",", 
   RowBox[{
    RowBox[{"theta1", "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{
      SqrtBox["2"], " ", 
      SqrtBox["DCargoRotation"], " ", 
      SqrtBox["dt"], " ", 
      RowBox[{"Rbc", "[", "2", "]"}]}], "+", 
     RowBox[{"theta", "[", "2", "]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6858977057893667`*^9, 3.685909476756806*^9, 
  3.685909753121841*^9, 3.685987555049252*^9, 3.685989286447761*^9, 
  3.685990123985132*^9, 3.687122599862096*^9, 3.68712332203612*^9, 
  3.689440919760607*^9, 3.6894419698031893`*^9, 3.689537172652817*^9, 
  3.689633652263363*^9, 3.694813804259183*^9, 3.758414548997807*^9, 
  3.758558045577547*^9},
 CellLabel->"Out[72]=",ExpressionUUID->"982d32c5-b681-4694-a5eb-dbe3d1ed5eea"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Generate c-like file", "Chapter",
 CellChangeTimes->{{3.685987538173353*^9, 
  3.685987547398225*^9}},ExpressionUUID->"0da68de9-6f50-4dfa-be17-\
432f8c35c6b5"],

Cell[CellGroupData[{

Cell["Generate solutions", "Section",
 CellChangeTimes->{{3.685990505698781*^9, 
  3.685990521955017*^9}},ExpressionUUID->"6231d0ec-9e9f-43e9-9616-\
cbf3f9ea63e4"],

Cell["\<\
Define the maximum number of motors we want to write equations for and \
generate the equations for each number of motors up to that one (including \
0). The equation generation can take a while\
\>", "Text",
 CellChangeTimes->{{3.685990780377955*^9, 3.685990816715549*^9}, {
  3.6859909029347897`*^9, 
  3.685990919641189*^9}},ExpressionUUID->"7d0ffc86-2f8e-47cf-b60e-\
5e1653060a58"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmax", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "0"}], ",", 
      RowBox[{"j", "\[LessEqual]", "nmax"}], ",", 
      RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"stochasticEqs", "[", "j", "]"}], "=", 
        RowBox[{"generateEqsStochastic", "[", "j", "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", "j"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.685990550013318*^9, 3.685990612438738*^9}, {
  3.685990881257484*^9, 3.685990881796736*^9}, {3.685990946068471*^9, 
  3.6859909462923803`*^9}, {3.6894409012714777`*^9, 3.689440901436007*^9}, {
  3.6894419328895683`*^9, 3.689441955681267*^9}, {3.6896335601310673`*^9, 
  3.689633560422171*^9}, {3.758414490096592*^9, 3.7584144904149113`*^9}, {
  3.758557839170553*^9, 3.7585578524333143`*^9}, {3.758557910158058*^9, 
  3.75855791478022*^9}, {3.758558009506205*^9, 3.758558019438808*^9}},
 CellLabel->"In[73]:=",ExpressionUUID->"92eecaca-a6f1-4a22-abb8-d4e6f6d44a67"],

Cell["Check an element", "Text",
 CellChangeTimes->{{3.6859908229927073`*^9, 
  3.685990827054187*^9}},ExpressionUUID->"121479e3-705a-4805-a3d3-\
d0506f02fbd9"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"stochasticEqs", "[", "1", "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.68599067388026*^9, 3.6859907308894253`*^9}},
 CellLabel->"In[75]:=",ExpressionUUID->"03f24149-8e56-4f97-b61d-847a274607c0"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox["DCargoTranslation"], " ", 
    SqrtBox["dt"], " ", 
    RowBox[{"Dbc", "[", "0", "]"}]}], "+", 
   RowBox[{
    RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "+", 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox["dt"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SqrtBox["DCargoRotation"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"c", "[", "2", "]"}]}], " ", 
          RowBox[{"Rbc", "[", "1", "]"}]}], "+", 
         RowBox[{
          RowBox[{"c", "[", "1", "]"}], " ", 
          RowBox[{"Rbc", "[", "2", "]"}]}], "-", 
         RowBox[{
          RowBox[{"Rbc", "[", "2", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
         RowBox[{
          RowBox[{"Rbc", "[", "1", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}], "+", 
      RowBox[{
       SqrtBox[
        RowBox[{"DAnchor", "[", "0", "]"}]], " ", 
       RowBox[{
        RowBox[{"Dba", "[", "0", "]"}], "[", "0", "]"}]}]}], ")"}]}], "+", 
   RowBox[{"dt", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"muAnchor", "[", "0", "]"}], " ", 
       RowBox[{
        RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
      RowBox[{"muCargoTranslation", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Fsteric", "[", "0", "]"}], "+", 
         RowBox[{"Ftrap", "[", "0", "]"}], "+", 
         RowBox[{
          RowBox[{"FmRadial", "[", "0", "]"}], "[", "0", "]"}], "+", 
         RowBox[{
          RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], ")"}]}],
       "+", 
      RowBox[{"muCargoRotation", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"TorqeExt", "[", "2", "]"}]}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
         RowBox[{
          RowBox[{"TorqeExt", "[", "1", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"c", "[", "1", "]"}], "2"], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"c", "[", "2", "]"}], "2"], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "2"], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
         RowBox[{
          SuperscriptBox[
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], "2"], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "1", "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
         RowBox[{
          RowBox[{"c", "[", "1", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TorqeExt", "[", "2", "]"}], "-", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], " ", 
             RowBox[{
              RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", 
                RowBox[{"c", "[", "0", "]"}]}], "+", 
               RowBox[{
                RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], ")"}], " ", 
             RowBox[{
              RowBox[{"FmTangential", "[", "0", "]"}], "[", "1", "]"}]}]}], 
           ")"}]}], "+", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "2", "]"}]}], "-", 
         RowBox[{
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], " ", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], " ", 
          RowBox[{
           RowBox[{"FmTangential", "[", "0", "]"}], "[", "2", "]"}]}], "-", 
         RowBox[{
          RowBox[{"c", "[", "2", "]"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"TorqeExt", "[", "1", "]"}], "+", 
            RowBox[{"2", " ", 
             RowBox[{
              RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], " ", 
             RowBox[{
              RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"c", "[", "0", "]"}], "-", 
               RowBox[{
                RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], ")"}], " ", 
             RowBox[{
              RowBox[{"FmTangential", "[", "0", "]"}], "[", "2", "]"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.685990679948995*^9, 3.6859907313187447`*^9}, 
   3.6859909978512383`*^9, 3.687122643075014*^9, 3.687123376302928*^9, 
   3.689441800343696*^9, 3.689456898425705*^9, 3.6896337730188093`*^9, 
   3.758507987551065*^9, 3.7586578207751503`*^9},
 CellLabel->"Out[75]=",ExpressionUUID->"c802063f-f7ae-4f0a-b428-46e339827dcd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Write solutions", "Section",
 CellChangeTimes->{{3.685990513731245*^9, 
  3.685990517882678*^9}},ExpressionUUID->"484b5fcb-0a07-4c06-82a3-\
e19766bc7069"],

Cell["\<\
Create and open a file to write to. If it already exists, delete the old one\
\>", "Text",
 CellChangeTimes->{{3.685989405081962*^9, 3.685989407972825*^9}, {
  3.6859895989977083`*^9, 3.685989632004455*^9}, {3.685989669647953*^9, 
  3.685989671356762*^9}},ExpressionUUID->"765af067-64d1-4e1a-97d3-\
15eec7d6e8ca"],

Cell[BoxData[{
 RowBox[{"DeleteFile", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
   "\"\<stochasticequations.c\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outfileLoc", "=", 
   RowBox[{"CreateFile", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<stochasticequations.c\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outfile", "=", 
   RowBox[{"File", "[", "outfileLoc", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.684098648719748*^9, 3.684098677654524*^9}, 
   3.6840991788294983`*^9, 3.68409921040814*^9, {3.684102465568993*^9, 
   3.684102482037467*^9}, {3.684102558481722*^9, 3.684102578910823*^9}, {
   3.684122712337173*^9, 3.684122713519846*^9}, {3.685825583032132*^9, 
   3.685825584651936*^9}, {3.685850341986755*^9, 3.685850358549972*^9}, {
   3.685989573640522*^9, 3.685989584440605*^9}},
 CellLabel->"In[76]:=",ExpressionUUID->"e8be5efe-9488-4889-8581-113677cc60e8"],

Cell["\<\
Write C function beginning lines to the equations for each number of motors \
in a switch case structure\
\>", "Text",
 CellChangeTimes->{{3.6840992130621567`*^9, 3.684099228238578*^9}, {
  3.685825660308721*^9, 3.685825661635256*^9}, {3.685989993825622*^9, 
  3.685990014762042*^9}},ExpressionUUID->"acd9450a-fdbf-4c97-ac76-\
ffe320993155"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<//prototypes\>\"", ",", "\"\<\\n\>\"", ",", 
    "\"\<void stochastic_equations();\>\"", ",", "\"\<\\n\\n\>\""}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"prototype", " ", "line"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<void stochastic_equations(){\>\"", ",", 
    "\"\<\\n\>\""}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"function", " ", "definition"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<    \>\"", ",", "\"\<switch(total_motors){\>\"", ",", 
    "\"\<\\n\>\""}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"declaration", " ", "of", " ", "switch", " ", "statement"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.684099231380281*^9, 3.684099240084999*^9}, {
  3.6840992762656183`*^9, 3.684099515878077*^9}, {3.6840996083649063`*^9, 
  3.684099671532875*^9}, {3.6840997024259577`*^9, 3.684099710873991*^9}, {
  3.68410043232519*^9, 3.684100434844616*^9}, {3.684100489632914*^9, 
  3.684100491769526*^9}, {3.684102822946341*^9, 3.684102824329294*^9}, {
  3.685388941745635*^9, 3.685388952817151*^9}, {3.685407473277313*^9, 
  3.685407474546224*^9}, {3.685825623847027*^9, 3.685825633602104*^9}, {
  3.685846086266388*^9, 3.68584610380118*^9}, {3.685989831493289*^9, 
  3.685989868850224*^9}},
 CellLabel->"In[79]:=",ExpressionUUID->"c17ebe84-64ac-43e4-aec5-19d76274621f"],

Cell["Write out equations for each number of motors up to some max", "Text",
 CellChangeTimes->{{3.685989691236011*^9, 
  3.6859897102478848`*^9}},ExpressionUUID->"09df5c82-6d31-4639-8776-\
388f4dfb962c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "for", " ", "all", " ", "numbers", " ", "of", " ", "motors", " ", "up", 
    " ", "to", " ", "nmax"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"For", "[", 
   RowBox[{
    RowBox[{"j", "=", "0"}], ",", 
    RowBox[{"j", "\[LessEqual]", "nmax"}], ",", 
    RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{
     "write", " ", "a", " ", "line", " ", "for", " ", "the", " ", "case", " ",
       "of", " ", "j", " ", "motors"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"WriteString", "[", 
      RowBox[{
      "outfile", ",", "\"\<        \>\"", ",", "\"\<case \>\"", ",", "j", 
       ",", "\"\<:\>\"", ",", "\"\<\\n\>\""}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "for", " ", "of", " ", "the", " ", "equations", " ", "in", " ", "the", 
        " ", "solution"}], ",", " ", 
       RowBox[{
        RowBox[{"convert", " ", "it", " ", "to", " ", "c"}], "-", 
        RowBox[{
        "ish", " ", "form", " ", "and", " ", "write", " ", "it", " ", "out", 
         " ", "to", " ", "the", " ", "file"}]}]}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", " ", 
        RowBox[{"3", 
         RowBox[{"(", 
          RowBox[{"j", "+", "2"}], ")"}]}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{"if", " ", 
          RowBox[{"it", "'"}], "s", " ", "a", " ", "line", " ", "with", " ", 
          "theta"}], ",", " ", 
         RowBox[{
         "comment", " ", "it", " ", "out", " ", "since", " ", "we", " ", 
          "never", " ", "use", " ", "the", " ", "value", " ", "of", " ", 
          "theta"}]}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{
           RowBox[{"i", "\[Equal]", " ", 
            RowBox[{"3", 
             RowBox[{"(", 
              RowBox[{"j", "+", "2"}], ")"}]}]}], "||", 
           RowBox[{"i", "\[Equal]", " ", 
            RowBox[{
             RowBox[{"3", 
              RowBox[{"(", 
               RowBox[{"j", "+", "2"}], ")"}]}], "-", "1"}]}], "||", 
           RowBox[{"i", "\[Equal]", " ", 
            RowBox[{
             RowBox[{"3", 
              RowBox[{"(", 
               RowBox[{"j", "+", "2"}], ")"}]}], "-", "2"}]}]}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<            \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"stochasticEqs", "[", "j", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<            \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"stochasticEqs", "[", "j", "]"}], "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], 
        ";"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
      "write", " ", "a", " ", "break", " ", "at", " ", "the", " ", "end", " ",
        "of", " ", "the", " ", "case"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"WriteString", "[", 
      RowBox[{
      "outfile", ",", "\"\<            \>\"", ",", "\"\<break;\>\"", ",", 
       "\"\<\\n\\n\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.684098684247036*^9, 3.684098766686006*^9}, {
   3.684098856697693*^9, 3.684098878004724*^9}, {3.684099061289969*^9, 
   3.6840991277763557`*^9}, 3.6840991935196753`*^9, {3.684099519804295*^9, 
   3.684099541348055*^9}, {3.6840997343083973`*^9, 3.684099816432733*^9}, {
   3.684100169619607*^9, 3.6841001736468277`*^9}, {3.684100402884281*^9, 
   3.684100411512261*^9}, {3.6841005086000032`*^9, 3.684100540493479*^9}, {
   3.68410061534379*^9, 3.684100657686246*^9}, {3.684100711764319*^9, 
   3.684100715138089*^9}, {3.685310680916917*^9, 3.685310683885453*^9}, {
   3.6853114763699017`*^9, 3.685311479619326*^9}, {3.685407221763399*^9, 
   3.685407221799777*^9}, {3.685465676220456*^9, 3.685465676259206*^9}, {
   3.6854659373040123`*^9, 3.685465953817956*^9}, {3.6854685904634333`*^9, 
   3.68546859084135*^9}, {3.685468806323731*^9, 3.6854688063796387`*^9}, {
   3.685471190990142*^9, 3.685471191024145*^9}, {3.6858090438046227`*^9, 
   3.685809117375259*^9}, {3.685809192345202*^9, 3.685809227111394*^9}, {
   3.685809340496956*^9, 3.685809353218791*^9}, {3.685809387948227*^9, 
   3.685809391389855*^9}, {3.685809431936461*^9, 3.685809437741338*^9}, {
   3.685809615973763*^9, 3.6858096344905577`*^9}, {3.68580970844851*^9, 
   3.685809710641583*^9}, {3.6858098008331947`*^9, 3.6858098265387697`*^9}, {
   3.685825718954495*^9, 3.6858257450769653`*^9}, {3.685826976061697*^9, 
   3.685826976116604*^9}, {3.685989715424526*^9, 3.685989807156097*^9}, {
   3.6859898931505423`*^9, 3.685989980304138*^9}, {3.6859901054725103`*^9, 
   3.685990105549755*^9}, {3.685990261700066*^9, 3.685990273579719*^9}, {
   3.685990308897138*^9, 3.685990378237952*^9}, {3.6859904640868073`*^9, 
   3.685990466865103*^9}, {3.6859906369764147`*^9, 3.6859906690155983`*^9}, {
   3.685990742219083*^9, 3.685990772099668*^9}, {3.689460999388219*^9, 
   3.6894609994202967`*^9}, {3.689523539530192*^9, 3.689523541138032*^9}, {
   3.689633599162031*^9, 3.689633599394136*^9}},
 CellLabel->"In[82]:=",ExpressionUUID->"09e8dba6-bbb3-4bf4-a275-4f494973a25c"],

Cell["Finish case structure and function", "Text",
 CellChangeTimes->{{3.685990028971142*^9, 
  3.6859900437981052`*^9}},ExpressionUUID->"1594dd97-a785-42fd-89cc-\
6fbc6cd99784"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<        \>\"", ",", "\"\<default:\>\"", ",", 
    "\"\<\\n\>\"", ",", "\"\<            \>\"", ",", 
    "\"\<printf(\\\"Bad value for total_motors\\\\n\\\");\>\"", ",", 
    "\"\<\\n\>\""}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "write", " ", "default", " ", "case", " ", "with", " ", "error", " ", 
    "statement"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"WriteString", "[", 
  RowBox[{
  "outfile", ",", "\"\<            \>\"", ",", "\"\<exit(0);\>\"", ",", 
   "\"\<\\n\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"outfile", ",", "\"\<    }\\n\>\"", ",", "\"\<}\\n\>\""}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "write", " ", "the", " ", "bracket", " ", "to", " ", "end", " ", "the", 
    " ", "function"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.684099840640665*^9, 3.684099931812181*^9}, {
  3.6840999744158993`*^9, 3.68409998222359*^9}, {3.684100043368163*^9, 
  3.684100084620983*^9}, {3.6841001168977137`*^9, 3.684100160693183*^9}, {
  3.684100202273947*^9, 3.6841002029258747`*^9}, {3.684100279347612*^9, 
  3.684100298168747*^9}, {3.684100370877803*^9, 3.6841003714731607`*^9}, {
  3.684100419881982*^9, 3.6841004213560467`*^9}, {3.684100523328725*^9, 
  3.684100531020879*^9}, {3.684100563084326*^9, 3.684100566716979*^9}, {
  3.685416480599662*^9, 3.685416481870009*^9}, {3.6859900521466017`*^9, 
  3.685990087909483*^9}, {3.689443929058951*^9, 3.6894439521319942`*^9}},
 CellLabel->"In[83]:=",ExpressionUUID->"0c06c231-faad-47e6-807e-b78e24a83221"],

Cell["Finally, close the file", "Text",
 CellChangeTimes->{{3.6859900917003107`*^9, 
  3.685990094411708*^9}},ExpressionUUID->"3327ddd3-de0c-42c3-a6ab-\
121cd909cfd6"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Close", "[", "outfile", "]"}]], "Input",
 CellLabel->"In[86]:=",ExpressionUUID->"3db24310-18da-423d-aa94-648836d88e5e"],

Cell[BoxData["\<\"/Users/Matt/project_code/Motor_Freedom/tools/\
stochasticequations.c\"\>"], "Output",
 CellChangeTimes->{{3.684100300257049*^9, 3.6841003123613777`*^9}, 
   3.684100438657907*^9, 3.684100553368664*^9, 3.6841005843912697`*^9, 
   3.684100673530526*^9, {3.684100722534998*^9, 3.684100732493864*^9}, 
   3.684102391742468*^9, 3.684102594087244*^9, 3.6841028306272573`*^9, 
   3.684121002174754*^9, 3.684122725655195*^9, 3.684123019930887*^9, 
   3.6841233523696623`*^9, 3.685310548666443*^9, {3.685310618702059*^9, 
   3.6853106288145733`*^9}, 3.68531069968434*^9, {3.685310957682103*^9, 
   3.685310969501884*^9}, 3.685311255730791*^9, 3.685311402237832*^9, 
   3.6853115071808147`*^9, 3.685312010253036*^9, 3.685312841126239*^9, {
   3.685312985680805*^9, 3.6853130014500933`*^9}, 3.685314857065839*^9, 
   3.685316608044868*^9, 3.6853218660793743`*^9, 3.685389151945215*^9, 
   3.685407229598117*^9, 3.685407515813778*^9, 3.685416503740095*^9, {
   3.6854656908324947`*^9, 3.685465700600263*^9}, 3.685466038857834*^9, 
   3.685468637688806*^9, {3.685468811556815*^9, 3.6854688194929333`*^9}, 
   3.6854712321194677`*^9, 3.685809145536249*^9, 3.68580927994246*^9, 
   3.6858093874017143`*^9, 3.685809471968864*^9, 3.685809749058251*^9, 
   3.685825770949732*^9, 3.6858269969894533`*^9, 3.685827299476267*^9, 
   3.685829988554552*^9, 3.685830042478118*^9, 3.685846229066922*^9, 
   3.685893310046109*^9, 3.685893370932152*^9, {3.685893963828843*^9, 
   3.6858939863996572`*^9}, 3.68589432124051*^9, 3.685894669222761*^9, 
   3.685895064162703*^9, 3.685895219296137*^9, 3.685896097772681*^9, 
   3.685909484995805*^9, 3.685909759388433*^9, 3.6859901587780323`*^9, 
   3.6859908424946938`*^9, 3.685990997927788*^9, 3.687122643313582*^9, 
   3.6871233764811697`*^9, 3.689441800639526*^9, 3.6894568993827457`*^9, 
   3.689633773211581*^9, 3.7585079905361767`*^9, 3.7586578236428957`*^9},
 CellLabel->"Out[86]=",ExpressionUUID->"ae373bcc-1bcd-43b2-8895-8ac3b7ee2e56"]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Bead-Like Version", "Chapter",
 CellChangeTimes->{{3.6895235887477293`*^9, 3.689523593730813*^9}, {
  3.689523754830261*^9, 
  3.689523756911421*^9}},ExpressionUUID->"ce3f56b5-2482-4e86-a3a7-\
da3ff3ff34ff"],

Cell[CellGroupData[{

Cell["Generate equations", "Subsection",
 CellChangeTimes->{{3.748788225857271*^9, 
  3.7487882287254868`*^9}},ExpressionUUID->"61269e3e-7bad-4f06-ae4f-\
e3ca38622d94"],

Cell["\<\
The stochastic version of the equations is workable up to about 20 motors on \
the cargo, but after that it starts to take a very long time to generate more \
equations (more than overnight to get the equations from 20 motors to 30 \
motors). In some situations, we\[CloseCurlyQuote]ll only need a cargo with \
motors stuck on it statically, for which the equations are less complicated \
and should be easier to generate.\
\>", "Text",
 CellChangeTimes->{{3.689523597263177*^9, 
  3.689523750881422*^9}},ExpressionUUID->"29ace1a7-7689-496e-803f-\
7d3981de32d9"],

Cell["\<\
Sum of forces on cargo, now excluding drag forces from anchors in the membrane\
\>", "Text",
 CellChangeTimes->{{3.685828111406816*^9, 3.68582811720042*^9}, {
  3.6948913818182*^9, 
  3.6948913969367237`*^9}},ExpressionUUID->"e57cfd1a-6846-40ee-9d8b-\
5a322f0bfec8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumForcesCargoBead", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Thread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fbc", "[", "0", "]"}], ",", 
       RowBox[{"Fbc", "[", "1", "]"}], ",", 
       RowBox[{"Fbc", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"brownian", " ", "force", " ", "on", " ", "the", " ", "cargo"}],
       "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Ftrap", "[", "0", "]"}], ",", 
       RowBox[{"Ftrap", "[", "1", "]"}], ",", 
       RowBox[{"Ftrap", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"external", " ", "force", " ", "on", " ", "the", " ", "cargo"}],
       "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Fsteric", "[", "0", "]"}], ",", 
       RowBox[{"Fsteric", "[", "1", "]"}], ",", 
       RowBox[{"Fsteric", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"steric", " ", "force", " ", "on", " ", "the", " ", "cargo"}], 
      "*)"}], "\[IndentingNewLine]", "-", 
     RowBox[{"xiCargoTranslation", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"vc", "[", "0", "]"}], ",", 
        RowBox[{"vc", "[", "1", "]"}], ",", 
        RowBox[{"vc", "[", "2", "]"}]}], "}"}]}], 
     RowBox[{"(*", 
      RowBox[{
      "drag", " ", "force", " ", "on", " ", "the", " ", "cargo", " ", "from", 
       " ", "the", " ", "water"}], "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"(*", 
      RowBox[{"anchor", " ", "forces"}], "*)"}], 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "0", "]"}], ",", 
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"FmRadial", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "+", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"FmTangential", "[", "i", "]"}], "[", "0", "]"}], ",", 
          RowBox[{
           RowBox[{"FmTangential", "[", "i", "]"}], "[", "1", "]"}], ",", 
          RowBox[{
           RowBox[{"FmTangential", "[", "i", "]"}], "[", "2", "]"}]}], 
         "}"}]}], 
       RowBox[{"(*", 
        RowBox[{"motor", " ", "force", " ", "on", " ", "the", " ", "cargo"}], 
        "*)"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.68582064176493*^9, 3.685820733273151*^9}, {
  3.685908611545021*^9, 3.685908706643835*^9}, {3.685908751043458*^9, 
  3.685908800396866*^9}, {3.68590891563048*^9, 3.6859089572215023`*^9}, {
  3.689528880463039*^9, 3.6895288809239807`*^9}, {3.6895303934081087`*^9, 
  3.689530398413322*^9}, {3.6895380072461033`*^9, 3.6895380342120934`*^9}},
 CellLabel->"In[87]:=",ExpressionUUID->"d1743019-459c-450d-ae75-1a049eda545c"],

Cell["\<\
Sum of torques on cargo, also excluding drag forces from anchors in the \
membrane\
\>", "Text",
 CellChangeTimes->{{3.685828120856576*^9, 3.6858281304641237`*^9}, {
  3.694891408288642*^9, 
  3.6948914123042517`*^9}},ExpressionUUID->"3ab9f434-6599-4ee8-b863-\
5fe5ba326228"],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumTorquesCargoBead", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}], "\[Equal]", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"Tbc", "[", "0", "]"}], ",", 
       RowBox[{"Tbc", "[", "1", "]"}], ",", 
       RowBox[{"Tbc", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"brownian", " ", "torque", " ", "on", " ", "cargo"}], "*)"}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"TorqeExt", "[", "0", "]"}], ",", 
       RowBox[{"TorqeExt", "[", "1", "]"}], ",", 
       RowBox[{"TorqeExt", "[", "2", "]"}]}], "}"}], 
     RowBox[{"(*", 
      RowBox[{"external", " ", "torque", " ", "on", " ", "cargo"}], "*)"}], 
     "\[IndentingNewLine]", "-", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"omega", "[", "0", "]"}], ",", 
        RowBox[{"omega", "[", "1", "]"}], ",", 
        RowBox[{"omega", "[", "2", "]"}]}], "}"}], "xiCargoRotation"}], 
     RowBox[{"(*", 
      RowBox[{
      "rotational", " ", "drag", " ", "on", " ", "rotating", " ", "cargo", 
       " ", "from", " ", "water"}], "*)"}], "\[IndentingNewLine]", "+", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"Cross", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
            RowBox[{
             RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
            RowBox[{
             RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"c", "[", "0", "]"}], ",", 
            RowBox[{"c", "[", "1", "]"}], ",", 
            RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"FmTangential", "[", "i", "]"}], "[", "0", "]"}], ",", 
           RowBox[{
            RowBox[{"FmTangential", "[", "i", "]"}], "[", "1", "]"}], ",", 
           RowBox[{
            RowBox[{"FmTangential", "[", "i", "]"}], "[", "2", "]"}]}], 
          "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "0", ",", 
         RowBox[{"nmotors", "-", "1"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.685820821629675*^9, 3.6858208555489264`*^9}, {
  3.685909038468484*^9, 3.685909089712001*^9}, {3.68590922797404*^9, 
  3.6859092331715307`*^9}, {3.685909331351536*^9, 3.685909427998534*^9}, {
  3.689528884445437*^9, 3.6895288849063787`*^9}, {3.6895304094949417`*^9, 
  3.6895304117562103`*^9}, {3.689530443897952*^9, 3.6895304862651033`*^9}},
 CellLabel->"In[88]:=",ExpressionUUID->"5bca1c95-7bc8-4d08-adae-7b94c4048894"],

Cell["\<\
Velocity variables to solve for - note we don\[CloseCurlyQuote]t have anchor \
locations here, we\[CloseCurlyQuote]ll get to those later.\
\>", "Text",
 CellChangeTimes->{{3.685828139160968*^9, 3.685828146022786*^9}, {
  3.694891417220356*^9, 
  3.694891436367902*^9}},ExpressionUUID->"5bfdb3d1-8109-4c0d-bd42-\
3ef98b1c7af4"],

Cell[BoxData[
 RowBox[{"velvarsBead", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"vc", "[", "0", "]"}], ",", 
    RowBox[{"vc", "[", "1", "]"}], ",", 
    RowBox[{"vc", "[", "2", "]"}], ",", 
    RowBox[{"omega", "[", "0", "]"}], ",", 
    RowBox[{"omega", "[", "1", "]"}], ",", 
    RowBox[{"omega", "[", "2", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{
  3.685824185302882*^9, {3.689529876494774*^9, 3.689529896788726*^9}},
 CellLabel->"In[89]:=",ExpressionUUID->"990ce07e-61eb-497a-a778-5721e22ef62b"],

Cell["Discretized variables to solve for", "Text",
 CellChangeTimes->{{3.68582814934149*^9, 
  3.685828156563992*^9}},ExpressionUUID->"7297134e-880b-46dd-b82e-\
c33311c17e90"],

Cell[BoxData[
 RowBox[{"discvarsBead", ":=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"c1", "[", "0", "]"}], ",", 
    RowBox[{"c1", "[", "1", "]"}], ",", 
    RowBox[{"c1", "[", "2", "]"}], ",", 
    RowBox[{"theta1", "[", "0", "]"}], ",", 
    RowBox[{"theta1", "[", "1", "]"}], ",", 
    RowBox[{"theta1", "[", "2", "]"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.685824128996464*^9, 3.68582413403589*^9}, 
   3.685824187709579*^9, {3.689529915509563*^9, 3.689529928457402*^9}},
 CellLabel->"In[90]:=",ExpressionUUID->"086c5068-4317-43fb-bc2c-4c93cc7bf662"],

Cell["\<\
Similar to above, solve for the discretized next location and orientation of \
the bead\
\>", "Text",
 CellChangeTimes->{{3.6948914415660048`*^9, 3.6948914589916277`*^9}, {
  3.694891710350071*^9, 
  3.69489172157689*^9}},ExpressionUUID->"e8b76be9-326b-4714-9677-\
9fc7123b8a53"],

Cell[BoxData[
 RowBox[{
  RowBox[{"generateEqsBead", "[", "nmotors_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "eqs", ",", "i", ",", "veleqs", ",", "disceqs", ",", "coeff", ",", 
      "coeffinv", ",", "const", ",", "soln"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"eqs", "=", 
      RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumForcesCargoBead", "[", "nmotors", "]"}], ",", "eqs"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"eqs", "=", 
      RowBox[{"Join", "[", 
       RowBox[{
        RowBox[{"sumTorquesCargoBead", "[", "nmotors", "]"}], ",", "eqs"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"const", ",", "coeff"}], "}"}], "=", 
      RowBox[{"Normal", "@", 
       RowBox[{"CoefficientArrays", "[", 
        RowBox[{"eqs", ",", "velvarsBead"}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"coeffinv", "=", 
      RowBox[{"Inverse", "[", "coeff", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"veleqs", "=", 
      RowBox[{"Thread", "[", 
       RowBox[{"velvarsBead", "\[Equal]", 
        RowBox[{"coeffinv", ".", 
         RowBox[{"-", "const"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"disceqs", "=", 
      RowBox[{"veleqs", "/.", 
       RowBox[{"Join", "[", 
        RowBox[{"discRules", ",", "brownianRules", ",", "xi2muRules"}], 
        "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"soln", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Solve", "[", 
         RowBox[{"disceqs", ",", "discvarsBead"}], "]"}], "//", "First"}], "//",
        "Simplify"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Thread", "[", 
      RowBox[{"discvarsBead", "==", 
       RowBox[{"Evaluate", "[", 
        RowBox[{"discvarsBead", "/.", "soln"}], "]"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.685752021873514*^9, 3.68575204526968*^9}, {
   3.68575208770603*^9, 3.6857521842190332`*^9}, {3.685752228757876*^9, 
   3.6857522323234243`*^9}, {3.685752264543935*^9, 3.685752284658534*^9}, {
   3.685752351179758*^9, 3.685752354430645*^9}, {3.685753459086227*^9, 
   3.685753531086829*^9}, {3.685820203075674*^9, 3.685820300949844*^9}, {
   3.685820336995573*^9, 3.685820351371944*^9}, 3.685820517706642*^9, {
   3.685820628818067*^9, 3.685820635541727*^9}, 3.685820677745757*^9, {
   3.685820782413342*^9, 3.6858208161300383`*^9}, {3.6858208774524727`*^9, 
   3.685820881217555*^9}, {3.685820923690524*^9, 3.6858209301028633`*^9}, {
   3.685821247565405*^9, 3.685821259354423*^9}, {3.685822755308692*^9, 
   3.685822811748394*^9}, {3.685824425209546*^9, 3.685824484230485*^9}, {
   3.6858268700985003`*^9, 3.6858268958146467`*^9}, {3.685827246218122*^9, 
   3.685827246250827*^9}, {3.685829704459293*^9, 3.685829752018261*^9}, {
   3.685829836815978*^9, 3.685829838378912*^9}, {3.6895237917653303`*^9, 
   3.689523826707559*^9}, {3.6895258147007217`*^9, 3.689525826231224*^9}, {
   3.689526094815325*^9, 3.689526241276342*^9}, {3.689528232217679*^9, 
   3.689528276598075*^9}, {3.6895283785683193`*^9, 3.6895283871515007`*^9}, {
   3.6895285993733807`*^9, 3.6895286105536633`*^9}, {3.6895286685596313`*^9, 
   3.689528702792007*^9}, {3.689528736464991*^9, 3.6895287426618977`*^9}, {
   3.68952880251305*^9, 3.689528819004177*^9}, {3.689529006732106*^9, 
   3.689529008869536*^9}, {3.689529757684873*^9, 3.689529824103395*^9}, {
   3.689529940281693*^9, 3.6895299946637087`*^9}, {3.6895343210462217`*^9, 
   3.689534321225415*^9}, {3.689537355243432*^9, 3.689537356266573*^9}, 
   3.6895373988035727`*^9},
 CellLabel->"In[91]:=",ExpressionUUID->"b330700c-5b1f-4b39-9cfc-3b2f1fb0c72b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Rotation", "Subsection",
 CellChangeTimes->{{3.748788799583796*^9, 
  3.748788800550531*^9}},ExpressionUUID->"6b933144-f069-4b15-a2d6-\
2b0043ee3f55"],

Cell["\<\
Now, to take care of the anchors. If there is no rotation, we can just add \
the amount the bead translated.\
\>", "Text",
 CellChangeTimes->{{3.694891728001309*^9, 
  3.694891756013215*^9}},ExpressionUUID->"86b8a7de-451d-4c8a-bca2-\
233ef5a29571"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nextAnchorLocationBead0", "[", "i_", "]"}], ":=", 
  RowBox[{"Thread", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a1", "[", "i", "]"}], "[", "0", "]"}], ",", 
      RowBox[{
       RowBox[{"a1", "[", "i", "]"}], "[", "1", "]"}], ",", 
      RowBox[{
       RowBox[{"a1", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "\[Equal]", 
    RowBox[{"(*", 
     RowBox[{"previous", " ", "location"}], "*)"}], 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
       RowBox[{
        RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
       RowBox[{
        RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], 
     "\[IndentingNewLine]", "+", 
     RowBox[{"(*", 
      RowBox[{"change", " ", "in", " ", "cargo", " ", "position"}], "*)"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c1", "[", "0", "]"}], ",", 
         RowBox[{"c1", "[", "1", "]"}], ",", 
         RowBox[{"c1", "[", "2", "]"}]}], "}"}], "-", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"c", "[", "0", "]"}], ",", 
         RowBox[{"c", "[", "1", "]"}], ",", 
         RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ")"}]}]}], "]"}]}]], "Input",\

 CellChangeTimes->{{3.689534538459046*^9, 3.68953457208256*^9}, {
   3.6895346048265944`*^9, 3.6895347355392103`*^9}, {3.6895348209720917`*^9, 
   3.689534865994645*^9}, {3.689534899532662*^9, 3.689534964443421*^9}, {
   3.6895354070744057`*^9, 3.6895354844861803`*^9}, {3.689535520203862*^9, 
   3.689535560354776*^9}, {3.689535606311481*^9, 3.689535656440773*^9}, 
   3.689535705648302*^9, {3.68953574025309*^9, 3.6895357449899607`*^9}, {
   3.68953579721297*^9, 3.689535799101924*^9}, {3.689535842595084*^9, 
   3.689535843663145*^9}, {3.6895359789214993`*^9, 3.689535981565387*^9}, {
   3.691175877066813*^9, 3.6911758873933573`*^9}},
 CellLabel->"In[92]:=",ExpressionUUID->"aabca389-c635-41fb-8997-093f213a6bed"],

Cell["\<\
If the bead rotated, we have to do a little more work. In addition to \
translation, we change the anchor locations by rotating them by a rotation \
matrix derived from the thetas we solved for. This means we need to convert \
the axis & angle (thetas) to a rotation matrix. Mathematica can help with \
this:\
\>", "Text",
 CellChangeTimes->{{3.694891760535461*^9, 
  3.6948919094063663`*^9}},ExpressionUUID->"1040278b-b9e2-4084-8883-\
e59bfab5896b"],

Cell["General rotation matrix, simplified for real entries", "Text",
 CellChangeTimes->{{3.694891916561874*^9, 
  3.6948919401188307`*^9}},ExpressionUUID->"6699f93a-c398-42c5-9af1-\
ee7dad100b91"],

Cell[BoxData[
 RowBox[{
  RowBox[{"mat", "=", 
   RowBox[{"RotationMatrix", "[", 
    RowBox[{"\[CapitalOmega]", ",", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Omega]", "x"], ",", 
       SubscriptBox["\[Omega]", "y"], ",", 
       SubscriptBox["\[Omega]", "z"]}], "}"}]}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6911665199578867`*^9, 3.691166576216812*^9}, {
   3.691171620530095*^9, 3.691171633034052*^9}, 3.691171703588664*^9, 
   3.691174995025234*^9},
 CellLabel->"In[93]:=",ExpressionUUID->"a203fa5d-4da0-42f1-9f1e-d824da62a912"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"matsimp", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{"mat", ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Omega]", "x"], ",", 
       SubscriptBox["\[Omega]", "y"], ",", 
       SubscriptBox["\[Omega]", "z"]}], "}"}], "\[Element]", "Reals"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.691166591730487*^9, 3.691166606232193*^9}, {
  3.691166869626656*^9, 3.691166877410488*^9}, {3.691174711446513*^9, 
  3.691174725496584*^9}, {3.691175002945077*^9, 3.691175009007122*^9}},
 CellLabel->"In[94]:=",ExpressionUUID->"e140337c-d699-41d5-a13b-85eb8463c84e"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "z", "2"]}], ")"}]}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "x"], " ", 
          SubscriptBox["\[Omega]", "y"]}], "-", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "z"], " ", 
          SqrtBox[
           RowBox[{
            SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
            SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
            SubsuperscriptBox["\[Omega]", "z", "2"]}]]}]}], ")"}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]], ",", 
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "x"], " ", 
          SubscriptBox["\[Omega]", "z"]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "y"], " ", 
          SqrtBox[
           RowBox[{
            SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
            SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
            SubsuperscriptBox["\[Omega]", "z", "2"]}]]}]}], ")"}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"Sin", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "x"], " ", 
          SubscriptBox["\[Omega]", "y"]}], "+", 
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "z"], " ", 
          SqrtBox[
           RowBox[{
            SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
            SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
            SubsuperscriptBox["\[Omega]", "z", "2"]}]]}]}], ")"}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], " ", 
        SubsuperscriptBox["\[Omega]", "x", "2"]}], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], " ", 
        SubsuperscriptBox["\[Omega]", "z", "2"]}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]], ",", 
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          FractionBox["\[CapitalOmega]", "2"], "]"}], "2"], " ", 
        SubscriptBox["\[Omega]", "y"], " ", 
        SubscriptBox["\[Omega]", "z"]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", "\[CapitalOmega]", "]"}], " ", 
        SubscriptBox["\[Omega]", "x"], " ", 
        SqrtBox[
         RowBox[{
          SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "z", "2"]}]]}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"Sin", "[", 
          FractionBox["\[CapitalOmega]", "2"], "]"}], "2"], " ", 
        SubscriptBox["\[Omega]", "x"], " ", 
        SubscriptBox["\[Omega]", "z"]}], "-", 
       RowBox[{
        RowBox[{"Sin", "[", "\[CapitalOmega]", "]"}], " ", 
        SubscriptBox["\[Omega]", "y"], " ", 
        SqrtBox[
         RowBox[{
          SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "z", "2"]}]]}]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]], ",", 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Sin", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "y"], " ", 
          SubscriptBox["\[Omega]", "z"]}], 
         RowBox[{
          SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
          SubsuperscriptBox["\[Omega]", "z", "2"]}]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"Cos", "[", 
           FractionBox["\[CapitalOmega]", "2"], "]"}], " ", 
          SubscriptBox["\[Omega]", "x"]}], 
         SqrtBox[
          RowBox[{
           SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
           SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
           SubsuperscriptBox["\[Omega]", "z", "2"]}]]]}], ")"}]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], " ", 
        SubsuperscriptBox["\[Omega]", "x", "2"]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], " ", 
        SubsuperscriptBox["\[Omega]", "y", "2"]}], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}], 
      RowBox[{
       SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
       SubsuperscriptBox["\[Omega]", "z", "2"]}]]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.691166613718129*^9, 3.6911668793807898`*^9, {3.691174672871846*^9, 
   3.691174726251483*^9}, {3.691175011053851*^9, 3.691175017429266*^9}, 
   3.691178601871182*^9, 3.691178647851969*^9, 3.691178803142549*^9, {
   3.691178995326764*^9, 3.691179014296371*^9}, 3.694813848216971*^9, 
   3.7487887391576233`*^9, 3.758507998068199*^9, 3.758657831567999*^9},
 CellLabel->"Out[94]=",ExpressionUUID->"f8f6243b-31f3-480c-a983-34e2f9f19f18"]
}, Open  ]],

Cell["Check it corresponds with what we know it should", "Text",
 CellChangeTimes->{{3.6948919462724867`*^9, 
  3.69489195704993*^9}},ExpressionUUID->"94983124-0fc8-4eaf-be90-\
645b685fa5d2"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"matsimp", "/.", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       SubscriptBox["\[Omega]", "x"], "\[Rule]", "0"}], ",", 
      RowBox[{
       SubscriptBox["\[Omega]", "y"], "\[Rule]", "0"}], ",", 
      RowBox[{
       SubscriptBox["\[Omega]", "z"], "\[Rule]", "1"}]}], "}"}]}], "//", 
   "FullSimplify"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.691171750728436*^9, 3.691171753730175*^9}, {
  3.691172235587734*^9, 3.69117226437584*^9}, {3.691172514429995*^9, 
  3.691172517215262*^9}, {3.691172625038744*^9, 3.6911726272509003`*^9}, {
  3.691175032003006*^9, 3.691175048787057*^9}},
 CellLabel->"In[95]:=",ExpressionUUID->"4e87111e-4ede-4912-a968-1c74c320f824"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{"-", 
       RowBox[{"Sin", "[", "\[CapitalOmega]", "]"}]}], "0"},
     {
      RowBox[{"Sin", "[", "\[CapitalOmega]", "]"}], 
      RowBox[{"Cos", "[", "\[CapitalOmega]", "]"}], "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6911722648819933`*^9, 3.691172517550068*^9, 3.691172627572398*^9, 
   3.691175050023797*^9, 3.69117860196268*^9, 3.6911786479065104`*^9, 
   3.691178803275221*^9, {3.691178995417976*^9, 3.691179014355851*^9}, 
   3.694813848600498*^9, 3.748788739912747*^9, 3.758507998194042*^9, 
   3.7586578316784277`*^9},
 CellLabel->
  "Out[95]//MatrixForm=",ExpressionUUID->"095aef67-7d1a-4654-8077-\
b9b39b36e9a7"]
}, Open  ]],

Cell["\<\
Put in the program syntax and simplify it further if possible\
\>", "Text",
 CellChangeTimes->{{3.694891967658678*^9, 
  3.694892018767449*^9}},ExpressionUUID->"eabfed23-7f91-4ee3-b7c0-\
a20ee7342810"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"simpnorm", "=", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"Norm", "[", 
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Omega]", "x"], ",", 
       SubscriptBox["\[Omega]", "y"], ",", 
       SubscriptBox["\[Omega]", "z"]}], "}"}], "]"}], ",", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Omega]", "x"], ",", 
       SubscriptBox["\[Omega]", "y"], ",", 
       SubscriptBox["\[Omega]", "z"]}], "}"}], "\[Element]", "Reals"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.691166964580158*^9, 3.6911670132762012`*^9}, {
  3.6911700903665247`*^9, 3.69117011425034*^9}, {3.6911750818189507`*^9, 
  3.691175085924721*^9}},
 CellLabel->"In[96]:=",ExpressionUUID->"50b9b483-fa71-48bb-ad78-0decb785fcdf"],

Cell[BoxData[
 SqrtBox[
  RowBox[{
   SubsuperscriptBox["\[Omega]", "x", "2"], "+", 
   SubsuperscriptBox["\[Omega]", "y", "2"], "+", 
   SubsuperscriptBox["\[Omega]", "z", "2"]}]]], "Output",
 CellChangeTimes->{{3.691166996215536*^9, 3.691167013746937*^9}, 
   3.691170115726864*^9, 3.691175087139516*^9, 3.691178602012438*^9, 
   3.691178647953261*^9, 3.6911788033252153`*^9, {3.691178995468719*^9, 
   3.691179014406046*^9}, 3.6948138486501503`*^9, 3.748788740096217*^9, 
   3.758507998264203*^9, 3.758657831736723*^9},
 CellLabel->"Out[96]=",ExpressionUUID->"d140cc57-03c5-46bc-ac4b-879fc609960d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rotmat", "=", 
  RowBox[{
   RowBox[{"matsimp", "/.", 
    RowBox[{"\[CapitalOmega]", "\[Rule]", "simpnorm"}]}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       SubscriptBox["\[Omega]", "x"], ",", 
       SubscriptBox["\[Omega]", "y"], ",", 
       SubscriptBox["\[Omega]", "z"]}], "}"}], "->", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"omega", "[", "0", "]"}], ",", 
       RowBox[{"omega", "[", "1", "]"}], ",", 
       RowBox[{"omega", "[", "2", "]"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.69116688326438*^9, 3.691166895387876*^9}, {
   3.6911670183271313`*^9, 3.691167057870839*^9}, {3.6911671024104147`*^9, 
   3.691167114818067*^9}, {3.691167157118064*^9, 3.691167161302965*^9}, 
   3.691170139360635*^9, {3.6911750962413483`*^9, 3.691175132003231*^9}},
 CellLabel->"In[97]:=",ExpressionUUID->"80a7c27f-fbdd-4629-b05b-55ed510cd619"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}]], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "2", "]"}], "2"]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"omega", "[", "1", "]"}], " ", 
         RowBox[{"omega", "[", "2", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], "2"]}], 
        "-", 
        RowBox[{
         RowBox[{"omega", "[", "0", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"omega", "[", "0", "]"}], " ", 
         RowBox[{"omega", "[", "2", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], "2"]}], 
        "-", 
        RowBox[{
         RowBox[{"omega", "[", "1", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"omega", "[", "0", "]"}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"omega", "[", "1", "]"}], " ", 
          RowBox[{"omega", "[", "2", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "1", "]"}], "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.691166888506033*^9, 3.691167059419135*^9, 3.691167115641041*^9, 
   3.691167174770357*^9, 3.691170141246707*^9, 3.691175097411887*^9, 
   3.691175132829554*^9, 3.691178602056418*^9, 3.691178648000985*^9, 
   3.691178803372175*^9, {3.6911789955224123`*^9, 3.6911790144606733`*^9}, 
   3.6948138486997833`*^9, 3.748788740179347*^9, 3.758507998338492*^9, 
   3.758657831796936*^9},
 CellLabel->"Out[97]=",ExpressionUUID->"86190b54-9e88-4330-90c7-c8533a1a9528"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "rotmat", "]"}]], "Input",
 CellChangeTimes->{{3.691167245690151*^9, 3.69116724979622*^9}},
 CellLabel->"In[98]:=",ExpressionUUID->"d0c291c6-634b-4023-8719-c5a2aa820dba"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", 
            RowBox[{"Cos", "[", 
             RowBox[{
              FractionBox["1", "2"], " ", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], 
         ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], 
         ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]]},
     {
      FractionBox[
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], 
         ")"}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "2", "]"}], "2"]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"omega", "[", "1", "]"}], " ", 
         RowBox[{"omega", "[", "2", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], "2"]}], 
        "-", 
        RowBox[{
         RowBox[{"omega", "[", "0", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", 
         RowBox[{"omega", "[", "0", "]"}], " ", 
         RowBox[{"omega", "[", "2", "]"}], " ", 
         SuperscriptBox[
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], "2"]}], 
        "-", 
        RowBox[{
         RowBox[{"omega", "[", "1", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}]}], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], ")"}]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"]}], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         SuperscriptBox[
          RowBox[{"omega", "[", "1", "]"}], "2"]}], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6911672501083508`*^9, 3.6911701489716063`*^9, 3.6911751386194353`*^9, 
   3.691178602125866*^9, 3.691178648071301*^9, 3.69117880343764*^9, {
   3.691178995587976*^9, 3.691179014560678*^9}, 3.69481384878434*^9, 
   3.748788740458246*^9, 3.758507998420662*^9, 3.758657831865946*^9},
 CellLabel->
  "Out[98]//MatrixForm=",ExpressionUUID->"39d72b3f-697b-4b7a-93e9-\
1504d7f4a9f8"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"simprotmat", "=", 
  RowBox[{"FullSimplify", "[", "rotmat", "]"}]}]], "Input",
 CellChangeTimes->{{3.691167178685166*^9, 3.691167216146216*^9}, {
  3.69116725634311*^9, 3.6911672580807257`*^9}, {3.691167322313026*^9, 
  3.691167330816963*^9}},
 CellLabel->"In[99]:=",ExpressionUUID->"5ef5ab2d-32fa-4559-9635-5b4046c9f7fd"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}]], ",", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
           " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "2", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
           RowBox[{"Sin", "[", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}]}], 
         " ", 
         RowBox[{"omega", "[", "0", "]"}], " ", 
         RowBox[{"omega", "[", "2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"omega", "[", "1", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}]}], 
         " ", 
         RowBox[{"omega", "[", "0", "]"}], " ", 
         RowBox[{"omega", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"omega", "[", "2", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ",", 
     FractionBox[
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}]], ",", 
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
           " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
           RowBox[{"Sin", "[", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ")"}]}]}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
           " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
           RowBox[{"Sin", "[", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], 
        "/", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], ")"}]}], ",", 
     RowBox[{"2", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{
        FractionBox["1", "2"], " ", 
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
      RowBox[{"(", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"Cos", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
          RowBox[{"omega", "[", "0", "]"}]}], 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]]], "+", 
        FractionBox[
         RowBox[{
          RowBox[{"omega", "[", "1", "]"}], " ", 
          RowBox[{"omega", "[", "2", "]"}], " ", 
          RowBox[{"Sin", "[", 
           RowBox[{
            FractionBox["1", "2"], " ", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}], 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], ")"}]}], ",", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"Cos", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"]}], ")"}]}], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{
  3.691167184645104*^9, 3.691167227138487*^9, 3.691167258627092*^9, 
   3.6911673318286133`*^9, 3.691170154736829*^9, 3.691175147299012*^9, 
   3.691178602790864*^9, 3.6911786488120728`*^9, 3.691178803940333*^9, {
   3.691178996385046*^9, 3.6911790153420258`*^9}, 3.6948138508204603`*^9, 
   3.7487887425365467`*^9, 3.758508000953619*^9, 3.758657834441411*^9},
 CellLabel->"Out[99]=",ExpressionUUID->"b2dbcee8-453d-49b5-8dc0-94e6f47db72d"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"MatrixForm", "[", "simprotmat", "]"}]], "Input",
 CellChangeTimes->{{3.69117033787586*^9, 3.691170343163741*^9}},
 CellLabel->
  "In[100]:=",ExpressionUUID->"b3550886-0b0d-4924-a791-7a37cff0910e"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
          " ", 
          RowBox[{"omega", "[", "0", "]"}], " ", 
          RowBox[{"omega", "[", "1", "]"}]}], "+", 
         RowBox[{
          RowBox[{"omega", "[", "2", "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
          RowBox[{"Sin", "[", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}]}], 
         " ", 
         RowBox[{"omega", "[", "0", "]"}], " ", 
         RowBox[{"omega", "[", "2", "]"}]}], "+", 
        RowBox[{
         RowBox[{"omega", "[", "1", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}]}], 
         " ", 
         RowBox[{"omega", "[", "0", "]"}], " ", 
         RowBox[{"omega", "[", "1", "]"}]}], "+", 
        RowBox[{
         RowBox[{"omega", "[", "2", "]"}], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
         RowBox[{"Sin", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      FractionBox[
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
          " ", 
          RowBox[{"omega", "[", "1", "]"}], " ", 
          RowBox[{"omega", "[", "2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"omega", "[", "0", "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
          RowBox[{"Sin", "[", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"omega", "[", "2", "]"}], "2"]}]]}]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"Cos", "[", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
          " ", 
          RowBox[{"omega", "[", "0", "]"}], " ", 
          RowBox[{"omega", "[", "2", "]"}]}], "+", 
         RowBox[{
          RowBox[{"omega", "[", "1", "]"}], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
          RowBox[{"Sin", "[", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], 
        RowBox[{
         SuperscriptBox[
          RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
         SuperscriptBox[
          RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], 
      RowBox[{"2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{
         FractionBox["1", "2"], " ", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}]}], 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]], "+", 
         FractionBox[
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}], 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], ")"}]}], 
      FractionBox[
       RowBox[{
        RowBox[{
         RowBox[{"Cos", "[", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"]}], ")"}]}], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}]]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.6911703434316463`*^9, 3.691175159954604*^9, 3.691178602840336*^9, 
   3.691178648851609*^9, 3.691178804005556*^9, {3.6911789964680643`*^9, 
   3.6911790154218903`*^9}, 3.6948138509333353`*^9, 3.7487887426709757`*^9, 
   3.758508001058359*^9, 3.758657834529708*^9},
 CellLabel->
  "Out[100]//MatrixForm=",ExpressionUUID->"c3ea22b0-b418-4629-a4b1-\
c5999daecae4"]
}, Open  ]],

Cell["\<\
Now, the next anchor location is given by the change due to the cargo \
translation, plus the change due to cargo rotation. For the rotation, we must \
translate the vector back to (0,0,0), rotate it, then translate it back.\
\>", "Text",
 CellChangeTimes->{{3.694892036598535*^9, 
  3.694892153778487*^9}},ExpressionUUID->"18dcdca6-8542-48d4-964c-\
5f5711e426f9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"nextAnchorLocationBead", "[", "i_", "]"}], ":=", 
  RowBox[{"Thread", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"a1", "[", "i", "]"}], "[", "0", "]"}], ",", 
      RowBox[{
       RowBox[{"a1", "[", "i", "]"}], "[", "1", "]"}], ",", 
      RowBox[{
       RowBox[{"a1", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "\[Equal]", 
    "\[IndentingNewLine]", 
    RowBox[{"Simplify", "[", 
     RowBox[{"(*", 
      RowBox[{"rotation", " ", "of", " ", "cargo"}], "*)"}], 
     RowBox[{
      RowBox[{"simprotmat", " ", ".", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{
            RowBox[{"a", "[", "i", "]"}], "[", "0", "]"}], ",", 
           RowBox[{
            RowBox[{"a", "[", "i", "]"}], "[", "1", "]"}], ",", 
           RowBox[{
            RowBox[{"a", "[", "i", "]"}], "[", "2", "]"}]}], "}"}], "-", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], ",", 
           RowBox[{"c", "[", "1", "]"}], ",", 
           RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ")"}]}], "+", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"c", "[", "0", "]"}], ",", 
        RowBox[{"c", "[", "1", "]"}], ",", 
        RowBox[{"c", "[", "2", "]"}]}], "}"}], "+", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"change", " ", "in", " ", "cargo", " ", "position"}], "*)"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c1", "[", "0", "]"}], ",", 
          RowBox[{"c1", "[", "1", "]"}], ",", 
          RowBox[{"c1", "[", "2", "]"}]}], "}"}], "-", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], ",", 
          RowBox[{"c", "[", "1", "]"}], ",", 
          RowBox[{"c", "[", "2", "]"}]}], "}"}]}], ")"}]}], "]"}]}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.691168999874055*^9, 3.691169070848284*^9}, {
  3.69116914416628*^9, 3.6911691515445833`*^9}, {3.6911691921467257`*^9, 
  3.6911692011005373`*^9}, {3.691169664532398*^9, 3.691169672193089*^9}, {
  3.691173102296533*^9, 3.691173108428508*^9}, {3.691178788908313*^9, 
  3.6911787936778603`*^9}, {3.6911789266978617`*^9, 3.691178930431992*^9}},
 CellLabel->
  "In[101]:=",ExpressionUUID->"cc6ebc6d-3f1b-49ed-8694-31916c169b60"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test rotation matrix version", "Section",
 CellChangeTimes->{{3.691169354100391*^9, 
  3.691169361940896*^9}},ExpressionUUID->"f6334ce8-4c5f-4b90-9113-\
9da5245d25d3"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nextAnchorLocationBead", "[", "0", "]"}]], "Input",
 CellChangeTimes->{{3.691169382208085*^9, 3.691169387231165*^9}, {
  3.691170310460235*^9, 3.6911703222390747`*^9}},
 CellLabel->
  "In[102]:=",ExpressionUUID->"7faddeea-8def-415d-b0a9-6dc375ac6aaa"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"c", "[", "0", "]"}]}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"c1", "[", "0", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"c", "[", "1", "]"}], " ", 
        RowBox[{"omega", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"c1", "[", "0", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"c", "[", "2", "]"}], " ", 
        RowBox[{"omega", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "2", "]"}]}], "+", 
       RowBox[{
        RowBox[{"c1", "[", "0", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"], " ", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
       RowBox[{
        RowBox[{"omega", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "1", "]"}], " ", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"omega", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "2", "]"}], " ", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], "-", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
        RowBox[{"Sin", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "2", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}]}], "-", 
          RowBox[{
           RowBox[{"c", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "-", 
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"c", "[", "2", "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "-", 
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "-", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "-", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"c1", "[", "1", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "0", "]"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"c", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "1", "]"}]}], "-", 
       RowBox[{
        RowBox[{"c", "[", "1", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"c1", "[", "1", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"]}], "-", 
       RowBox[{
        RowBox[{"c", "[", "2", "]"}], " ", 
        RowBox[{"omega", "[", "1", "]"}], " ", 
        RowBox[{"omega", "[", "2", "]"}]}], "+", 
       RowBox[{
        RowBox[{"c1", "[", "1", "]"}], " ", 
        SuperscriptBox[
         RowBox[{"omega", "[", "2", "]"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"omega", "[", "0", "]"}], " ", 
        RowBox[{"omega", "[", "1", "]"}], " ", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"omega", "[", "1", "]"}], "2"], " ", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
       RowBox[{
        RowBox[{"omega", "[", "1", "]"}], " ", 
        RowBox[{"omega", "[", "2", "]"}], " ", 
        RowBox[{
         RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], "+", 
       RowBox[{
        SqrtBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
        RowBox[{"Sin", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "2", "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}]}], "-", 
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "-", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"Cos", "[", 
         SqrtBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"c", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}]}], "+", 
          RowBox[{
           RowBox[{"c", "[", "2", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "-", 
          RowBox[{
           RowBox[{"c", "[", "1", "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "0", "]"}], "2"], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "+", 
          RowBox[{
           SuperscriptBox[
            RowBox[{"omega", "[", "2", "]"}], "2"], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], "-", 
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{
            RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}]}], ")"}]}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"c1", "[", "2", "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"Cos", "[", 
              SqrtBox[
               RowBox[{
                SuperscriptBox[
                 RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
                SuperscriptBox[
                 RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}], ")"}], 
           " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]], " ", 
           RowBox[{"Sin", "[", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}]}]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "[", "0", "]"}], "-", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}]}], ")"}]}], "-", 
       RowBox[{"2", " ", 
        RowBox[{"Sin", "[", 
         RowBox[{
          FractionBox["1", "2"], " ", 
          SqrtBox[
           RowBox[{
            SuperscriptBox[
             RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
            SuperscriptBox[
             RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}], " ", 
           RowBox[{"omega", "[", "0", "]"}], " ", 
           SqrtBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "+", 
          RowBox[{
           RowBox[{"omega", "[", "1", "]"}], " ", 
           RowBox[{"omega", "[", "2", "]"}], " ", 
           RowBox[{"Sin", "[", 
            RowBox[{
             FractionBox["1", "2"], " ", 
             SqrtBox[
              RowBox[{
               SuperscriptBox[
                RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
               SuperscriptBox[
                RowBox[{"omega", "[", "2", "]"}], "2"]}]]}], "]"}]}]}], ")"}],
         " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "[", "1", "]"}], "-", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"Cos", "[", 
            SqrtBox[
             RowBox[{
              SuperscriptBox[
               RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
              SuperscriptBox[
               RowBox[{"omega", "[", "2", "]"}], "2"]}]], "]"}], " ", 
           RowBox[{"(", 
            RowBox[{
             SuperscriptBox[
              RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
             SuperscriptBox[
              RowBox[{"omega", "[", "1", "]"}], "2"]}], ")"}]}], "+", 
          SuperscriptBox[
           RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"c", "[", "2", "]"}], "-", 
          RowBox[{
           RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}]}], ")"}]}]}], ")"}], 
     "/", 
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"omega", "[", "0", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "1", "]"}], "2"], "+", 
       SuperscriptBox[
        RowBox[{"omega", "[", "2", "]"}], "2"]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6911693884610443`*^9, 3.6911702047495823`*^9, {3.691170312300336*^9, 
   3.691170322720973*^9}, 3.691178609051744*^9, 3.691178656497231*^9, 
   3.691178845965578*^9, 3.691178936080535*^9, {3.691178996882538*^9, 
   3.691179015810013*^9}, 3.694813851595492*^9, 3.75850800180009*^9, 
   3.7586578352765102`*^9},
 CellLabel->
  "Out[102]=",ExpressionUUID->"53f1d3e1-ba24-41de-a300-2412b60ed69a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nextAnchorLocationBead", "[", "0", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"omega", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"omega", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"omega", "[", "2", "]"}], "\[Rule]", "Pi"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c1", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"c1", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c1", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.691169394881568*^9, 3.691169548443801*^9}, {
  3.691169602050109*^9, 3.6911696020830917`*^9}, {3.6911698221663637`*^9, 
  3.691169824573421*^9}, {3.691169955714546*^9, 3.691169989104185*^9}, {
  3.6911702105833197`*^9, 3.69117022993326*^9}, {3.691172922353491*^9, 
  3.691172927369928*^9}, {3.691173128531476*^9, 3.691173151457922*^9}, {
  3.691173191575757*^9, 3.691173270606242*^9}, {3.691175262211203*^9, 
  3.6911752721215143`*^9}},
 CellLabel->
  "In[103]:=",ExpressionUUID->"8c52153d-6936-4b54-9cbb-e7db977df2d4"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", "2"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", "0"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.691169549636314*^9, 3.69116960371618*^9, 3.6911696898515997`*^9, 
   3.691169825664865*^9, 3.691169956296318*^9, 3.691169989506824*^9, 
   3.691170231394102*^9, 3.691172927921238*^9, {3.691173119981124*^9, 
   3.691173153611908*^9}, {3.69117319265729*^9, 3.691173239086309*^9}, 
   3.6911732713760157`*^9, 3.6911751835701933`*^9, {3.691175263454906*^9, 
   3.691175272947053*^9}, 3.691178609110025*^9, 3.691178656552796*^9, 
   3.691178846015263*^9, 3.691178953709917*^9, {3.691178996938466*^9, 
   3.691179015860837*^9}, 3.6948138516508102`*^9, 3.758508001879108*^9, 
   3.7586578353428802`*^9},
 CellLabel->
  "Out[103]=",ExpressionUUID->"bd6160a8-46b4-4caf-bd39-1c6ed4225de9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"nextAnchorLocationBead", "[", "0", "]"}], "/.", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"omega", "[", "0", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"omega", "[", "1", "]"}], "\[Rule]", 
     RowBox[{"Pi", "/", "2"}]}], ",", 
    RowBox[{
     RowBox[{"omega", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "0", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"a", "[", "0", "]"}], "[", "2", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c", "[", "2", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c1", "[", "0", "]"}], "\[Rule]", "1"}], ",", 
    RowBox[{
     RowBox[{"c1", "[", "1", "]"}], "\[Rule]", "0"}], ",", 
    RowBox[{
     RowBox[{"c1", "[", "2", "]"}], "\[Rule]", "0"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.691180918786867*^9, 3.69118093339953*^9}},
 CellLabel->
  "In[104]:=",ExpressionUUID->"5789c292-6f9f-42b3-8a30-67ae76b66cc0"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "0", "]"}], "\[Equal]", "1"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "1", "]"}], "\[Equal]", "0"}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"a1", "[", "0", "]"}], "[", "2", "]"}], "\[Equal]", "1"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.691180924883718*^9, 3.691180933668387*^9}, 
   3.694813851703353*^9, 3.758508001950926*^9, 3.758657835403092*^9},
 CellLabel->
  "Out[104]=",ExpressionUUID->"cbc5230f-0c4c-4409-93cb-229efa903228"]
}, Open  ]],

Cell["\<\
This is probably the best test we can do here, since this version shouldn\
\[CloseCurlyQuote]t reduce to the stochastic version or anything.\
\>", "Text",
 CellChangeTimes->{{3.69489124468053*^9, 
  3.694891271679768*^9}},ExpressionUUID->"8c9fbc1d-8df6-4654-a643-\
b43cb5e2fcdd"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Write Bead File", "Chapter",
 CellChangeTimes->{{3.694813825074492*^9, 
  3.6948138325662603`*^9}},ExpressionUUID->"25a10489-fd95-4b38-9125-\
635781c33b5e"],

Cell[CellGroupData[{

Cell["Generate solutions for bead", "Section",
 CellChangeTimes->{{3.685990505698781*^9, 3.685990521955017*^9}, {
  3.6895382256191053`*^9, 
  3.689538227024633*^9}},ExpressionUUID->"03a2855a-b06e-40fc-b847-\
9317bb636e09"],

Cell["\<\
Define the maximum number of motors we want to write equations for and \
generate the equations for each number of motors up to that one (including \
0). The equation generation can take a while\
\>", "Text",
 CellChangeTimes->{{3.685990780377955*^9, 3.685990816715549*^9}, {
  3.6859909029347897`*^9, 
  3.685990919641189*^9}},ExpressionUUID->"3394c918-5d16-4205-ba2a-\
bacbe8278084"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"nmaxbead", "=", "30"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"iterator", "=", "1"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6948922004554367`*^9, 3.6948922381197433`*^9}, {
  3.75841450998562*^9, 3.758414510727693*^9}, {3.7585577801201973`*^9, 
  3.758557780883192*^9}},
 CellLabel->
  "In[105]:=",ExpressionUUID->"1f55b564-18ad-485c-b909-26e7ba0a574d"],

Cell[BoxData[
 RowBox[{"Monitor", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", "nmaxbead"}], ",", 
      RowBox[{"j", "=", 
       RowBox[{"j", "+", "iterator"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"beadEqs", "[", "j", "]"}], "=", 
        RowBox[{"generateEqsBead", "[", "j", "]"}]}], ";"}]}], 
     "\[IndentingNewLine]", "]"}], ";"}], "\[IndentingNewLine]", ",", "j"}], 
  "]"}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGCQBmIQLZV7QKii7LWjClefFIj2t9WwAdF36izB9CsDJxcQ
rRftCaY/rV9xgaf2tePRz2vBdET5nEBeIP3hTGkIiF6+Xz/CBkgn/30dCaK9
S6eeB9GiT6aB6a+690rtgPQOq3VlIDpruusheyD9/5sXmH4X7PUERN+55AOm
S5lCrzkA6aTb4WBa4KKBXwqQdtorHQSip6c+agDRp4S3NYJooel2bKlA+ua5
AxwgWkjcQBpElyySlQHRm6LiFUF0nXo+mD7TcdMrtuG144m+N2A6ruV4PYg+
cP40mBZJeFceB6RfKH8B079+zFoFon2Sl4Jpjv1TJ/u0A+1bMhdMl5bYMvgC
6fLnPmBarE2hHETv2XUdTJ94c8YwH0ifV7oAppXajaYVAelnV+3B9Ps1DLNA
tIaNHZhuKGZJfsjwxtHLvhNMAwDH0djz
  "],
 CellLabel->
  "In[107]:=",ExpressionUUID->"8a0a7b25-7f50-4958-94fc-5cdc2719d233"],

Cell["Check an element", "Text",
 CellChangeTimes->{{3.6859908229927073`*^9, 
  3.685990827054187*^9}},ExpressionUUID->"c3f65675-e1bb-4ca3-a950-\
1782d6af058a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"beadEqs", "[", "1", "]"}], "[", 
  RowBox[{"[", "1", "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.68599067388026*^9, 3.6859907308894253`*^9}, {
  3.689538261495512*^9, 3.689538263092286*^9}},
 CellLabel->
  "In[108]:=",ExpressionUUID->"cf0eb923-dcda-4a01-ab0a-b5ac3e1d6c05"],

Cell[BoxData[
 RowBox[{
  RowBox[{"c1", "[", "0", "]"}], "\[Equal]", 
  RowBox[{
   RowBox[{"c", "[", "0", "]"}], "+", 
   RowBox[{
    SqrtBox["2"], " ", 
    SqrtBox["DCargoTranslation"], " ", 
    SqrtBox["dt"], " ", 
    RowBox[{"Dbc", "[", "0", "]"}]}], "+", 
   RowBox[{"dt", " ", "muCargoTranslation", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Fsteric", "[", "0", "]"}], "+", 
      RowBox[{"Ftrap", "[", "0", "]"}], "+", 
      RowBox[{
       RowBox[{"FmRadial", "[", "0", "]"}], "[", "0", "]"}], "+", 
      RowBox[{
       RowBox[{"FmTangential", "[", "0", "]"}], "[", "0", "]"}]}], 
     ")"}]}]}]}]], "Output",
 CellChangeTimes->{{3.685990679948995*^9, 3.6859907313187447`*^9}, 
   3.6859909978512383`*^9, 3.687122643075014*^9, 3.687123376302928*^9, 
   3.689441800343696*^9, 3.689456898425705*^9, 3.689539056841305*^9, 
   3.6895401139416523`*^9, 3.6895425918370667`*^9, 3.6895450768492947`*^9, 
   3.689545262929785*^9, 3.689547045277054*^9, 3.689547448734997*^9, 
   3.691178609360409*^9, 3.691178656694998*^9, 3.691178846165007*^9, {
   3.69117899710688*^9, 3.691179016842898*^9}, 3.691181002797296*^9, 
   3.691181401160927*^9, 3.6948143971711206`*^9, 3.694816141054824*^9, 
   3.694886585466592*^9, 3.758508002981614*^9, 3.7586580777370567`*^9},
 CellLabel->
  "Out[108]=",ExpressionUUID->"cf991ee0-0047-4248-a86f-aaaacbface79"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Write solutions for bead", "Section",
 CellChangeTimes->{{3.685990513731245*^9, 3.685990517882678*^9}, {
  3.689538229285549*^9, 
  3.689538230219554*^9}},ExpressionUUID->"7c4695e5-6539-44b7-8d03-\
5c33a7ebcfcc"],

Cell["\<\
Create and open a file to write to. If it already exists, delete the old one\
\>", "Text",
 CellChangeTimes->{{3.685989405081962*^9, 3.685989407972825*^9}, {
  3.6859895989977083`*^9, 3.685989632004455*^9}, {3.685989669647953*^9, 
  3.685989671356762*^9}},ExpressionUUID->"9aaefdb2-ac3c-4d0b-b93f-\
e972d251e6b0"],

Cell[BoxData[{
 RowBox[{"DeleteFile", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<beadequations.c\>\""}],
   "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outfileLoc", "=", 
   RowBox[{"CreateFile", "[", 
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<beadequations.c\>\""}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"outfile", "=", 
   RowBox[{"File", "[", "outfileLoc", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.684098648719748*^9, 3.684098677654524*^9}, 
   3.6840991788294983`*^9, 3.68409921040814*^9, {3.684102465568993*^9, 
   3.684102482037467*^9}, {3.684102558481722*^9, 3.684102578910823*^9}, {
   3.684122712337173*^9, 3.684122713519846*^9}, {3.685825583032132*^9, 
   3.685825584651936*^9}, {3.685850341986755*^9, 3.685850358549972*^9}, {
   3.685989573640522*^9, 3.685989584440605*^9}, {3.6895381551834307`*^9, 
   3.689538159963882*^9}},
 CellLabel->
  "In[109]:=",ExpressionUUID->"f480812c-f68b-4f54-8fe8-4bd8985a8186"],

Cell["\<\
Write C function beginning lines to the equations for each number of motors \
in a switch case structure\
\>", "Text",
 CellChangeTimes->{{3.6840992130621567`*^9, 3.684099228238578*^9}, {
  3.685825660308721*^9, 3.685825661635256*^9}, {3.685989993825622*^9, 
  3.685990014762042*^9}},ExpressionUUID->"a905219e-9505-4b5f-ac8f-\
7c25e7b75313"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<//prototypes\>\"", ",", "\"\<\\n\>\"", ",", 
    "\"\<void bead_equations();\>\"", ",", "\"\<\\n\\n\>\""}], "]"}], 
  RowBox[{"(*", 
   RowBox[{"prototype", " ", "line"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<void bead_equations(){\>\"", ",", "\"\<\\n\>\""}], 
   "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"function", " ", "definition"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<    \>\"", ",", "\"\<switch(total_motors){\>\"", ",", 
    "\"\<\\n\>\""}], "]"}], " ", 
  RowBox[{"(*", 
   RowBox[{"declaration", " ", "of", " ", "switch", " ", "statement"}], 
   "*)"}]}]}], "Input",
 CellChangeTimes->{{3.684099231380281*^9, 3.684099240084999*^9}, {
  3.6840992762656183`*^9, 3.684099515878077*^9}, {3.6840996083649063`*^9, 
  3.684099671532875*^9}, {3.6840997024259577`*^9, 3.684099710873991*^9}, {
  3.68410043232519*^9, 3.684100434844616*^9}, {3.684100489632914*^9, 
  3.684100491769526*^9}, {3.684102822946341*^9, 3.684102824329294*^9}, {
  3.685388941745635*^9, 3.685388952817151*^9}, {3.685407473277313*^9, 
  3.685407474546224*^9}, {3.685825623847027*^9, 3.685825633602104*^9}, {
  3.685846086266388*^9, 3.68584610380118*^9}, {3.685989831493289*^9, 
  3.685989868850224*^9}, {3.689538198416264*^9, 3.689538205548904*^9}},
 CellLabel->
  "In[112]:=",ExpressionUUID->"e0e877b3-604a-4d9f-a7a1-c1bc902cfc26"],

Cell["Write out equations for each number of motors up to some max", "Text",
 CellChangeTimes->{{3.685989691236011*^9, 
  3.6859897102478848`*^9}},ExpressionUUID->"dd85576a-63c8-4385-9b33-\
1698aef396ae"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "for", " ", "all", " ", "numbers", " ", "of", " ", "motors", " ", "up", 
    " ", "to", " ", "nmax"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"For", "[", 
     RowBox[{
      RowBox[{"j", "=", "1"}], ",", 
      RowBox[{"j", "\[LessEqual]", "nmaxbead"}], ",", 
      RowBox[{"j", "=", 
       RowBox[{"j", "+", "iterator"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
       "write", " ", "a", " ", "line", " ", "for", " ", "the", " ", "case", 
        " ", "of", " ", "j", " ", "motors"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<        \>\"", ",", "\"\<case \>\"", ",", "j", 
         ",", "\"\<:\>\"", ",", "\"\<\\n\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
         RowBox[{
         "for", " ", "each", " ", "of", " ", "the", " ", "equations", " ", 
          "in", " ", "the", " ", "solution"}], ",", " ", 
         RowBox[{
          RowBox[{"convert", " ", "it", " ", "to", " ", "c"}], "-", 
          RowBox[{
          "ish", " ", "form", " ", "and", " ", "write", " ", "it", " ", "out",
            " ", "to", " ", "the", " ", "file"}]}]}], "*)"}], 
       "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "first", " ", "the", " ", "equations", " ", "for", " ", "the", " ", 
         "center", " ", "and", " ", "theta"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "1"}], ",", 
         RowBox[{"i", "\[LessEqual]", "6"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"WriteString", "[", 
          RowBox[{"outfile", ",", "\"\<            \>\"", ",", 
           RowBox[{"CForm", "[", 
            RowBox[{
             RowBox[{"beadEqs", "[", "j", "]"}], "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
           "\"\<\\n\\n\>\""}], "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"then", " ", "for", " ", "the", " ", "anchor"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", 
         "\"\<omega[0] = theta1[0]-theta[0]\>\"", ",", "\"\<;\>\"", ",", 
         "\"\<\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", 
         "\"\<omega[1] = theta1[1]-theta[1]\>\"", ",", "\"\<;\>\"", ",", 
         "\"\<\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", 
         "\"\<omega[2] = theta1[2]-theta[2]\>\"", ",", "\"\<;\>\"", ",", 
         "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", 
         "\"\<if(sqrt(omega[0]*omega[0] + omega[1]*omega[1] + \
omega[2]*omega[2])<1E-12){\>\"", ",", "\"\<\\n\\n\>\""}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", " ", "j"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<                \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"nextAnchorLocationBead0", "[", "i", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<                \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"nextAnchorLocationBead0", "[", "i", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<                \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"nextAnchorLocationBead0", "[", "i", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", "\"\<}else{\>\"", ",", 
         "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"i", "=", "0"}], ",", 
         RowBox[{"i", "<", " ", "j"}], ",", 
         RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<                \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"nextAnchorLocationBead", "[", "i", "]"}], "[", 
              RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<                \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"nextAnchorLocationBead", "[", "i", "]"}], "[", 
              RowBox[{"[", "2", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
          RowBox[{"WriteString", "[", 
           RowBox[{"outfile", ",", "\"\<                \>\"", ",", 
            RowBox[{"CForm", "[", 
             RowBox[{
              RowBox[{"nextAnchorLocationBead", "[", "i", "]"}], "[", 
              RowBox[{"[", "3", "]"}], "]"}], "]"}], ",", "\"\<;\>\"", ",", 
            "\"\<\\n\\n\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
       ";", "\[IndentingNewLine]", 
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", "\"\<}\>\"", ",", 
         "\"\<\\n\\n\>\""}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "write", " ", "a", " ", "break", " ", "at", " ", "the", " ", "end", 
         " ", "of", " ", "the", " ", "case"}], "*)"}], "\[IndentingNewLine]", 
       
       RowBox[{"WriteString", "[", 
        RowBox[{
        "outfile", ",", "\"\<            \>\"", ",", "\"\<break;\>\"", ",", 
         "\"\<\\n\\n\>\""}], "]"}], ";"}]}], "\[IndentingNewLine]", "]"}], 
    ",", "j"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.684098684247036*^9, 3.684098766686006*^9}, {
   3.684098856697693*^9, 3.684098878004724*^9}, {3.684099061289969*^9, 
   3.6840991277763557`*^9}, 3.6840991935196753`*^9, {3.684099519804295*^9, 
   3.684099541348055*^9}, {3.6840997343083973`*^9, 3.684099816432733*^9}, {
   3.684100169619607*^9, 3.6841001736468277`*^9}, {3.684100402884281*^9, 
   3.684100411512261*^9}, {3.6841005086000032`*^9, 3.684100540493479*^9}, {
   3.68410061534379*^9, 3.684100657686246*^9}, {3.684100711764319*^9, 
   3.684100715138089*^9}, {3.685310680916917*^9, 3.685310683885453*^9}, {
   3.6853114763699017`*^9, 3.685311479619326*^9}, {3.685407221763399*^9, 
   3.685407221799777*^9}, {3.685465676220456*^9, 3.685465676259206*^9}, {
   3.6854659373040123`*^9, 3.685465953817956*^9}, {3.6854685904634333`*^9, 
   3.68546859084135*^9}, {3.685468806323731*^9, 3.6854688063796387`*^9}, {
   3.685471190990142*^9, 3.685471191024145*^9}, {3.6858090438046227`*^9, 
   3.685809117375259*^9}, {3.685809192345202*^9, 3.685809227111394*^9}, {
   3.685809340496956*^9, 3.685809353218791*^9}, {3.685809387948227*^9, 
   3.685809391389855*^9}, {3.685809431936461*^9, 3.685809437741338*^9}, {
   3.685809615973763*^9, 3.6858096344905577`*^9}, {3.68580970844851*^9, 
   3.685809710641583*^9}, {3.6858098008331947`*^9, 3.6858098265387697`*^9}, {
   3.685825718954495*^9, 3.6858257450769653`*^9}, {3.685826976061697*^9, 
   3.685826976116604*^9}, {3.685989715424526*^9, 3.685989807156097*^9}, {
   3.6859898931505423`*^9, 3.685989980304138*^9}, {3.6859901054725103`*^9, 
   3.685990105549755*^9}, {3.685990261700066*^9, 3.685990273579719*^9}, {
   3.685990308897138*^9, 3.685990378237952*^9}, {3.6859904640868073`*^9, 
   3.685990466865103*^9}, {3.6859906369764147`*^9, 3.6859906690155983`*^9}, {
   3.685990742219083*^9, 3.685990772099668*^9}, {3.689460999388219*^9, 
   3.6894609994202967`*^9}, {3.689523539530192*^9, 3.689523541138032*^9}, {
   3.689538283062244*^9, 3.689538314257856*^9}, {3.689538400457271*^9, 
   3.689538427760085*^9}, 3.689538478552753*^9, {3.6895385186363363`*^9, 
   3.689538562870904*^9}, {3.68953877016282*^9, 3.6895389224447317`*^9}, {
   3.689544971454884*^9, 3.689544975492734*^9}, {3.6896237403112917`*^9, 
   3.689623746329125*^9}, {3.691179046533091*^9, 3.691179065679762*^9}, {
   3.691179277652215*^9, 3.691179332337575*^9}, {3.6911798122175083`*^9, 
   3.691179865305491*^9}, {3.691179938037023*^9, 3.691180084410191*^9}, {
   3.6911811062690077`*^9, 3.6911811171129007`*^9}, {3.694885421019146*^9, 
   3.69488544104211*^9}, {3.6948860807267942`*^9, 3.6948861251295643`*^9}, 
   3.694886635823718*^9, {3.6948894057527647`*^9, 3.694889416315817*^9}, {
   3.694889468404161*^9, 3.694889468582849*^9}, {3.694889512215295*^9, 
   3.6948895123557463`*^9}, {3.69488962719713*^9, 3.694889627263637*^9}, {
   3.694892191145398*^9, 3.694892191997386*^9}, {3.694892253771701*^9, 
   3.694892256177758*^9}},
 CellLabel->
  "In[115]:=",ExpressionUUID->"cc0854f6-bef4-4b08-8be2-0574d6d5a232"],

Cell["Finish case structure and function", "Text",
 CellChangeTimes->{{3.685990028971142*^9, 
  3.6859900437981052`*^9}},ExpressionUUID->"c0ea7a06-d572-4459-bce7-\
4307d50c0b84"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{
   "outfile", ",", "\"\<        \>\"", ",", "\"\<default:\>\"", ",", 
    "\"\<\\n\>\"", ",", "\"\<            \>\"", ",", 
    "\"\<printf(\\\"Bad value for total_motors\\\\n\\\");\>\"", ",", 
    "\"\<\\n\>\""}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "write", " ", "default", " ", "case", " ", "with", " ", "error", " ", 
    "statement"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"WriteString", "[", 
  RowBox[{
  "outfile", ",", "\"\<            \>\"", ",", "\"\<exit(0);\>\"", ",", 
   "\"\<\\n\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"WriteString", "[", 
   RowBox[{"outfile", ",", "\"\<    }\\n\>\"", ",", "\"\<}\\n\>\""}], "]"}], 
  RowBox[{"(*", 
   RowBox[{
   "write", " ", "the", " ", "bracket", " ", "to", " ", "end", " ", "the", 
    " ", "function"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.684099840640665*^9, 3.684099931812181*^9}, {
  3.6840999744158993`*^9, 3.68409998222359*^9}, {3.684100043368163*^9, 
  3.684100084620983*^9}, {3.6841001168977137`*^9, 3.684100160693183*^9}, {
  3.684100202273947*^9, 3.6841002029258747`*^9}, {3.684100279347612*^9, 
  3.684100298168747*^9}, {3.684100370877803*^9, 3.6841003714731607`*^9}, {
  3.684100419881982*^9, 3.6841004213560467`*^9}, {3.684100523328725*^9, 
  3.684100531020879*^9}, {3.684100563084326*^9, 3.684100566716979*^9}, {
  3.685416480599662*^9, 3.685416481870009*^9}, {3.6859900521466017`*^9, 
  3.685990087909483*^9}, {3.689443929058951*^9, 3.6894439521319942`*^9}},
 CellLabel->
  "In[116]:=",ExpressionUUID->"3b3cb546-b206-48f8-b40a-828a63df120a"],

Cell["Finally, close the file", "Text",
 CellChangeTimes->{{3.6859900917003107`*^9, 
  3.685990094411708*^9}},ExpressionUUID->"fc5c38c9-df8f-4bc9-a321-\
55f86c8a4d2a"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Close", "[", "outfile", "]"}]], "Input",
 CellLabel->
  "In[119]:=",ExpressionUUID->"9e8f477a-b8e0-43a1-9339-d4f153fdfb8b"],

Cell[BoxData["\<\"/Users/Matt/project_code/Motor_Freedom/tools/beadequations.\
c\"\>"], "Output",
 CellChangeTimes->{{3.684100300257049*^9, 3.6841003123613777`*^9}, 
   3.684100438657907*^9, 3.684100553368664*^9, 3.6841005843912697`*^9, 
   3.684100673530526*^9, {3.684100722534998*^9, 3.684100732493864*^9}, 
   3.684102391742468*^9, 3.684102594087244*^9, 3.6841028306272573`*^9, 
   3.684121002174754*^9, 3.684122725655195*^9, 3.684123019930887*^9, 
   3.6841233523696623`*^9, 3.685310548666443*^9, {3.685310618702059*^9, 
   3.6853106288145733`*^9}, 3.68531069968434*^9, {3.685310957682103*^9, 
   3.685310969501884*^9}, 3.685311255730791*^9, 3.685311402237832*^9, 
   3.6853115071808147`*^9, 3.685312010253036*^9, 3.685312841126239*^9, {
   3.685312985680805*^9, 3.6853130014500933`*^9}, 3.685314857065839*^9, 
   3.685316608044868*^9, 3.6853218660793743`*^9, 3.685389151945215*^9, 
   3.685407229598117*^9, 3.685407515813778*^9, 3.685416503740095*^9, {
   3.6854656908324947`*^9, 3.685465700600263*^9}, 3.685466038857834*^9, 
   3.685468637688806*^9, {3.685468811556815*^9, 3.6854688194929333`*^9}, 
   3.6854712321194677`*^9, 3.685809145536249*^9, 3.68580927994246*^9, 
   3.6858093874017143`*^9, 3.685809471968864*^9, 3.685809749058251*^9, 
   3.685825770949732*^9, 3.6858269969894533`*^9, 3.685827299476267*^9, 
   3.685829988554552*^9, 3.685830042478118*^9, 3.685846229066922*^9, 
   3.685893310046109*^9, 3.685893370932152*^9, {3.685893963828843*^9, 
   3.6858939863996572`*^9}, 3.68589432124051*^9, 3.685894669222761*^9, 
   3.685895064162703*^9, 3.685895219296137*^9, 3.685896097772681*^9, 
   3.685909484995805*^9, 3.685909759388433*^9, 3.6859901587780323`*^9, 
   3.6859908424946938`*^9, 3.685990997927788*^9, 3.687122643313582*^9, 
   3.6871233764811697`*^9, 3.689441800639526*^9, 3.6894568993827457`*^9, 
   3.6895390726475277`*^9, 3.689540117563945*^9, 3.689542595965947*^9, 
   3.689545080354351*^9, 3.689545263719652*^9, 3.689547048551601*^9, 
   3.689547449127163*^9, 3.689623756082953*^9, 3.691178609608861*^9, 
   3.691178656822648*^9, 3.691178846254046*^9, {3.691178997490048*^9, 
   3.691179017289966*^9}, 3.691179074270817*^9, 3.691179877844925*^9, {
   3.6911800643310013`*^9, 3.691180089823759*^9}, 3.6911810191012707`*^9, 
   3.691181404765334*^9, 3.6948144978974323`*^9, 3.6948168370422277`*^9, 
   3.694886973544084*^9, 3.694889434097623*^9, 3.6948894885805273`*^9, 
   3.6948895974879913`*^9, 3.694890299484033*^9, 3.7585080146902943`*^9, 
   3.758658506072896*^9},
 CellLabel->
  "Out[119]=",ExpressionUUID->"0b6bff7d-d9b0-480e-badb-7d74d60d6ae5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{969, 855},
WindowMargins->{{78, Automatic}, {Automatic, 0}},
FrontEndVersion->"11.3 for Mac OS X x86 (32-bit, 64-bit Kernel) (March 5, \
2018)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 222, 4, 98, "Title",ExpressionUUID->"c48312f1-7150-4f67-b001-2f86a03d886e"],
Cell[805, 28, 1021, 17, 173, "Text",ExpressionUUID->"097bc474-593c-456b-adfc-fd52c51b4956"],
Cell[CellGroupData[{
Cell[1851, 49, 230, 4, 69, "Chapter",ExpressionUUID->"ba482971-6389-4f95-a083-a88b62cfaeb3"],
Cell[CellGroupData[{
Cell[2106, 57, 274, 4, 67, "Section",ExpressionUUID->"51f63eb8-6abb-4bbc-97fd-600807964568"],
Cell[2383, 63, 504, 11, 104, "Text",ExpressionUUID->"06ea877b-ee3b-4efa-ad09-3a9a3c56ba35"],
Cell[2890, 76, 167, 3, 35, "Text",ExpressionUUID->"1a2860fe-df78-4eaa-a5f9-ae80ceb6d13f"],
Cell[3060, 81, 3507, 88, 199, "Input",ExpressionUUID->"682925a0-1d56-498b-be07-17b57e3a563a"],
Cell[6570, 171, 163, 3, 35, "Text",ExpressionUUID->"2069f52b-5a5f-44a0-98fc-524b5a3a8ed5"],
Cell[6736, 176, 4913, 122, 241, "Input",ExpressionUUID->"7654dee9-cced-4ac5-892d-0fc433eb0820"],
Cell[11652, 300, 167, 3, 35, "Text",ExpressionUUID->"fb3463b3-b080-47f8-939d-dfe8778f6a2b"],
Cell[11822, 305, 5202, 132, 241, "Input",ExpressionUUID->"2cf856a3-687a-496b-a1aa-73bf74217078"],
Cell[17027, 439, 173, 3, 35, "Text",ExpressionUUID->"8f2aea30-a566-4931-b324-379a4addcd11"],
Cell[17203, 444, 1057, 29, 73, "Input",ExpressionUUID->"b9a3eaad-0fa8-41ff-b68c-5ca1264cc13a"],
Cell[18263, 475, 175, 3, 35, "Text",ExpressionUUID->"d6a839bf-aa71-453f-a96f-8e6846926a5e"],
Cell[18441, 480, 1110, 30, 73, "Input",ExpressionUUID->"e5de4c9f-b96a-4ab4-be0d-d8595bf5a7c1"],
Cell[19554, 512, 199, 3, 35, "Text",ExpressionUUID->"1a3db608-df31-4440-9940-4f5d5a695f61"],
Cell[CellGroupData[{
Cell[19778, 519, 1448, 37, 52, "Input",ExpressionUUID->"e92a590d-9f57-425e-ba44-d4d344f48342"],
Cell[21229, 558, 1629, 36, 52, "Output",ExpressionUUID->"fbbcad46-0ab9-4ee9-9ba3-5eda7869c529"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22895, 599, 1913, 48, 73, "Input",ExpressionUUID->"d065afec-9750-4dc9-afe4-bec5ef19b8d6"],
Cell[24811, 649, 1974, 47, 122, "Output",ExpressionUUID->"1e227682-4f10-4038-841f-3e9922d0e5c4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[26822, 701, 517, 12, 52, "Input",ExpressionUUID->"2891c795-710f-4932-b777-9403c398c3b4"],
Cell[27342, 715, 906, 18, 53, "Output",ExpressionUUID->"2fcaea53-b87c-49ee-b0dd-45bf51f1f62c"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[28297, 739, 177, 3, 67, "Section",ExpressionUUID->"5f11cc2b-58a3-4b2d-8b49-8c6d12c6d04e"],
Cell[28477, 744, 746, 12, 81, "Text",ExpressionUUID->"6caa3bc2-249f-4fee-b876-4f53c04f4c59"],
Cell[29226, 758, 379, 8, 58, "Text",ExpressionUUID->"de75ca16-83f5-466f-a4e2-b6d61877b60d"],
Cell[CellGroupData[{
Cell[29630, 770, 1442, 36, 157, "Input",ExpressionUUID->"4164c214-6c3f-4fca-912c-630271b2ba41"],
Cell[31075, 808, 2739, 60, 119, "Output",ExpressionUUID->"9e3915a9-4a11-4173-9928-572196c0016c"]
}, Open  ]],
Cell[33829, 871, 343, 7, 58, "Text",ExpressionUUID->"c7234642-e3af-46e4-97f0-0f02efe0159e"],
Cell[CellGroupData[{
Cell[34197, 882, 457, 8, 52, "Input",ExpressionUUID->"014ebcba-710b-4ee5-9da4-5ae19befb19b"],
Cell[34657, 892, 1425, 20, 34, "Output",ExpressionUUID->"8be7e2ad-2146-4eb3-ba2d-59c7305e8261"],
Cell[36085, 914, 1445, 21, 34, "Output",ExpressionUUID->"f48e700e-9e58-43ad-bf37-281ca223c870"]
}, Open  ]],
Cell[37545, 938, 272, 6, 35, "Text",ExpressionUUID->"1242e921-792e-4e85-ab01-b3f7baf558a3"],
Cell[CellGroupData[{
Cell[37842, 948, 215, 3, 30, "Input",ExpressionUUID->"6105120e-b054-4bd4-967a-15eb4bb89376"],
Cell[38060, 953, 776, 15, 34, "Output",ExpressionUUID->"3f7f13e0-0bcb-46c4-a236-8f3fbd7b1ba2"]
}, Open  ]],
Cell[38851, 971, 541, 11, 104, "Text",ExpressionUUID->"a29b0080-e7c7-4ab1-b370-a746e250b011"],
Cell[CellGroupData[{
Cell[39417, 986, 969, 24, 73, "Input",ExpressionUUID->"c99298fa-4f87-41a6-a0fa-e5ffe8d13275"],
Cell[40389, 1012, 2557, 58, 140, "Output",ExpressionUUID->"2c39c4aa-6fd7-49ee-b704-31b743733660"]
}, Open  ]],
Cell[42961, 1073, 1933, 47, 167, "Text",ExpressionUUID->"b8d7d8e7-644b-4caf-9711-f33a44430a36"],
Cell[CellGroupData[{
Cell[44919, 1124, 458, 9, 30, "Input",ExpressionUUID->"beae1f40-dcbf-4e69-a598-f20f13344fc3"],
Cell[45380, 1135, 4583, 124, 379, "Output",ExpressionUUID->"d96b4fd1-a053-483a-8022-f1b9061cde04"]
}, Open  ]],
Cell[49978, 1262, 331, 7, 35, "Text",ExpressionUUID->"d4a4e7fa-7c0c-40e7-af3f-f37a95686add"],
Cell[CellGroupData[{
Cell[50334, 1273, 212, 3, 30, "Input",ExpressionUUID->"d6417aaf-f6fd-44dc-a1f8-0f35b21d29c1"],
Cell[50549, 1278, 779, 15, 34, "Output",ExpressionUUID->"29d33caa-b56a-4e52-8e15-f66bd417fa94"]
}, Open  ]],
Cell[51343, 1296, 179, 3, 35, "Text",ExpressionUUID->"0fea4cac-e2cd-45b1-8f93-921f5500c3aa"],
Cell[CellGroupData[{
Cell[51547, 1303, 645, 13, 30, "Input",ExpressionUUID->"0cf6b4a1-0f5f-4f42-8a69-2342bf786b48"],
Cell[52195, 1318, 3751, 94, 193, "Output",ExpressionUUID->"3e60fd91-4da4-438f-afc0-448cd2053d00"]
}, Open  ]],
Cell[55961, 1415, 184, 3, 35, "Text",ExpressionUUID->"3284bdbd-a013-4cb0-aab9-240ced42bf26"],
Cell[CellGroupData[{
Cell[56170, 1422, 384, 9, 30, "Input",ExpressionUUID->"3628abec-bb9e-4657-a2ed-cdd669b88276"],
Cell[56557, 1433, 3673, 93, 193, "Output",ExpressionUUID->"14b021a2-9ade-45cf-b814-873e14b670ea"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[60279, 1532, 284, 4, 67, "Section",ExpressionUUID->"e3a825d9-779d-4af0-b5e9-101af52c3314"],
Cell[60566, 1538, 222, 5, 35, "Text",ExpressionUUID->"f07f7883-deeb-43a0-a143-db57a5732b32"],
Cell[60791, 1545, 3744, 84, 304, "Input",ExpressionUUID->"e86ce833-6c81-48da-8870-43b39f6a7e16"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64572, 1634, 221, 4, 67, "Section",ExpressionUUID->"a065e7a0-6c91-42ca-af58-6c2683c77e22"],
Cell[64796, 1640, 316, 7, 58, "Text",ExpressionUUID->"33c9f3dc-9d74-41a6-95a6-2f0cc3f76dba"],
Cell[CellGroupData[{
Cell[65137, 1651, 622, 16, 30, "Input",ExpressionUUID->"8b88e35f-04aa-4ee1-bc93-f2a50a0648d4"],
Cell[65762, 1669, 738, 17, 34, "Output",ExpressionUUID->"54c0bc3e-41dd-4045-b11f-e5a82b481ff3"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66537, 1691, 782, 21, 30, "Input",ExpressionUUID->"b221cda3-bec5-419d-993f-b164bef96855"],
Cell[67322, 1714, 983, 23, 34, "Output",ExpressionUUID->"8fbf19d1-fc7c-4bd8-ab26-88536c1af763"]
}, Open  ]],
Cell[68320, 1740, 224, 4, 35, "Text",ExpressionUUID->"7e1e83a2-9456-4222-b2e0-711b95b74c78"],
Cell[CellGroupData[{
Cell[68569, 1748, 1246, 19, 30, "Input",ExpressionUUID->"116d1a8f-ff4a-4ef5-8f50-49196999acd0"],
Cell[69818, 1769, 3060, 67, 119, "Output",ExpressionUUID->"4d179780-18da-495a-891c-81056ad7e52d"]
}, Open  ]],
Cell[72893, 1839, 269, 6, 35, "Text",ExpressionUUID->"5e2f4da1-bb43-4a8e-be29-bf5a2045d022"],
Cell[CellGroupData[{
Cell[73187, 1849, 620, 11, 30, "Input",ExpressionUUID->"452971f9-30b3-47a3-b571-4e4b465a1f60"],
Cell[73810, 1862, 1634, 42, 56, "Output",ExpressionUUID->"52474541-0f94-40c0-9ad2-9c6a72a39995"]
}, Open  ]],
Cell[75459, 1907, 208, 4, 35, "Text",ExpressionUUID->"c6186fa5-d70d-45e0-b884-fa1aaae9b99d"],
Cell[CellGroupData[{
Cell[75692, 1915, 1116, 26, 73, "Input",ExpressionUUID->"8033793d-838c-444f-8847-d53d8cf3e56f"],
Cell[76811, 1943, 2572, 71, 77, "Output",ExpressionUUID->"7ec87803-b95c-4978-8c91-489f08634875"]
}, Open  ]],
Cell[79398, 2017, 534, 9, 35, "Text",ExpressionUUID->"f8dd1db6-9508-47fc-bc81-4b681099a327"],
Cell[CellGroupData[{
Cell[79957, 2030, 1148, 28, 73, "Input",ExpressionUUID->"9b36bdff-0277-40b2-9568-912c584ddefe"],
Cell[81108, 2060, 2489, 67, 98, "Output",ExpressionUUID->"00920590-a2d6-4b07-8210-0acc7541fe96"]
}, Open  ]],
Cell[83612, 2130, 327, 7, 35, "Text",ExpressionUUID->"48d03932-76de-4719-a284-805fd0d2f846"],
Cell[CellGroupData[{
Cell[83964, 2141, 1095, 27, 73, "Input",ExpressionUUID->"e171a703-9065-47cf-907f-706fccd2bfbf"],
Cell[85062, 2170, 1816, 47, 77, "Output",ExpressionUUID->"0671d016-76fa-467c-995f-c61723ec1a8d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[86915, 2222, 997, 26, 73, "Input",ExpressionUUID->"fd6809fa-60a3-40b3-aee3-64501880a8be"],
Cell[87915, 2250, 2277, 64, 98, "Output",ExpressionUUID->"ea5ac71e-8644-4222-bdde-25e511920501"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[90241, 2320, 177, 3, 67, "Section",ExpressionUUID->"b1a7a0e6-cc04-4264-9d39-aee44ae796fd"],
Cell[CellGroupData[{
Cell[90443, 2327, 370, 5, 30, "Input",ExpressionUUID->"00e08789-301f-48d1-879c-2c60b7544721"],
Cell[90816, 2334, 3487, 90, 193, "Output",ExpressionUUID->"30a784bf-57fc-455a-b552-0eded8f31473"]
}, Open  ]],
Cell[94318, 2427, 570, 13, 37, "Text",ExpressionUUID->"47c26f05-2eb4-4321-93a9-c8378c622b50"],
Cell[CellGroupData[{
Cell[94913, 2444, 562, 12, 30, "Input",ExpressionUUID->"4df4310d-f92d-4662-8413-f01810319d84"],
Cell[95478, 2458, 1993, 50, 102, "Output",ExpressionUUID->"5a8b4f63-5652-46d7-b7ac-5862a6759c0f"]
}, Open  ]],
Cell[97486, 2511, 570, 10, 58, "Text",ExpressionUUID->"6a2d80ec-40be-40e5-935f-6d8da9ad8291"],
Cell[CellGroupData[{
Cell[98081, 2525, 549, 13, 30, "Input",ExpressionUUID->"b3f91b48-5d0c-4c6c-8678-ab406b9aa6af"],
Cell[98633, 2540, 2320, 66, 101, "Output",ExpressionUUID->"1ec86766-7abb-44d0-a89d-b16e1391e21e"]
}, Open  ]],
Cell[100968, 2609, 218, 5, 35, "Text",ExpressionUUID->"c5e317a6-d289-4f07-b55c-9a613de96caa"],
Cell[CellGroupData[{
Cell[101211, 2618, 586, 15, 30, "Input",ExpressionUUID->"e0107da5-fd61-40ba-981f-25657c3d1bd5"],
Cell[101800, 2635, 2663, 78, 160, "Output",ExpressionUUID->"58fa6fd5-0d22-43c2-9096-ec6d9f1b92c0"]
}, Open  ]],
Cell[104478, 2716, 211, 5, 35, "Text",ExpressionUUID->"0ced8229-e793-4961-99b0-1fea0221975a"],
Cell[CellGroupData[{
Cell[104714, 2725, 588, 15, 30, "Input",ExpressionUUID->"3ca56db8-dace-4173-9351-cdd0c041cd21"],
Cell[105305, 2742, 4242, 125, 193, "Output",ExpressionUUID->"982d32c5-b681-4694-a5eb-dbe3d1ed5eea"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[109608, 2874, 165, 3, 69, "Chapter",ExpressionUUID->"0da68de9-6f50-4dfa-be17-432f8c35c6b5"],
Cell[CellGroupData[{
Cell[109798, 2881, 163, 3, 67, "Section",ExpressionUUID->"6231d0ec-9e9f-43e9-9616-cbf3f9ea63e4"],
Cell[109964, 2886, 395, 8, 58, "Text",ExpressionUUID->"7d0ffc86-2f8e-47cf-b60e-5e1653060a58"],
Cell[110362, 2896, 1184, 24, 136, "Input",ExpressionUUID->"92eecaca-a6f1-4a22-abb8-d4e6f6d44a67"],
Cell[111549, 2922, 160, 3, 35, "Text",ExpressionUUID->"121479e3-705a-4805-a3d3-d0506f02fbd9"],
Cell[CellGroupData[{
Cell[111734, 2929, 263, 5, 30, "Input",ExpressionUUID->"03f24149-8e56-4f97-b61d-847a274607c0"],
Cell[112000, 2936, 6021, 161, 254, "Output",ExpressionUUID->"c802063f-f7ae-4f0a-b428-46e339827dcd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[118070, 3103, 160, 3, 67, "Section",ExpressionUUID->"484b5fcb-0a07-4c06-82a3-e19766bc7069"],
Cell[118233, 3108, 323, 6, 35, "Text",ExpressionUUID->"765af067-64d1-4e1a-97d3-15eec7d6e8ca"],
Cell[118559, 3116, 979, 20, 73, "Input",ExpressionUUID->"e8be5efe-9488-4889-8581-113677cc60e8"],
Cell[119541, 3138, 351, 7, 35, "Text",ExpressionUUID->"acd9450a-fdbf-4c97-ac76-ffe320993155"],
Cell[119895, 3147, 1509, 32, 94, "Input",ExpressionUUID->"c17ebe84-64ac-43e4-aec5-19d76274621f"],
Cell[121407, 3181, 204, 3, 35, "Text",ExpressionUUID->"09df5c82-6d31-4639-8776-388f4dfb962c"],
Cell[121614, 3186, 5798, 119, 325, "Input",ExpressionUUID->"09e8dba6-bbb3-4bf4-a275-4f494973a25c"],
Cell[127415, 3307, 178, 3, 35, "Text",ExpressionUUID->"1594dd97-a785-42fd-89cc-6fbc6cd99784"],
Cell[127596, 3312, 1613, 32, 115, "Input",ExpressionUUID->"0c06c231-faad-47e6-807e-b78e24a83221"],
Cell[129212, 3346, 167, 3, 35, "Text",ExpressionUUID->"3327ddd3-de0c-42c3-a6ab-121cd909cfd6"],
Cell[CellGroupData[{
Cell[129404, 3353, 143, 2, 30, "Input",ExpressionUUID->"3db24310-18da-423d-aa94-648836d88e5e"],
Cell[129550, 3357, 1979, 27, 34, "Output",ExpressionUUID->"ae373bcc-1bcd-43b2-8895-8ac3b7ee2e56"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[131590, 3391, 213, 4, 69, "Chapter",ExpressionUUID->"ce3f56b5-2482-4e86-a3a7-da3ff3ff34ff"],
Cell[CellGroupData[{
Cell[131828, 3399, 168, 3, 54, "Subsection",ExpressionUUID->"61269e3e-7bad-4f06-ae4f-e3ca38622d94"],
Cell[131999, 3404, 572, 10, 81, "Text",ExpressionUUID->"29ace1a7-7689-496e-803f-7d3981de32d9"],
Cell[132574, 3416, 276, 6, 35, "Text",ExpressionUUID->"e57cfd1a-6846-40ee-9d8b-5a322f0bfec8"],
Cell[132853, 3424, 3115, 76, 199, "Input",ExpressionUUID->"d1743019-459c-450d-ae75-1a049eda545c"],
Cell[135971, 3502, 285, 7, 35, "Text",ExpressionUUID->"3ab9f434-6599-4ee8-b863-5fe5ba326228"],
Cell[136259, 3511, 2807, 70, 115, "Input",ExpressionUUID->"5bca1c95-7bc8-4d08-adae-7b94c4048894"],
Cell[139069, 3583, 336, 7, 35, "Text",ExpressionUUID->"5bfdb3d1-8109-4c0d-bd42-3ef98b1c7af4"],
Cell[139408, 3592, 512, 12, 30, "Input",ExpressionUUID->"990ce07e-61eb-497a-a778-5721e22ef62b"],
Cell[139923, 3606, 175, 3, 35, "Text",ExpressionUUID->"7297134e-880b-46dd-b82e-c33311c17e90"],
Cell[140101, 3611, 562, 12, 30, "Input",ExpressionUUID->"086c5068-4317-43fb-bc2c-4c93cc7bf662"],
Cell[140666, 3625, 289, 7, 35, "Text",ExpressionUUID->"e8b76be9-326b-4714-9677-9fc7123b8a53"],
Cell[140958, 3634, 3817, 77, 241, "Input",ExpressionUUID->"b330700c-5b1f-4b39-9cfc-3b2f1fb0c72b"]
}, Open  ]],
Cell[CellGroupData[{
Cell[144812, 3716, 156, 3, 54, "Subsection",ExpressionUUID->"6b933144-f069-4b15-a2d6-2b0043ee3f55"],
Cell[144971, 3721, 258, 6, 35, "Text",ExpressionUUID->"86b8a7de-451d-4c8a-bca2-233ef5a29571"],
Cell[145232, 3729, 2054, 49, 73, "Input",ExpressionUUID->"aabca389-c635-41fb-8997-093f213a6bed"],
Cell[147289, 3780, 460, 9, 81, "Text",ExpressionUUID->"1040278b-b9e2-4084-8883-e59bfab5896b"],
Cell[147752, 3791, 196, 3, 35, "Text",ExpressionUUID->"6699f93a-c398-42c5-9af1-ee7dad100b91"],
Cell[147951, 3796, 560, 13, 33, "Input",ExpressionUUID->"a203fa5d-4da0-42f1-9f1e-d824da62a912"],
Cell[CellGroupData[{
Cell[148536, 3813, 612, 14, 33, "Input",ExpressionUUID->"e140337c-d699-41d5-a13b-85eb8463c84e"],
Cell[149151, 3829, 7525, 192, 349, "Output",ExpressionUUID->"f8f6243b-31f3-480c-a983-34e2f9f19f18"]
}, Open  ]],
Cell[156691, 4024, 191, 3, 35, "Text",ExpressionUUID->"94983124-0fc8-4eaf-be90-645b685fa5d2"],
Cell[CellGroupData[{
Cell[156907, 4031, 730, 17, 33, "Input",ExpressionUUID->"4e87111e-4ede-4912-a968-1c74c320f824"],
Cell[157640, 4050, 1260, 32, 78, "Output",ExpressionUUID->"095aef67-7d1a-4654-8077-b9b39b36e9a7"]
}, Open  ]],
Cell[158915, 4085, 211, 5, 35, "Text",ExpressionUUID->"eabfed23-7f91-4ee3-b7c0-a20ee7342810"],
Cell[CellGroupData[{
Cell[159151, 4094, 768, 20, 33, "Input",ExpressionUUID->"50b9b483-fa71-48bb-ad78-0decb785fcdf"],
Cell[159922, 4116, 601, 11, 58, "Output",ExpressionUUID->"d140cc57-03c5-46bc-ac4b-879fc609960d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[160560, 4132, 928, 21, 33, "Input",ExpressionUUID->"80a7c27f-fbdd-4629-b05b-55ed510cd619"],
Cell[161491, 4155, 16092, 449, 802, "Output",ExpressionUUID->"86190b54-9e88-4330-90c7-c8533a1a9528"]
}, Open  ]],
Cell[CellGroupData[{
Cell[177620, 4609, 212, 3, 30, "Input",ExpressionUUID->"d0c291c6-634b-4023-8719-c5a2aa820dba"],
Cell[177835, 4614, 16065, 444, 156, "Output",ExpressionUUID->"39d72b3f-697b-4b7a-93e9-1504d7f4a9f8"]
}, Open  ]],
Cell[CellGroupData[{
Cell[193937, 5063, 346, 6, 30, "Input",ExpressionUUID->"5ef5ab2d-32fa-4559-9635-5b4046c9f7fd"],
Cell[194286, 5071, 14088, 397, 780, "Output",ExpressionUUID->"b2dbcee8-453d-49b5-8dc0-94e6f47db72d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[208411, 5473, 220, 4, 30, "Input",ExpressionUUID->"b3550886-0b0d-4924-a791-7a37cff0910e"],
Cell[208634, 5479, 13979, 390, 156, "Output",ExpressionUUID->"c3ea22b0-b418-4629-a4b1-c5999daecae4"]
}, Open  ]],
Cell[222628, 5872, 374, 7, 58, "Text",ExpressionUUID->"18dcdca6-8542-48d4-964c-5f5711e426f9"],
Cell[223005, 5881, 2333, 60, 94, "Input",ExpressionUUID->"cc6ebc6d-3f1b-49ed-8694-31916c169b60"]
}, Open  ]],
Cell[CellGroupData[{
Cell[225375, 5946, 173, 3, 67, "Section",ExpressionUUID->"f6334ce8-4c5f-4b90-9113-9da5245d25d3"],
Cell[CellGroupData[{
Cell[225573, 5953, 275, 5, 30, "Input",ExpressionUUID->"7faddeea-8def-415d-b0a9-6dc375ac6aaa"],
Cell[225851, 5960, 15762, 434, 657, "Output",ExpressionUUID->"53f1d3e1-ba24-41de-a300-2412b60ed69a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[241650, 6399, 1644, 40, 52, "Input",ExpressionUUID->"8c52153d-6936-4b54-9cbb-e7db977df2d4"],
Cell[243297, 6441, 1069, 24, 34, "Output",ExpressionUUID->"bd6160a8-46b4-4caf-bd39-1c6ed4225de9"]
}, Open  ]],
Cell[CellGroupData[{
Cell[244403, 6470, 1276, 35, 52, "Input",ExpressionUUID->"5789c292-6f9f-42b3-8a30-67ae76b66cc0"],
Cell[245682, 6507, 584, 16, 34, "Output",ExpressionUUID->"cbc5230f-0c4c-4409-93cb-229efa903228"]
}, Open  ]],
Cell[246281, 6526, 289, 6, 35, "Text",ExpressionUUID->"8c9fbc1d-8df6-4654-a643-b43cb5e2fcdd"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[246619, 6538, 162, 3, 69, "Chapter",ExpressionUUID->"25a10489-fd95-4b38-9125-635781c33b5e"],
Cell[CellGroupData[{
Cell[246806, 6545, 223, 4, 67, "Section",ExpressionUUID->"03a2855a-b06e-40fc-b847-9317bb636e09"],
Cell[247032, 6551, 395, 8, 58, "Text",ExpressionUUID->"3394c918-5d16-4205-ba2a-bacbe8278084"],
Cell[247430, 6561, 404, 9, 52, "Input",ExpressionUUID->"1f55b564-18ad-485c-b909-26e7ba0a574d"],
Cell[247837, 6572, 1139, 27, 115, "Input",ExpressionUUID->"8a0a7b25-7f50-4958-94fc-5cdc2719d233"],
Cell[248979, 6601, 160, 3, 35, "Text",ExpressionUUID->"c3f65675-e1bb-4ca3-a950-1782d6af058a"],
Cell[CellGroupData[{
Cell[249164, 6608, 310, 7, 30, "Input",ExpressionUUID->"cf0eb923-dcda-4a01-ab0a-b5ac3e1d6c05"],
Cell[249477, 6617, 1358, 30, 65, "Output",ExpressionUUID->"cf991ee0-0047-4248-a86f-aaaacbface79"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[250884, 6653, 218, 4, 67, "Section",ExpressionUUID->"7c4695e5-6539-44b7-8d03-5c33a7ebcfcc"],
Cell[251105, 6659, 323, 6, 35, "Text",ExpressionUUID->"9aaefdb2-ac3c-4d0b-b93f-e972d251e6b0"],
Cell[251431, 6667, 1022, 22, 73, "Input",ExpressionUUID->"f480812c-f68b-4f54-8fe8-4bd8985a8186"],
Cell[252456, 6691, 351, 7, 35, "Text",ExpressionUUID->"a905219e-9505-4b5f-ac8f-7c25e7b75313"],
Cell[252810, 6700, 1546, 33, 94, "Input",ExpressionUUID->"e0e877b3-604a-4d9f-a7a1-c1bc902cfc26"],
Cell[254359, 6735, 204, 3, 35, "Text",ExpressionUUID->"dd85576a-63c8-4385-9b33-1698aef396ae"],
Cell[254566, 6740, 9961, 193, 682, "Input",ExpressionUUID->"cc0854f6-bef4-4b08-8be2-0574d6d5a232"],
Cell[264530, 6935, 178, 3, 35, "Text",ExpressionUUID->"c0ea7a06-d572-4459-bce7-4307d50c0b84"],
Cell[264711, 6940, 1617, 33, 115, "Input",ExpressionUUID->"3b3cb546-b206-48f8-b40a-828a63df120a"],
Cell[266331, 6975, 167, 3, 35, "Text",ExpressionUUID->"fc5c38c9-df8f-4bc9-a321-55f86c8a4d2a"],
Cell[CellGroupData[{
Cell[266523, 6982, 147, 3, 30, "Input",ExpressionUUID->"9e8f477a-b8e0-43a1-9339-d4f153fdfb8b"],
Cell[266673, 6987, 2579, 37, 34, "Output",ExpressionUUID->"0b6bff7d-d9b0-480e-badb-7d74d60d6ae5"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

